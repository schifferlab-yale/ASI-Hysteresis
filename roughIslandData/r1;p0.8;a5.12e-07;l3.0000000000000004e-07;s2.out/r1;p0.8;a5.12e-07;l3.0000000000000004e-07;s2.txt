
    randSeed(2)
    ThermSeed(2)


    resolution := 2e-09
    zResolution := 5e-09
    a := 5.12e-07

    gridSize := 512 //2*a/resolution
    gridDepth := 5 //25/zResolution

    SetCellsize(resolution,resolution,zResolution)
    SetGridsize(gridSize,gridSize,gridDepth)

    SetPBC(16, 16, 0)


    Msat = 700e3
    Aex = 13e-12
    alpha = 0.2
    Bmax := 0.1
    Bstep := Bmax / 500.0


    TableAdd(B_ext)
    TableAdd(m_full)


    islandWidth := 8e-08
    islandLength := 3.0000000000000004e-07
    ellipseConstant:=1.2000000000000002e-07


    hIsland := rect(islandLength-2*ellipseConstant, islandWidth)
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(islandLength/2-ellipseConstant, 0, 0))
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(-islandLength/2+ellipseConstant, 0, 0))
    
    hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5368695235228724e-10).transl(-1.0483009134727285e-07,-3.127025108977613e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.006755812548163e-10).transl(1.3623066011025482e-07,-1.8604201593963537e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.306567904911587e-09).transl(8.835920467159861e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.438866702429365e-09).transl(-4.0177193227889015e-08,-3.9855885858374814e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.382790665126866e-10).transl(2.6473723700952378e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.6392814180958975e-09).transl(-1.1107626029962873e-07,-2.9489433165546014e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.3255706747735397e-10).transl(-1.241774263514761e-07,-2.4789362337306202e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.221802358273731e-09).transl(1.2541283695580945e-07,-2.4258768275143834e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.7171135324141053e-09).transl(4.672517244419102e-08,-3.960957881723964e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.2360776548219866e-09).transl(1.0580413233141868e-07,-3.100848185305427e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.728463382457497e-10).transl(2.4753004534560718e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.5634023982077344e-09).transl(6.091091587074107e-08,-3.865016210981092e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.880174674698086e-10).transl(5.795262482953804e-08,-3.889965833203151e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.847758057774995e-09).transl(-4.812963179261265e-08,-3.9540859951116516e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.513642009027706e-09).transl(-1.2954263244517185e-07,-2.2338965274668047e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3195383574549935e-09).transl(-3.418879171395449e-08,-3.997562316097859e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.876996460253709e-10).transl(7.601441671508349e-08,-3.694240781175574e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.507079668830715e-09).transl(1.1258824752458344e-07,-2.9019497987116142e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0944124348015886e-10).transl(1.4503526289060218e-07,-1.1386582219095758e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6969348224810518e-09).transl(-9.146105077867224e-08,-3.4355234498757366e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.414447250730229e-09).transl(-5.151029822911603e-08,-3.935212414158787e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.458749608198383e-10).transl(9.661488952806532e-08,-3.327070198164621e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.985625867783354e-09).transl(1.2505172532091962e-07,-2.4415772483095277e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.315949750072569e-10).transl(-7.154879491731059e-08,-3.7525839454551946e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9937717160175154e-09).transl(8.069007276968363e-08,-3.625605929834224e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1683659116742056e-09).transl(-7.380279614155025e-08,-3.7239935329609964e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8464659381526384e-09).transl(-4.192091568624671e-08,-3.9802138090533944e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.2988086398617583e-09).transl(-8.028047775636424e-08,-3.631937584600717e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4874045680818525e-09).transl(-6.269608721234048e-08,-3.8486600671175915e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0238910690256376e-09).transl(-1.3364416295956112e-07,-2.0160157308722526e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.482040768549886e-09).transl(-7.777835551206155e-08,-3.6692761539517506e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1210367623168784e-09).transl(-3.987881861655537e-08,-3.986422643415355e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.718651879531599e-09).transl(-1.391984770071769e-07,-1.6585444151467615e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5969906286888166e-09).transl(-1.4050881097092952e-07,-1.5591317732747476e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.3943386274206755e-09).transl(5.7731773649754237e-08,-3.891721802641373e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.67345268636597e-10).transl(-1.2018031070072608e-07,-2.638920562553416e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.311132340196367e-10).transl(-1.0345328716532164e-07,-3.16308825966874e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.006071527048874e-10).transl(-1.48049747590214e-07,-7.182208681385842e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.4273855102594906e-09).transl(1.1546003938117384e-07,-2.8080403742286226e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.1484994890058005e-09).transl(1.590523526051884e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.177698839190571e-10).transl(2.889501074927119e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.026270571202121e-09).transl(-2.6958699279472767e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.655356748955731e-09).transl(-1.480077985105589e-07,-7.2584011913501476e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1846255699970722e-09).transl(6.048879276589343e-08,-3.8687398918451194e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.698240562320052e-10).transl(1.1695968282944229e-07,-2.7564094120598273e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.140953159844789e-09).transl(1.3225911389159353e-07,-2.093129933352364e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.173869279120652e-10).transl(7.644168794474748e-08,-3.6882952431897763e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.103542499740217e-09).transl(-1.1503712361525695e-07,-2.822270088509034e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.385503200807357e-09).transl(-3.5498008481058936e-08,-3.995799447578559e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.7647158759593896e-09).transl(6.563900509344053e-08,-3.819520231063018e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.6992976253732574e-09).transl(-2.8432546339151378e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.873006887639498e-10).transl(-1.3989304022114827e-07,-1.606763382619127e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9609766766806326e-09).transl(-1.4659594346136622e-07,-9.459774300536963e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.649253273520001e-10).transl(6.106001347320564e-08,-3.863687870278614e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.7822074532471877e-10).transl(1.4641493169862067e-07,-9.704315635641982e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1114002809314463e-09).transl(-9.987892842320677e-08,-3.251826044688729e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.059871391317924e-09).transl(1.3997229333186521e-07,-1.600727160917881e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.4849364667601775e-10).transl(1.155768325281323e-07,-2.8040854588443313e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.535760476654582e-10).transl(8.151439025451909e-08,-3.612673309445992e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.877614828491289e-09).transl(1.251942676956756e-07,-2.4353989857662288e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2159204818981125e-09).transl(1.2823167958407883e-07,-2.297471345750674e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.203265389994572e-09).transl(-9.535158245377778e-08,-3.3547927027839316e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1839685692063445e-09).transl(-1.1443176819032508e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.119649511092609e-10).transl(-1.285650921188981e-07,-2.281549818189658e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.774202250332989e-10).transl(-2.8040105362378048e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.892479046031917e-10).transl(1.4865340125229504e-07,-5.975601980478399e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.543355368023992e-10).transl(-3.874463695779956e-08,-3.989365213285649e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.221900456735334e-09).transl(-3.902320579138212e-08,-3.988675881270537e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.9013917279938084e-09).transl(3.4731714528189276e-08,-3.996889190027626e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.0265125167615897e-10).transl(-2.2159297038224425e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.112153361806224e-10).transl(9.153614594679024e-08,-3.43402949932572e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.2658620434501034e-10).transl(1.1362543149836344e-07,-2.8687564488840662e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.5540079833872588e-09).transl(1.22162928066104e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9804537697175635e-09).transl(-1.3258239888176612e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1188006296103181e-09).transl(1.4465266925794518e-07,-1.1807556111934032e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.069025229239501e-11).transl(8.039837739172118e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.15886617489452e-09).transl(1.0478392001706546e-07,-3.1282521401079834e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.961236749209889e-09).transl(8.122125428126664e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2336306406182093e-10).transl(1.4721658078676944e-07,-8.565260511435173e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0776011269245017e-09).transl(7.779259211014241e-08,-3.6690701424798744e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.919494161429498e-10).transl(-1.283545313593311e-07,-2.2916239174403907e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.579338301231828e-09).transl(7.038726468556937e-08,-3.766647323138792e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4273397435219386e-09).transl(-1.7811263296891296e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.93253432576043e-10).transl(-2.6540691781272555e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2483683449102047e-09).transl(-1.2938649713584817e-07,-2.241607604442759e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.202667970481689e-09).transl(-1.0531129826010437e-07,-3.114162693669324e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.09171296739337e-10).transl(-5.692003252141676e-08,-3.898049633263319e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.481682559817941e-10).transl(4.526526103280778e-08,-3.9675029658464364e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.615455156570737e-09).transl(1.158897723360536e-07,-2.7934341684387305e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0125406637242599e-09).transl(7.817505733324668e-08,-3.663508314131323e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.556185205611221e-09).transl(-1.7624324668415626e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.529564757169455e-10).transl(1.0362695006945666e-07,-3.158598884785211e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.7292317274709466e-12).transl(1.262301790848955e-07,-2.3897356044570996e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.897861576807234e-09).transl(-5.0042486067774304e-08,-3.943813545319791e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.636724197821148e-11).transl(-3.672925718977566e-08,-3.993705755821535e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3524873983660536e-09).transl(-1.4984889937398713e-07,-2.006692105151928e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0578142595257274e-10).transl(2.7971639128684628e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.043019210961693e-10).transl(-1.493547945244465e-07,-4.142369477956591e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.9876697649748334e-09).transl(7.390112893411355e-08,-3.7227067330565835e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.5282884859281776e-09).transl(-1.5463302544443736e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8956876532559196e-09).transl(1.003707843010686e-07,3.240019327249021e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9897570715900508e-09).transl(2.6277278093637633e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.2927830844378653e-09).transl(1.5593671841420373e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3244625109671287e-09).transl(-8.714462168141294e-08,3.517336778632409e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.111794274326596e-09).transl(-6.265636903668978e-08,3.849034736331742e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.2097994531914046e-10).transl(-8.707865806603782e-08,3.5185266476783423e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0998011140262026e-10).transl(2.4048183784555857e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.28287722790555e-10).transl(-9.517812794181521e-08,3.3585399668441196e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.405324292705474e-10).transl(1.489631357885478e-07,5.246928449161078e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.553816998480763e-09).transl(-6.36609427034433e-08,3.839406918365779e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.6712072763776955e-09).transl(-1.0106231547554787e-07,3.223205326526464e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4509168759382323e-09).transl(4.456823365461436e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.229246294142767e-10).transl(-4.779680548616231e-08,3.9557656534464143e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.2789556431792274e-10).transl(1.2522211414014967e-07,2.4341891140538207e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.5583182981273063e-09).transl(-1.4197309530991397e-07,1.4383732812980564e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0057934023121135e-09).transl(1.132007936373447e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.1895869124640534e-10).transl(3.456640890902241e-08,3.997102827142513e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.799295083237226e-10).transl(6.256025357839173e-08,3.849939377143321e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.5401961384730564e-09).transl(-2.6138462914601084e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1875765817400015e-09).transl(-9.16084670216746e-08,3.432588396731674e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.481575143807761e-09).transl(3.419619866242005e-08,3.997553684829637e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.040443585106778e-09).transl(-1.0920590137531327e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.410432025031112e-09).transl(-2.7686927751264545e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.1621251344506748e-09).transl(6.307837081523583e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.797106032429538e-09).transl(-6.363044615101839e-08,3.8397038502241365e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7514167434516697e-09).transl(-5.999845157174785e-08,3.872996672589083e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.141881280971819e-09).transl(1.4799952761610268e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.103005011595156e-09).transl(4.3269626390025144e-08,3.97546880750059e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.311902417612075e-09).transl(1.0699904833833043e-07,3.067961059254439e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7303980945957033e-09).transl(7.56375264473752e-08,3.699431815197381e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.933851288599612e-10).transl(8.864258220878375e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.2376144942719277e-10).transl(-4.394526787836183e-08,3.9728983967488645e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0028102178135666e-09).transl(2.7946285551222022e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.760275917722969e-10).transl(-3.4681775617113686e-08,3.996954531900368e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.739817166945465e-09).transl(3.22815697054598e-08,3.9992769401590485e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.536129214702139e-10).transl(-5.0301304686592757e-08,3.942342370275447e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.548718035041725e-11).transl(6.829764568448153e-08,3.7908208338660956e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0293783599946094e-09).transl(-5.219078089485184e-08,3.931011919945279e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.44313172443686e-09).transl(1.3212107758774701e-07,2.100604545870164e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.010963176414478e-09).transl(1.628979350487678e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.9695718658249624e-10).transl(-8.913932281881007e-08,3.480507705067781e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.7959026838569286e-09).transl(-3.837685293506875e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.975351818304688e-09).transl(1.0605999941306468e-07,3.0938786317653126e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.243972743706005e-09).transl(1.0352783377709844e-07,3.161163228244977e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5317145564162023e-09).transl(-2.9553332561019554e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.990260117299999e-09).transl(-7.372530171410588e-08,3.7250052930626684e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.976808939380903e-10).transl(-7.139378276566724e-08,3.754486908035467e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0664719893469528e-09).transl(-1.1765907697191185e-07,2.7316836941573103e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2728053306645666e-10).transl(-7.440923250854409e-08,3.716004435471888e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.106321978431494e-09).transl(-8.150965126638904e-08,3.612748388448727e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.656703797684178e-10).transl(1.3279096817401112e-07,2.063981282712676e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8747875476183377e-09).transl(1.0280801496375343e-07,3.179621388544006e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.6877568384799496e-09).transl(-1.2125436297975885e-07,2.5975717800280795e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.690409294272477e-09).transl(-3.031816657775155e-08,3.999985940257069e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.966018532869647e-09).transl(1.3923453874651873e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.3638786241658205e-09).transl(-1.0065915394120557e-07,3.2330384683955695e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.5788437195996464e-10).transl(-1.4878203030870282e-07,5.6845724528216515e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4069826537644089e-09).transl(1.0787153509899037e-07,3.0433943077730226e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.7159470780318095e-10).transl(-9.507462475134325e-08,3.3607692924672715e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.685818914133536e-10).transl(-4.125488952959606e-08,3.982367729780389e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8164060895520806e-09).transl(-8.670637720318239e-08,3.525208706901132e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.1253201498013387e-09).transl(1.412778327379991e-07,1.4971246296870024e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.315787873348977e-10).transl(1.0117710384807391e-07,3.220389881123869e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.5437894535274224e-10).transl(-5.2315825768564534e-08,3.9302253144723104e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1656282185380742e-09).transl(1.1724628813023669e-07,2.746327893245355e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.345402240274821e-09).transl(-4.274142857078799e-08,3.977388310880438e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.747126601319394e-09).transl(-1.0531985108368399e-07,3.113932853185228e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.167795419706893e-10).transl(-5.2040161297310665e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.568273621813428e-09).transl(-1.3227112480972602e-07,2.092477805578153e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.412042868158796e-09).transl(-7.332453220336324e-08,3.730204776827458e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.474752988633994e-11).transl(-3.205590624504258e-08,3.999412908236462e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.190880566901602e-09).transl(-1.1135852849858929e-07,2.9402928502190305e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.813916531608948e-09).transl(6.595389087681307e-08,3.8162398205007764e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0073786655383017e-10).transl(2.8466707141356705e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7253357003845822e-09).transl(-4.222645372417127e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.4342028088550565e-09).transl(-1.4037572853388837e-07,1.5695712615634833e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1827745670466544e-09).transl(2.0226717050883194e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2336185343512513e-09).transl(-8.529252641763086e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.001995935134335e-10).transl(9.573621440093133e-08,3.346432614032573e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.900525294353283e-10).transl(-5.650650781053864e-08,3.9011971159418714e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.385453585858634e-09).transl(2.4175106031738302e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.146242786859069e-10).transl(-8.795535568520178e-10,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.293523141008962e-10).transl(-9.989894923328353e-08,3.25134790784835e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.9609494068287217e-09).transl(5.799720081807842e-08,3.889609627135149e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4125699051854304e-09).transl(1.4623815606417945e-07,9.936974024092858e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.895329588948386e-09).transl(-4.866467305759203e-08,3.9513190455358916e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.8169920595771232e-09).transl(-7.278307804270727e-08,3.737142139417888e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.95844102216097e-10).transl(-2.1002933725712565e-10,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.034855080352586e-10).transl(9.722650786979927e-08,3.313373011102436e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.543614844401384e-09).transl(5.50170045694722e-08,3.9121107520068735e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2915508512876586e-10).transl(-8.872100179844722e-08,3.488368601157401e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3383836737006041e-09).transl(-1.2686850814975716e-07,2.36090663584057e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1792324429837764e-09).transl(4.4930147709648144e-08,3.968919624808087e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.104732081745792e-10).transl(-6.502776486793087e-08,3.825797765514904e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.4174684283379505e-10).transl(4.7584910893313004e-08,3.956818434167959e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6399215247177214e-10).transl(-1.2846476561557235e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.296794630695924e-09).transl(7.667438216553467e-08,3.685030084222986e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.107350128493859e-09).transl(-1.2101027001148992e-07,2.607069609187829e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.979681362045784e-10).transl(9.181276219435802e-08,3.428505088859792e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3249998506313758e-09).transl(-1.885245068333751e-08,4e-08,0))


    vIsland := hIsland.rotz(pi / 2)
    vIslands := Universe().Inverse()

    hIslands := Universe().Inverse()
    hIslands = hIslands.add(hIsland.transl(-a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, 0, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, 0, 0))

    vIslands = vIslands.add(vIsland.transl(-a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(-a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, -a/2, 0))

    DefRegion(1, hIslands)
    DefRegion(2, vIslands)
    TableAdd(m_full.Region(1))
    TableAdd(m_full.Region(2))
    setgeom(hIslands.add(vIslands))
    save(m)


    r2o2 := sqrt(2) / 2
    m = RandomMagSeed(4)
    B_ext = vector(Bmax*r2o2, Bmax*r2o2, 0)
    relax()
    minimize()

    for B := Bmax; B >= -Bmax; B -= Bstep {
        B_ext = vector(B*r2o2, B*r2o2, 0)
        minimize()
        tablesave()
    }

    