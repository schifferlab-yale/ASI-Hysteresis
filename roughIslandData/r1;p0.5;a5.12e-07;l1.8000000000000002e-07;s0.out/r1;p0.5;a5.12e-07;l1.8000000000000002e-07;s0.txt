
    randSeed(0)
    ThermSeed(0)


    resolution := 2e-09
    zResolution := 5e-09
    a := 5.12e-07

    gridSize := 512 //2*a/resolution
    gridDepth := 5 //25/zResolution

    SetCellsize(resolution,resolution,zResolution)
    SetGridsize(gridSize,gridSize,gridDepth)

    SetPBC(16, 16, 0)


    Msat = 700e3
    Aex = 13e-12
    alpha = 0.2
    Bmax := 0.1
    Bstep := Bmax / 500.0


    TableAdd(B_ext)
    TableAdd(m_full)


    islandWidth := 8e-08
    islandLength := 1.8000000000000002e-07
    ellipseConstant:=4.5000000000000006e-08


    hIsland := rect(islandLength-2*ellipseConstant, islandWidth)
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(islandLength/2-ellipseConstant, 0, 0))
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(-islandLength/2+ellipseConstant, 0, 0))
    
    hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0636884581704287e-09).transl(1.4852755423400912e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.275039274608574e-09).transl(6.183442321687746e-08,-3.709556235766155e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.135841861640548e-10).transl(-8.522650869942336e-08,-1.792886901018493e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2197206850557014e-09).transl(2.499402927418056e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5224747471350032e-09).transl(5.658579740696715e-08,-3.8651535209869395e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1612215788269244e-09).transl(3.16845213746802e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.6147282026396487e-09).transl(-8.02562969135623e-08,-2.485701972251742e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.9120982076637115e-09).transl(3.446216176028786e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.316556500858497e-10).transl(8.244405968962635e-08,-2.2185612403009144e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.012033888330298e-10).transl(6.115370966240861e-10,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5421211931044762e-09).transl(-1.7569190908131066e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0368914812967041e-09).transl(-3.607098942390902e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.615625592131681e-10).transl(3.204755570119155e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.728292194239538e-09).transl(1.9158539321696736e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0552413393180816e-09).transl(5.692091848112033e-08,-3.857093336689263e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.767407457277448e-10).transl(7.733775805924757e-08,-2.7816249322679844e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1382106517043353e-09).transl(4.7627758519573984e-08,-3.993174309738186e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.743576368520218e-10).transl(-3.027115999382893e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6092299919480813e-09).transl(-4.747267498933346e-08,-3.9939567963410685e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.085110968869052e-09).transl(1.2451853739695113e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.799858804721082e-10).transl(6.789610659060744e-08,-3.443533417001678e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.509293473291912e-09).transl(6.86804783794649e-08,-3.4013620437770186e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8008853161580478e-09).transl(-5.556588014063521e-08,-3.8881773844143805e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6574584828495386e-09).transl(8.120547106033559e-08,-2.3754528451745834e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.8377727457949214e-10).transl(4.187665270428723e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.816528132253891e-09).transl(5.1198558705100525e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.048152489627305e-11).transl(1.5741299374453792e-10,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.256145731889487e-09).transl(5.167877998363995e-08,-3.95569927122705e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.557967926560706e-10).transl(4.2064208391575614e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.134129500903693e-09).transl(7.628189433892735e-08,-2.875446450367979e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.348525914747703e-10).transl(-3.9634604383246155e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3360843361735882e-10).transl(1.3311399201378242e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2143688984608041e-09).transl(5.04159091455326e-08,-3.9709243785007474e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.174071921985689e-09).transl(8.083802711218943e-08,-2.419077775843118e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.194231416220493e-09).transl(3.8618523014511554e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.933085930257142e-10).transl(6.966669590306525e-08,-3.345523326285682e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.84213309367737e-09).transl(5.36967843533292e-08,-3.9245888403400914e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.1624358109148723e-09).transl(-4.222311822169657e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.577790665408471e-09).transl(1.8475192572374818e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.5852340210795273e-09).transl(-2.564406621587216e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3130468277085055e-09).transl(7.343761515581195e-08,-3.100046412077813e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.2826275324143044e-09).transl(8.134698095280055e-08,-2.3583161611591085e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1901383745892588e-09).transl(-6.288011033736832e-08,-3.6706931742983195e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.25656590969236e-09).transl(-8.54832460907911e-08,-1.7466311242127596e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.6506663327670984e-09).transl(-4.696873651625913e-08,-3.996170093914012e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3224319710666097e-09).transl(-2.7009553040721408e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.935611923626903e-10).transl(2.0615934560103874e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.915163735354495e-09).transl(-8.24382861609333e-08,-2.2193309712962225e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.354663613325643e-10).transl(-8.043617082381682e-08,-2.4654095653062195e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.8041272709479667e-09).transl(-7.090084264697691e-08,-3.27099800550416e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.742254722951279e-09).transl(-2.7084091731795536e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0392495433767154e-09).transl(7.164803399182581e-08,-3.2232271651233503e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.925955056505452e-11).transl(-4.8664351832774545e-08,-3.98671623964783e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.719000660890071e-09).transl(6.31117138166138e-08,-3.661710668290471e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.390128283126987e-09).transl(8.332104518456698e-08,-2.0969065911595603e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.845418349312215e-10).transl(-2.0579514719032955e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1305058117460668e-09).transl(-3.6821442891258845e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.9976752283277994e-09).transl(-8.121684230385462e-08,-2.3740828338595272e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.7425024260372886e-09).transl(-1.9079521341221365e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.2118943105272762e-10).transl(-7.580130932423327e-08,-2.916150811745284e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.6570697917024617e-09).transl(8.568385211978455e-08,-1.709405618614882e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.1541776038925334e-10).transl(-6.878008512628265e-08,-3.3958668285328686e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4363073065483618e-09).transl(-5.668306095176344e-08,-3.862839574030399e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1358003420564217e-10).transl(6.394053017883999e-08,-3.6284269328821835e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5971851449251878e-09).transl(-7.52481542071342e-08,-2.9615466990840693e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.517083186450427e-09).transl(2.2923727490410692e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.71383630390109e-09).transl(-4.364290675282944e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.814710522952782e-09).transl(5.514591051143831e-08,-3.8970053712253334e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4099600721374604e-10).transl(-8.091071396638242e-08,-2.4105457564313572e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.703222071361586e-11).transl(-1.1902491230282348e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.510577634723343e-09).transl(7.512959090092127e-08,-2.9710806974500843e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.220142280931757e-09).transl(4.4405975898925543e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.081849296279862e-09).transl(7.831470273542942e-08,-2.688988915164271e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.143432167981014e-09).transl(1.3218866651185547e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.953980798813446e-09).transl(-1.4600100604170711e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.16749476237845e-09).transl(-3.386979270712267e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.250005568809712e-10).transl(-2.1360906032744922e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4851448922969143e-09).transl(1.7701912181943663e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6510933923934005e-09).transl(-7.896104131704969e-08,-2.6243270989464795e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.982752748193687e-10).transl(3.5550643285227625e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.796641977209089e-10).transl(5.216216083142926e-08,-3.949011767962223e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1498334537036084e-09).transl(-6.338393095731905e-08,-3.650976349775423e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.663802676951464e-10).transl(-7.132765922934412e-08,-3.243962654643124e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6260571712899932e-09).transl(-6.221695159388611e-08,-3.6956581294658026e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4156290472794585e-09).transl(-6.840175022245569e-08,-3.416570324525172e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.44725969045241e-09).transl(3.499067392564568e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.5894404374348845e-10).transl(1.912061533641844e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.6545479833795835e-09).transl(3.6031953371566093e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9463660763248982e-09).transl(4.472577710717419e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.7957947638729966e-09).transl(2.6175677235544936e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3302224225890786e-09).transl(1.1267474146415577e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.6765180228647154e-09).transl(6.238491471428485e-08,-3.6894401091532145e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.593879556827613e-10).transl(-7.869636893617539e-08,-2.651147017385092e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.2628885549661647e-09).transl(-4.527160693695162e-08,-3.9999271397530155e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.426710896242716e-09).transl(7.979364969987342e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1846341967345e-10).transl(2.025390306758097e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.9621564907187405e-10).transl(7.299202718078136e-08,-3.131925816960925e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1223163579425178e-09).transl(-1.2020197912263627e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.0213579591620855e-09).transl(8.486614982728466e-08,-1.8553947458163448e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.769988686915105e-11).transl(1.4363725562459672e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0832914469867305e-09).transl(4.054204386883194e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.099574094355017e-09).transl(3.812761011698425e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.847032342309104e-09).transl(-5.30953533358949e-08,3.934741999471636e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4491783931715723e-10).transl(-6.155538539323705e-08,3.719465475449781e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2375113546383597e-09).transl(-3.0206964120115865e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.2884914308482152e-10).transl(-5.9457456466155325e-08,3.787941311320528e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.85023040099295e-11).transl(6.063525417349872e-08,3.750793906472382e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.166475707228278e-10).transl(4.1265175022065756e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.6259167080102473e-10).transl(-5.224281210684233e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.816535749400474e-09).transl(6.497403692596436e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1587631423009689e-09).transl(4.662981624697576e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1557141127303896e-10).transl(-4.758176707077308e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.947200505242972e-10).transl(7.626761070623462e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.0724110974269717e-09).transl(4.356956825702662e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.9314535387577965e-11).transl(4.203991348851548e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.7672964091813284e-10).transl(7.696577063226307e-08,2.8153926223283888e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.064754735518152e-10).transl(-3.428113730849788e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.718913724664787e-10).transl(-4.740739508722782e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.832254926313735e-09).transl(-2.638428371478384e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.161163986121833e-10).transl(3.573348188655907e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2701029425366213e-10).transl(-3.664306455798074e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1063116852725873e-09).transl(-5.669498721710812e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3470160676768356e-10).transl(-8.14184600171784e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.7417415662807712e-09).transl(6.813309246119338e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.7995011932688667e-10).transl(-2.505546124469473e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.080008589260353e-10).transl(-2.0860684143941572e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2582902097314104e-09).transl(-1.8167012271986207e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.641157826005687e-09).transl(-3.0390520098592865e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7961289541770697e-09).transl(8.525574784353294e-08,1.7876940452632767e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4268451038653058e-09).transl(2.351150613958362e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2598773115957009e-09).transl(8.544902266660486e-08,1.7528847539200444e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.866830116408735e-11).transl(5.987372284714044e-08,3.7751859016388146e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0131706132539494e-09).transl(3.461286762114063e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.613505824970988e-10).transl(-4.457322355373215e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6363999555330842e-09).transl(-3.417339667490241e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1216630104944987e-09).transl(-4.726099189790801e-08,3.994947837246656e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.0544305507505386e-10).transl(4.258202343318269e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.491009083149319e-09).transl(-6.119454070224405e-08,3.7319964288216666e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.633859428087138e-11).transl(-2.2577812582439586e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.99881512530885e-09).transl(-3.954758752149297e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.645373071808323e-12).transl(-3.883681384526175e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.897585930351787e-09).transl(-2.867788730761664e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.192541316300615e-10).transl(5.1253524386928817e-08,3.961187932798673e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.820169413367633e-09).transl(1.7895813079901253e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1352573048167174e-09).transl(7.559419297227081e-08,2.9333270792868766e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.910830042744984e-10).transl(-7.996532410677986e-08,2.5179668225317406e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.282032748567892e-09).transl(8.403320708659785e-08,1.99041405364966e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.991726626859129e-10).transl(6.12931250073646e-08,3.72860449451251e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.706321523109737e-09).transl(2.0441650446283018e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5716156578093297e-09).transl(-2.0940314911119237e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.090257752357851e-09).transl(-7.272553863833134e-08,3.15059956006263e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1402089811507035e-09).transl(5.747218507284458e-08,3.8432954989714915e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9475147740220087e-10).transl(3.361506316899701e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.770823066097775e-09).transl(-1.1967750087796856e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.114470799670722e-10).transl(-5.962640780428196e-08,3.782813057121461e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.701141620992562e-10).transl(-5.628995903983357e-08,3.8720645080626647e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.29013295498365e-09).transl(-3.252785305688534e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.356991428251405e-09).transl(2.71440761515968e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.3084453583285797e-09).transl(3.645070640684814e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.44721327176446e-09).transl(-7.142916006381166e-08,3.237434739178672e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.4716285798539466e-09).transl(-2.1295589176835676e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.529829556758896e-09).transl(-4.4048079658072206e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.600716682045702e-10).transl(-4.380689984407505e-10,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.235125878419772e-10).transl(2.6325980752094504e-10,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5284689643652882e-09).transl(7.339294189413049e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.9038016239783376e-09).transl(6.87450802920959e-08,3.397801656100291e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.960387403867593e-09).transl(4.5321422756176575e-08,3.9998979615743834e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.98276115199478e-09).transl(4.0184339153304834e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.074012127655315e-09).transl(3.9056524050487184e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.383322885015814e-09).transl(8.376535425731108e-08,2.031353857228093e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.3466190161191754e-09).transl(2.3173637020270252e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5428455160298896e-09).transl(-1.2252909678125179e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.961013006215171e-10).transl(-2.996749828146046e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0431941493141416e-09).transl(-4.893682569266709e-08,3.984663342530721e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.227196928504792e-11).transl(-6.184003002509389e-08,3.70935515477133e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.977613908348463e-10).transl(8.974646470186416e-08,4.240092865027867e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.111334088635953e-10).transl(-9.322984452565209e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.910963490568068e-09).transl(6.7771736899854e-08,3.450043333205852e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.779135674243271e-09).transl(-6.403425881220228e-08,3.624549481652712e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.070237286857871e-10).transl(4.29726527646541e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3259305421063914e-09).transl(-7.246457112829011e-08,3.168608163023321e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0103995713344304e-09).transl(8.731400024500966e-08,1.3612641423714415e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7217192696702618e-09).transl(5.466636600992614e-08,3.9066250718677036e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.3156525395680437e-10).transl(1.5178186599329986e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.405838610803737e-09).transl(4.398096374610053e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4730758950319842e-09).transl(-1.2139300663119347e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.550202457106564e-10).transl(4.8030306347165995e-08,3.990920305701165e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.237666686655504e-09).transl(2.698536819775281e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.292315617151637e-10).transl(-8.502733017641729e-08,1.827770067281163e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.933717137139924e-09).transl(3.751899885096101e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.360021411055766e-10).transl(4.1001810620434254e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5671336269316648e-10).transl(2.8927478538902033e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.072063945722937e-10).transl(2.1288290967019378e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.3322817588781607e-09).transl(-3.4492947324684626e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7216558849305402e-09).transl(-4.955520273153969e-08,3.9794535296524444e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3429212397931952e-09).transl(-3.107324787689572e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.645381694625586e-09).transl(6.338002941161585e-08,3.6511315547713434e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0133406428069476e-09).transl(5.987823706939091e-08,3.775045350872191e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.249662553232453e-09).transl(4.8475187710084745e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.422939711460475e-09).transl(-6.027443437594087e-08,3.7625225627917035e-08,0))


    vIsland := hIsland.rotz(pi / 2)
    vIslands := Universe().Inverse()

    hIslands := Universe().Inverse()
    hIslands = hIslands.add(hIsland.transl(-a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, 0, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, 0, 0))

    vIslands = vIslands.add(vIsland.transl(-a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(-a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, -a/2, 0))

    DefRegion(1, hIslands)
    DefRegion(2, vIslands)
    TableAdd(m_full.Region(1))
    TableAdd(m_full.Region(2))
    setgeom(hIslands.add(vIslands))
    save(m)


    r2o2 := sqrt(2) / 2
    m = RandomMagSeed(4)
    B_ext = vector(Bmax*r2o2, Bmax*r2o2, 0)
    relax()
    minimize()

    for B := Bmax; B >= -Bmax; B -= Bstep {
        B_ext = vector(B*r2o2, B*r2o2, 0)
        minimize()
        tablesave()
    }

    