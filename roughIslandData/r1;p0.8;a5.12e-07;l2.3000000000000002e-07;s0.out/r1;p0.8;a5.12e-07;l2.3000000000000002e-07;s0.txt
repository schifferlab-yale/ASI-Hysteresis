
    randSeed(0)
    ThermSeed(0)


    resolution := 2e-09
    zResolution := 5e-09
    a := 5.12e-07

    gridSize := 512 //2*a/resolution
    gridDepth := 5 //25/zResolution

    SetCellsize(resolution,resolution,zResolution)
    SetGridsize(gridSize,gridSize,gridDepth)

    SetPBC(16, 16, 0)


    Msat = 700e3
    Aex = 13e-12
    alpha = 0.2
    Bmax := 0.1
    Bstep := Bmax / 500.0


    TableAdd(B_ext)
    TableAdd(m_full)


    islandWidth := 8e-08
    islandLength := 2.3000000000000002e-07
    ellipseConstant:=9.200000000000002e-08


    hIsland := rect(islandLength-2*ellipseConstant, islandWidth)
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(islandLength/2-ellipseConstant, 0, 0))
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(-islandLength/2+ellipseConstant, 0, 0))
    
    hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.5867906678879717e-10).transl(-1.1350846252919381e-07,-7.173494198596721e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5637976638924452e-09).transl(1.1097655792472512e-07,-1.1699815451968077e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4660165267383856e-09).transl(-1.0672333230743264e-07,-1.6581149632233107e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.883657573418157e-09).transl(1.0981821863365143e-07,-1.3234806270900271e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.6438765961676726e-09).transl(1.124495750745039e-07,-9.353118006545473e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3274914089003155e-09).transl(-1.0934124712538264e-07,-1.381205909120924e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9194430955408934e-09).transl(-4.217508574566318e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.994103834070141e-09).transl(-1.4222466821497765e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1136956182013117e-09).transl(8.508998924875025e-08,-2.951669046632907e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.709737766544684e-09).transl(-2.895491282365322e-08,-3.99161195491323e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9270878365034808e-09).transl(9.184860409144304e-08,-2.6531964225148545e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.904996321860051e-10).transl(3.108255463333372e-08,-3.984533498842881e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1356719741089575e-09).transl(-5.0259933735554144e-08,-3.820375186380657e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.300174072955043e-10).transl(4.8495946206231984e-08,-3.8433299024703726e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.580561421208795e-10).transl(4.06262373106042e-08,-3.92590055849838e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3959378970712082e-09).transl(7.623381733814499e-08,-3.2623650749201306e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6145474734177255e-09).transl(-8.498842244575413e-08,-2.955701766947333e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6266099472962004e-10).transl(2.06454418367403e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4432867630401728e-09).transl(1.88510609066697e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.33891331788238e-09).transl(9.792341497274546e-08,-2.321300190074936e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4349576203474338e-09).transl(-8.429256491962503e-08,-2.983008429790223e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.2202069283166092e-10).transl(1.390954822361945e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.196153211925505e-12).transl(8.986417852906657e-08,-2.7474620113902126e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.978465368797104e-09).transl(7.62394802418063e-08,-3.262190382814649e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.6105612453833674e-09).transl(-9.242151309090927e-08,-2.6248246030766103e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.123677350160816e-09).transl(4.661586406539741e-08,-3.865970720456455e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.010682123179582e-09).transl(9.486239767099012e-08,-2.4975586571094225e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.742013310190723e-09).transl(-9.567540948213927e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0621889829077035e-09).transl(-3.193503030281693e-08,-3.9810907572145476e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.092142670967719e-10).transl(1.0808835242790325e-07,-1.5211006617777615e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.723648480675074e-09).transl(-1.896187862917388e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9960845843268314e-09).transl(7.448547381564134e-08,-3.3149845922479094e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.733808662705436e-10).transl(-5.013718735210102e-08,-3.8220267643198985e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.792865475452208e-09).transl(5.200801732700269e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1398920060211134e-09).transl(1.0959387630925686e-07,-1.3509784913873213e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.2575620370074525e-09).transl(6.455232420967228e-08,-3.568769268027872e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.229104310983794e-09).transl(-1.9317641047263627e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.563999069385734e-09).transl(7.600267714072003e-08,-3.2694716151947935e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.902599907264e-11).transl(-9.596326759518574e-08,-2.436475181037857e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.098381638448427e-10).transl(2.5271994698039793e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.937751380743875e-10).transl(3.419295745604153e-08,-3.9702860680283067e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.605068408696002e-09).transl(7.10235855807032e-08,-3.4117929661403925e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1963311134467581e-09).transl(-1.1314023469544955e-07,-8.002103800045718e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.921375892427973e-10).transl(-6.701232982178944e-08,-3.512579291238326e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.248705954553496e-10).transl(-8.43183769925564e-08,-2.98200546663184e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.705594393805045e-09).transl(2.719964972038461e-08,-3.995830279946365e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9358636320930037e-09).transl(-8.610294018075029e-08,-2.910777490034703e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.5259973955612115e-10).transl(4.5695859996797616e-08,-3.876373575446413e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1696246085262204e-09).transl(4.0292098939745666e-08,-3.928708574920055e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.491850305486182e-10).transl(-7.730973705195017e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.2878473528201396e-09).transl(-1.0380946847659308e-07,-1.9119709466448013e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.365453380084204e-10).transl(9.769866508760709e-08,-2.3349524001614826e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7215026349621387e-09).transl(1.0489228027689745e-07,-1.8227995414572128e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1730873264504517e-09).transl(-1.0969999251033087e-07,-1.3380510180330583e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.897517540169959e-10).transl(-3.23169634984832e-08,-3.979435367413026e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.3124561715273516e-09).transl(-4.580285499401375e-08,-3.875186392034507e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.419884206076924e-09).transl(-7.107047052705016e-08,-3.4105446026118085e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.584284020589191e-09).transl(-7.337130753355852e-08,-3.3471855336833643e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4814859756733602e-09).transl(-6.9589002672854e-08,-3.449189606458608e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1670196077250443e-09).transl(5.3122508508833345e-08,-3.779517597851267e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.5061703458738674e-09).transl(5.1971683981988614e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.500389172298095e-10).transl(7.071029805476401e-08,-3.42009171422299e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.598476081546207e-10).transl(5.798853963872203e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7655439416065101e-09).transl(3.814667549837856e-08,-3.945416383264076e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.2785892511605156e-09).transl(-1.0856747386175737e-07,-1.469415619422875e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.088449260435708e-09).transl(-1.063882567879109e-07,-1.6897324929353012e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.629853289077233e-11).transl(-5.1305858699484424e-08,-3.805969434091876e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.072694154286778e-09).transl(2.546655848770742e-08,-3.998562144507819e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.09400184244173e-09).transl(4.154487603081039e-08,-3.917892544538677e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9875794330360395e-10).transl(3.810608937639652e-08,-3.945710519092471e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.8087171458535637e-09).transl(-7.817509942258398e-08,-3.200811689266864e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5591834143832012e-09).transl(-9.008838218695944e-08,-2.737110703098088e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.4961541513964553e-09).transl(-1.6241219474256295e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.063569917465071e-09).transl(-7.935816803432014e-08,-3.1616071431218646e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.6423624856328645e-09).transl(1.0979314686202798e-07,-1.3265855497359853e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.302002467207059e-09).transl(-8.454480663032526e-08,-2.9731745767717625e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.86163596833565e-09).transl(5.9304566898739625e-08,-3.675386486703745e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0701082296648316e-09).transl(4.7367551739411075e-08,-3.857142350492206e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.2189186353832006e-10).transl(1.1491346744702912e-07,-1.734477572828898e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.6244769008950585e-09).transl(-5.5542406625923446e-08,-3.7414026895073766e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1248340524342917e-09).transl(-3.201676185937093e-10,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2737007854389419e-09).transl(-4.563937782671143e-08,-3.8769978864782624e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.0265965623957887e-09).transl(5.5377792778617244e-08,-3.744101481926715e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5630939066942925e-09).transl(-1.0476522275277181e-07,-1.833550146640393e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.231689497506182e-09).transl(1.1049610065210674e-07,-1.2362150071131375e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.15469974101037e-10).transl(-6.603375906028997e-08,-3.5354257880914304e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.261895633915651e-10).transl(8.407999977141095e-08,-2.991239138547459e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.458540140603531e-09).transl(8.293943269790581e-08,-3.034541041791346e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.6057753215615304e-09).transl(1.311330818491502e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.371596978987076e-09).transl(7.648825477989782e-08,-3.254488423264993e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6209013291140602e-09).transl(-1.5010090559076443e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7379743729653933e-09).transl(-2.222783696917901e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.380495485015206e-09).transl(7.42718126233766e-08,-3.3212386460866766e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.064663637630652e-09).transl(-5.155362396611855e-08,-3.802469240128057e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5214943925992792e-09).transl(1.1053820801676844e-07,-1.2305670056571723e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.2611892441164037e-10).transl(8.817826600040882e-08,-2.8230062275915555e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.702612304584105e-09).transl(6.878501540126216e-08,-3.46948141031674e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3462762094750508e-09).transl(5.46256720315051e-08,-3.7562341044659695e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.267887535371426e-11).transl(1.4001467175120059e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.5700196626240174e-09).transl(2.5677491804195136e-08,-3.998305651932215e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.660192454292884e-10).transl(-2.7898627194203427e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.008990634047067e-09).transl(2.7324396693010244e-08,3.995578745893288e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0580649127249935e-09).transl(-4.400653932884498e-08,3.894333362129939e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.428309852261011e-10).transl(1.5797020388916487e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.5352469816415566e-09).transl(-5.4154878647346483e-08,3.7636640877907946e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4555472037574708e-09).transl(1.0671239249270655e-07,1.659158772401246e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.4193432697679447e-09).transl(-8.260194947974546e-08,3.047080978887446e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.914990102560941e-10).transl(8.932078049320871e-08,2.772247719672257e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.6288335041772184e-09).transl(1.5363244985310164e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.001283247550075e-10).transl(2.536965035658186e-08,3.998672926642986e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.147749464904148e-10).transl(-6.6663054767370984e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2915665972576054e-09).transl(3.5891678872916856e-08,3.9605341851610236e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.477704120053111e-11).transl(-4.870602261747602e-08,3.840683717779759e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3739551309319833e-09).transl(3.702100254607603e-08,3.953274225653863e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.134301026362417e-09).transl(-5.51619744687547e-08,3.7476161038399126e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.947600772799948e-10).transl(-3.668332429798936e-08,3.9555102950260176e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.439158702411716e-10).transl(1.7688713487576608e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.306489645804745e-10).transl(5.558154582520813e-08,3.7407587131211495e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5073644353504006e-09).transl(9.360767242857882e-08,2.564316936365221e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.968559880404658e-09).transl(6.303709905269567e-08,3.601362559682759e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.676098098157255e-10).transl(-8.974040341591667e-08,2.75314515175237e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0222454858498344e-09).transl(8.071488063086798e-08,3.1149959124414225e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.2764874550018503e-10).transl(4.0846514449209636e-08,3.9240188886155996e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.975815868799453e-09).transl(-9.730951758603442e-08,2.3583081613712507e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2954403918121088e-09).transl(8.140663887517413e-08,3.090525963062734e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.8695797058807064e-09).transl(1.0581546397414407e-07,1.7421706723786048e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6738985123808192e-10).transl(-8.748385953491863e-08,2.8529929429422082e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5265019042185192e-09).transl(-2.0179279191159975e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1747054278618968e-09).transl(-1.1111998388677936e-07,1.1493965210313942e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.90864410781116e-09).transl(7.75122910458621e-08,3.2222085338178744e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.537592760455041e-10).transl(8.211007297495624e-08,3.065140077006861e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.252723247353389e-10).transl(7.330104046594479e-08,3.3491824829993725e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.489956050673939e-10).transl(5.3382766807295264e-08,3.775577543455015e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.9442490777088823e-09).transl(-5.6566675735498824e-08,3.7242571429305133e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0604329609518226e-09).transl(4.414786418811055e-08,3.8928871787585845e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.190318170646394e-09).transl(-1.3604405693328927e-10,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9706507718263924e-09).transl(3.010544711354871e-08,3.9880522465014495e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.5000684631569853e-09).transl(2.250199880299207e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0134167787861567e-09).transl(6.091910106310188e-08,3.64443843697753e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3495767372177226e-09).transl(-6.3940159666286515e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4200225788484725e-09).transl(-1.1071031464408732e-07,1.207178203732775e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.6392133472644193e-10).transl(5.7266973953200044e-08,3.712181575987566e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.137463058580494e-10).transl(5.6479338072007536e-08,3.725742950550025e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5124969570037878e-09).transl(-4.0538921198974585e-08,3.926639723034277e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.233794677297675e-10).transl(6.894316625149745e-10,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9847259578196514e-09).transl(1.016289984598345e-07,2.0767324747426992e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.01036540435012e-10).transl(6.987723578095592e-08,3.4417993177330336e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.5721884296293925e-09).transl(-8.213350936628458e-08,3.064285417993141e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.113580066111662e-09).transl(9.141114456417587e-08,2.67450163172666e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.535517796711377e-10).transl(-1.0893890882763936e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.121897173855742e-09).transl(-7.949874716757835e-08,3.15686055448768e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.907391082806967e-10).transl(-2.0608610672003698e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.4364403359901026e-09).transl(2.4228840234380475e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.2620948234302942e-09).transl(-5.1318152797730315e-08,3.805796549530287e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.852146589563952e-10).transl(3.415698792672783e-08,3.9704774465900975e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.629122635090217e-10).transl(2.357410775932074e-08,3.9999221165103636e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5672278402552506e-09).transl(2.6330411948265885e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.8149502010807555e-09).transl(4.3397538471857273e-08,3.90044843146529e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.573196309499304e-09).transl(-2.5706874580028852e-08,3.9982682522597636e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6207504223732616e-09).transl(-1.1398168823392762e-07,5.934940372236573e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.399454035969442e-09).transl(-7.693718679102896e-08,3.240451986335554e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.45190766227491e-09).transl(-4.8850720610787605e-08,3.838847358686575e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.531419667696914e-10).transl(4.4640755249789904e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0477519548376385e-09).transl(2.5088178065158674e-08,3.9989695062887394e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0531785942706822e-09).transl(1.1125215458510013e-07,1.1300644971201428e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.73066102826587e-10).transl(-9.763203503937031e-08,2.338976617652423e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.560046984536392e-09).transl(8.813798592688623e-08,2.8247631646675636e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.4555451615381105e-10).transl(-7.812356120742957e-08,3.202489874848641e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2381545000579408e-09).transl(-5.8963312592796826e-08,3.681723148841077e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.531104966378824e-09).transl(1.1600125870153745e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.193892208867111e-09).transl(8.978137512241467e-08,2.751266399163663e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.2669197093918563e-10).transl(6.675969327454045e-08,3.518541018236069e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.8549097664438643e-09).transl(3.1022976615777724e-08,3.984761105808508e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7729307324265738e-09).transl(-2.2201915500832038e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.194449709811308e-09).transl(-7.2539103254014e-08,3.370582524913975e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8608397962864662e-09).transl(-6.059566308514378e-08,3.6507673578198835e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.4181440416400314e-09).transl(-8.594261332641367e-08,2.917332153758412e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.2018050037583517e-09).transl(3.7792145666269415e-08,3.9479583454640954e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.1310235879379643e-09).transl(2.0133007933655497e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.518370998929421e-10).transl(8.755068916962568e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0227335336794788e-09).transl(-4.734422681593224e-08,3.8574207620151826e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.2670286132459576e-09).transl(4.7921900330594106e-08,3.850440989133272e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.8149753881998273e-10).transl(9.523552395060047e-08,2.4771275362742818e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.584755034830091e-10).transl(-7.769268322529956e-08,3.216424767164613e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4351393896998106e-09).transl(-9.624066847125146e-08,2.4206907737436016e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.576324906031058e-11).transl(2.724945046763646e-08,3.995730748795253e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.350425016863039e-11).transl(-4.1911201172400545e-08,3.9145809709474605e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.67254168346444e-10).transl(-5.685817452639911e-08,3.719265740933582e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.575639096414705e-10).transl(3.391301844162541e-08,3.97175900818251e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.8027847356433573e-09).transl(-3.201751952517503e-08,3.9807391524246686e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2124948972112425e-10).transl(-9.455861754158578e-08,2.513992695539695e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1693737085468154e-09).transl(-2.8849800049574085e-08,3.991905761116271e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1249862284597366e-09).transl(2.927280760363201e-08,3.9906914099711845e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.392428101761195e-09).transl(1.1275962596648664e-07,8.773666846595594e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.55002988375363e-10).transl(1.4470091374912647e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.828793229104004e-09).transl(-5.298301291091347e-08,3.781613796393508e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.6444427679523634e-09).transl(-2.500941774750291e-08,3.9990457841793e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.191979290892241e-09).transl(1.3076330849213432e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6060110563732559e-09).transl(7.802281452275554e-08,3.2057633243087174e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0094947142284707e-09).transl(-1.4328594509210948e-08,4e-08,0))


    vIsland := hIsland.rotz(pi / 2)
    vIslands := Universe().Inverse()

    hIslands := Universe().Inverse()
    hIslands = hIslands.add(hIsland.transl(-a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, 0, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, 0, 0))

    vIslands = vIslands.add(vIsland.transl(-a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(-a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, -a/2, 0))

    DefRegion(1, hIslands)
    DefRegion(2, vIslands)
    TableAdd(m_full.Region(1))
    TableAdd(m_full.Region(2))
    setgeom(hIslands.add(vIslands))
    save(m)


    r2o2 := sqrt(2) / 2
    m = RandomMagSeed(4)
    B_ext = vector(Bmax*r2o2, Bmax*r2o2, 0)
    relax()
    minimize()

    for B := Bmax; B >= -Bmax; B -= Bstep {
        B_ext = vector(B*r2o2, B*r2o2, 0)
        minimize()
        tablesave()
    }

    