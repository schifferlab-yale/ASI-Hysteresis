
    randSeed(1)
    ThermSeed(1)


    resolution := 2e-09
    zResolution := 5e-09
    a := 3.2e-07

    gridSize := 320 //2*a/resolution
    gridDepth := 5 //25/zResolution

    SetCellsize(resolution,resolution,zResolution)
    SetGridsize(gridSize,gridSize,gridDepth)

    SetPBC(16, 16, 0)


    Msat = 700e3
    Aex = 13e-12
    alpha = 0.2
    Bmax := 0.1
    Bstep := Bmax / 500.0


    TableAdd(B_ext)
    TableAdd(m_full)


    islandWidth := 8e-08
    islandLength := 1.8000000000000002e-07
    ellipseConstant:=4.5000000000000006e-08


    hIsland := rect(islandLength-2*ellipseConstant, islandWidth)
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(islandLength/2-ellipseConstant, 0, 0))
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(-islandLength/2+ellipseConstant, 0, 0))
    
    hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.114492444489935e-12).transl(-1.0743799654852308e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6960789571731912e-09).transl(1.0057610590201134e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.0770901555395194e-10).transl(4.899083218391946e-08,-3.984238833120639e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0862081827941364e-09).transl(-3.669875269461123e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.1018664435385934e-10).transl(6.589356742383081e-08,-3.542708836287958e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.608369295573166e-09).transl(-4.564069210858872e-08,-3.999594560807437e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.555100492498998e-10).transl(6.374430315433301e-08,-3.636469430652052e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.7255142072247165e-09).transl(-1.9127959062004765e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6013820544358809e-09).transl(-4.8720418665350286e-08,-3.986305926901556e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6123964702946392e-09).transl(7.676279262581171e-08,-2.8334858411029375e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4438488302000326e-09).transl(3.832538821161448e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.871930691509468e-10).transl(-8.663226530852406e-08,-1.518295302120053e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.038467166379567e-10).transl(8.889701107875833e-08,-8.801904097092572e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6294168679891287e-09).transl(-4.8178086464718066e-08,-3.990011990623056e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.626019830351415e-10).transl(1.0470773710495324e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0133264235214744e-09).transl(-1.6123315344846366e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2148932513501806e-09).transl(-2.8443413069173132e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6170832756583038e-09).transl(-8.256613329662045e-08,-2.202195320639449e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6458489049538862e-09).transl(7.422811908759412e-08,-3.041399359020159e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0494575361556787e-09).transl(-8.513803784406255e-08,-1.8084857165299006e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.642965815784626e-10).transl(1.878957137890864e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.2434087829764496e-10).transl(-7.453980764929326e-08,-3.017512361481863e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1049181073029084e-10).transl(8.842241894401547e-08,-1.0498433813367371e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5234066467267003e-10).transl(-8.870173702107952e-08,-9.538824891900865e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.780903115881731e-10).transl(-6.134689058078791e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.283998549684112e-10).transl(2.3659750427967745e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.028363983643265e-09).transl(-1.107803884605475e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5039397983752862e-09).transl(1.8662459422329472e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.324475352449337e-10).transl(3.7647015042840486e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4040101093617233e-09).transl(-7.011809841577531e-10,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.427789430814597e-11).transl(-6.984854982647515e-08,-3.334873210564044e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.102295461664236e-09).transl(1.0784611288860594e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.588099567513673e-10).transl(-1.927843454110538e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1676105758358445e-09).transl(2.6703444545835145e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.4051264561680136e-10).transl(-3.5287070045961734e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3483213021951133e-09).transl(-7.010911026678659e-08,-3.319416972886092e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0271455792383799e-10).transl(6.067019721766595e-08,-3.7496415437930735e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0712997518665543e-10).transl(-3.089708777152123e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1034511796142264e-09).transl(6.928961065842676e-08,-3.3672523894590026e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4242654709799122e-10).transl(6.827864472260238e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.4043836084187503e-09).transl(-1.2467798754013958e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0694083441578348e-09).transl(-5.112822181399094e-08,-3.9627349551949787e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5911165855339188e-09).transl(-6.638160851296331e-08,-3.519626037821436e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.338578267848378e-10).transl(1.7891721701836657e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7403247251081008e-09).transl(4.9095221985950915e-08,-3.9834017666629e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.934697832438923e-09).transl(4.9332814776352094e-08,-3.981415311218553e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.668300975626165e-10).transl(7.374642832135183e-08,-3.0774597300769015e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.853957964085479e-10).transl(4.739742151621378e-08,-3.994319294666112e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2581632796656514e-10).transl(3.336212668447892e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.298637264525403e-09).transl(5.1895121498594e-08,-3.9527653575077164e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.3005032987525146e-09).transl(-1.0556576536782424e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8074483852172548e-09).transl(-4.607421609096365e-08,-3.998860143556259e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.601938728917728e-10).transl(-6.655935892103169e-08,-3.51104814898724e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.982725548041834e-10).transl(-3.874551775390953e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.259645248238002e-09).transl(-1.733969276064263e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.060184854358097e-10).transl(-2.2165234440881392e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.6164137851683053e-09).transl(-1.7073381681457384e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.671415128755857e-09).transl(-7.74604107776596e-08,-2.7703142144136876e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.796879037787205e-10).transl(-7.237041562805791e-08,-3.175038879789774e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.838831431211311e-10).transl(4.282262226048126e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.356718760165348e-09).transl(-4.388826897836959e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.5563823656857817e-09).transl(-3.658884531877825e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.150850891558826e-10).transl(1.9853953585434778e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.941361648203579e-09).transl(6.701916125337281e-08,-3.488429170219491e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.060648524579051e-09).transl(-1.2934392187615728e-10,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0000510298347557e-09).transl(1.3662186986400393e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.4698052081184065e-10).transl(3.19634478438721e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.530325657956561e-09).transl(-7.285507298564107e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.42967019332192e-10).transl(1.88924864963182e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.04334272622526e-09).transl(-1.79719664073226e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.7334795894414264e-10).transl(-5.276589699246986e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.4283206926108996e-09).transl(7.289265242292749e-08,-3.138923229154937e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.358044204031933e-10).transl(-4.434010319877904e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.930837451433968e-10).transl(-7.659946492237305e-08,-2.8478782282466386e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.620293263369017e-10).transl(-8.53343189229021e-08,-1.773645680151751e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2196156502404306e-09).transl(1.886886198064793e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.0881293382756036e-09).transl(-1.271064550553868e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.066883568532161e-09).transl(-3.764455760754361e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3426947723033633e-09).transl(8.324140050378975e-08,-2.1083636625123443e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.7931511137943583e-09).transl(5.035223136744299e-08,-3.97160650458652e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.077585901801618e-11).transl(8.602683080050109e-08,-1.6433609751221793e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.8152395007982406e-10).transl(5.467976125385505e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.551739488032648e-09).transl(-8.288388934671111e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.637017052791071e-09).transl(3.493603997470212e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.2334943376192313e-09).transl(-5.8631563436638286e-08,-3.812059334734838e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.710478132203177e-09).transl(-6.688907199672114e-08,-3.4948919645576664e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.694242134456356e-10).transl(2.001864403339914e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.091441938377128e-10).transl(1.5731584273600057e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.204050299272188e-09).transl(5.4920381466464535e-08,-3.9015904642332936e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7585800470620358e-09).transl(-2.9531271583212484e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.010868767201601e-09).transl(-2.5583481048821215e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0036518693765875e-09).transl(-1.736366808087371e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.320180766805091e-10).transl(-7.533792789709259e-08,-2.9542822733121513e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.037726869894979e-10).transl(-1.5724409043281984e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.786742585496214e-09).transl(4.9970199212954615e-08,-3.975527229048623e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.313948665160366e-09).transl(-3.3355205988196135e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.6174961449380185e-10).transl(6.231829638733004e-08,-3.691914807401553e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.459219437860278e-09).transl(-7.471495927766804e-08,-3.0038936972219276e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.566756802703582e-10).transl(-5.221114432192877e-08,-3.948307364240413e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.710841056589456e-09).transl(3.7434488093939355e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.5970370960628123e-09).transl(4.8829694799665564e-08,3.985488182304671e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.2399342491444192e-09).transl(3.313648524110091e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.413237312675162e-10).transl(5.427360212043931e-08,3.9141405476628635e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0972911616573226e-09).transl(3.485260876709028e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.5741199530575794e-09).transl(-2.2113744268185606e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.8320296749221963e-09).transl(-1.897156413852046e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5401212782882938e-09).transl(-8.747524936709121e-08,1.3209893522537386e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.016519153466611e-09).transl(-1.5199025317931567e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.2695309742547607e-09).transl(4.0747118638545626e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.843496218935816e-10).transl(-5.3003333906854026e-08,3.936229087356491e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.357974629576885e-09).transl(-7.146770978674804e-08,3.2349454109013895e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.5047762623055025e-09).transl(-3.87244848999741e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.9548503601253927e-09).transl(-5.6859348609550086e-08,3.858592694836964e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.862063276553907e-11).transl(7.829476570513343e-08,2.6909392757547833e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.133330922228532e-10).transl(-4.166791546372112e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0771407989169028e-09).transl(1.1097997484958192e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.206837263220817e-09).transl(4.7934266500657613e-08,3.9914873171894087e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.862484622742903e-10).transl(8.647042053261042e-08,1.5528973372496636e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.91439182983293e-10).transl(6.727875261219757e-08,3.475381845098535e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9701665948671815e-09).transl(-1.3798791237078685e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.0799167007256467e-09).transl(1.53972104256142e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.532619360135722e-10).transl(-1.5884177921559874e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6942913803662688e-09).transl(-3.1207623663774894e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.7920891344803664e-09).transl(6.434472340939756e-08,3.611538902484543e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4469060839739395e-09).transl(5.884422863525367e-08,3.805998990282731e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.2157432806800644e-10).transl(-2.483339137820676e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.42384167683412e-10).transl(-3.588961862880373e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.121594237337258e-10).transl(-8.978099094061961e-08,3.941583350577152e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.4367218465196243e-09).transl(1.8556130006008805e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4085261211427196e-09).transl(8.268462461761748e-08,2.1861409800436587e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.944391865080296e-10).transl(-5.398228871711074e-08,3.919504619142101e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.6270660883881412e-09).transl(-1.5168017901501814e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.245450399765581e-11).transl(1.5590395015808083e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.2859749690507355e-12).transl(-6.852756042766336e-08,3.409736415370316e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.9790479744321955e-09).transl(-8.469690737713007e-08,1.8838480076910248e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.922891282424295e-10).transl(7.451278033866158e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3363821842753293e-09).transl(5.3357925295282633e-08,3.9304020060237925e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.351642813952682e-09).transl(-6.327570227150175e-08,3.655267081068512e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.7503909679117383e-09).transl(7.898483435840033e-08,2.62189230863526e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.719779632281675e-10).transl(-7.0607534323937e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5919848744513067e-09).transl(-7.925957262115386e-08,2.5934872791643387e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.2743718420349465e-09).transl(4.2751300194932576e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.286118838855077e-09).transl(-1.0463653404715312e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.903171257783331e-09).transl(-2.08734021268008e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.3211298548942433e-10).transl(-1.974605348391231e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3270425898515955e-10).transl(4.217179292205622e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.045672209256783e-13).transl(-4.191480504674396e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7865592288387085e-09).transl(6.046859550366593e-08,3.756249827365315e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8299982236350181e-09).transl(7.730833223297337e-08,2.784325322731783e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.892538529269158e-09).transl(5.655194648056523e-08,3.865953990526837e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.263988749271038e-09).transl(8.573736601453429e-08,1.6993059096004178e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.017020708335206e-10).transl(5.453066605936042e-08,3.909258555663944e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.027583758418936e-09).transl(7.662140012257914e-08,2.8459538415874625e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.642438216649497e-09).transl(8.59272964106005e-08,1.6628552770002824e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.305346135435297e-09).transl(-1.946271020688998e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.857538932149732e-10).transl(8.407325625771305e-08,1.984195620421899e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2895016226598256e-09).transl(3.3773269135335394e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6588059709938197e-09).transl(2.158297714370753e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.2125661215705927e-09).transl(5.2354032436166226e-08,3.946224406579531e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.391590780905435e-10).transl(-5.81650999969755e-08,3.824991391783369e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.846579518032516e-09).transl(-6.581374801841625e-08,3.546419254445701e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.2120393676871504e-09).transl(5.1836192631254107e-08,3.953574005848454e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.8951878962307544e-10).transl(4.5359904627069846e-08,3.999872065765871e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1704010289610456e-10).transl(-1.125110945312071e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.173740030290907e-10).transl(-8.616224076083788e-08,1.616385079524118e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.880604789128894e-09).transl(-3.177039988913777e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0949425222783063e-09).transl(5.3927349081512494e-08,3.9204962531706973e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2777719600117124e-11).transl(-1.0579048696915198e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.989875327394061e-10).transl(5.82729365370522e-08,3.8220456348700516e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.723769536896008e-10).transl(-4.5897888387344735e-08,3.999203670306572e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.9073160585303967e-09).transl(3.153395161131877e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.120024349796381e-10).transl(6.7127141328953e-08,3.483026487689122e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.45281407937766e-11).transl(6.896446163609026e-08,3.385610308850742e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2216058952779466e-09).transl(-6.37379742532866e-08,3.6367271362817756e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.4194703816172713e-09).transl(-1.915467163955981e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.385661679255127e-10).transl(-8.186615427901938e-08,2.2937582184798352e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0979471966933141e-09).transl(7.691456056163773e-08,2.819979265007469e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.591106270744994e-09).transl(3.425722297853746e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5154005247721243e-09).transl(-8.442540500306972e-08,1.928371544229479e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.979859183149413e-09).transl(3.756182560715695e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1270860353260895e-10).transl(2.6764459892236778e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.5967846938604504e-10).transl(6.22793532610994e-08,3.693356278445248e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.676540647630276e-09).transl(-1.536057913856765e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.385782947336657e-09).transl(-4.519269495843835e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5150612704263317e-10).transl(1.624408260776287e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0122459609344381e-09).transl(7.602201700476223e-08,2.8976066220159297e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.321542977622732e-10).transl(3.802796537472516e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2188489557877197e-09).transl(3.737670254153332e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9893042651503707e-09).transl(4.946959887939795e-08,3.9802204153691984e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.1566784710727913e-10).transl(-7.809623625291285e-08,2.7102208314436544e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.315470953438445e-11).transl(4.0595610682964455e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.556947857884283e-10).transl(7.313878405328749e-08,3.1215176201423073e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.5154682923479746e-09).transl(5.947356185186973e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7109168149614851e-09).transl(-1.0385445953211223e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5776935516272089e-09).transl(2.1889794111544803e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.000562741529773e-09).transl(-4.025956070694959e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.2385943368276475e-09).transl(1.41228419161564e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5108362591023872e-09).transl(-4.827724200910443e-08,3.989378178410808e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.3997731072725123e-09).transl(1.940848768432246e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.595033172118645e-09).transl(-8.070809874048148e-08,2.434211607044837e-08,0))


    vIsland := hIsland.rotz(pi / 2)
    vIslands := Universe().Inverse()

    hIslands := Universe().Inverse()
    hIslands = hIslands.add(hIsland.transl(-a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, 0, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, 0, 0))

    vIslands = vIslands.add(vIsland.transl(-a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(-a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, -a/2, 0))

    DefRegion(1, hIslands)
    DefRegion(2, vIslands)
    TableAdd(m_full.Region(1))
    TableAdd(m_full.Region(2))
    setgeom(hIslands.add(vIslands))
    save(m)


    r2o2 := sqrt(2) / 2
    m = RandomMagSeed(4)
    B_ext = vector(Bmax*r2o2, Bmax*r2o2, 0)
    relax()
    minimize()

    for B := Bmax; B >= -Bmax; B -= Bstep {
        B_ext = vector(B*r2o2, B*r2o2, 0)
        minimize()
        tablesave()
    }

    