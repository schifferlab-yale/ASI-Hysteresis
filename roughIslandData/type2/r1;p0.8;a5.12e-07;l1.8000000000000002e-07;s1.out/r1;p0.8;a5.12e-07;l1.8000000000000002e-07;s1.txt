
    randSeed(1)
    ThermSeed(1)


    resolution := 2e-09
    zResolution := 5e-09
    a := 5.12e-07

    gridSize := 512 //2*a/resolution
    gridDepth := 5 //25/zResolution

    SetCellsize(resolution,resolution,zResolution)
    SetGridsize(gridSize,gridSize,gridDepth)

    SetPBC(16, 16, 0)


    Msat = 700e3
    Aex = 13e-12
    alpha = 0.2
    Bmax := 0.1
    Bstep := Bmax / 500.0


    TableAdd(B_ext)
    TableAdd(m_full)


    islandWidth := 8e-08
    islandLength := 1.8000000000000002e-07
    ellipseConstant:=7.200000000000001e-08


    hIsland := rect(islandLength-2*ellipseConstant, islandWidth)
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(islandLength/2-ellipseConstant, 0, 0))
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(-islandLength/2+ellipseConstant, 0, 0))
    
    hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.845229882659716e-09).transl(-1.639273844957839e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.198832063988123e-09).transl(8.264600109659375e-08,-1.7611150913197238e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1893872886820438e-09).transl(-6.283250782308918e-08,-3.1299263600637246e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3107068184678469e-09).transl(-1.7319606626569236e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.314907475490479e-10).transl(6.390876090622133e-08,-3.0813986282764264e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.613131493418186e-10).transl(-2.0022449195457663e-08,-3.998421640469483e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1000317885463635e-10).transl(-6.545101473564469e-08,-3.008425001454316e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9046024129680283e-09).transl(6.107764002595995e-08,-3.2050870684971376e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.597688683186108e-10).transl(-7.579580524179641e-08,-2.3854270112681014e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.2868214094433874e-11).transl(-7.127477042223841e-08,-2.690747083174201e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3512017348594753e-09).transl(8.296055008076296e-08,-1.7250218581587845e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.048174411614666e-10).transl(2.278444812340669e-08,-3.9911588465943376e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1478050966436766e-09).transl(-2.819357193272629e-08,-3.9597087634723284e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1357050553777353e-10).transl(-7.526864867753014e-08,-2.424350414874835e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.57539512943233e-10).transl(2.617593923722927e-08,-3.974126978277448e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1514114294908935e-09).transl(8.699334206121773e-08,-1.143849294042218e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5244949459669408e-09).transl(1.53976722373148e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1592912184763905e-09).transl(-1.7161515003955465e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.9323043723003e-10).transl(6.576663547336821e-08,-2.992969403531622e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.599800744891615e-10).transl(7.444093083629435e-08,-2.4835392198598792e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1068650019488216e-09).transl(2.5668410284533382e-08,-3.977248367822391e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.396473362227035e-09).transl(-7.843554032039283e-08,-2.1741647084741782e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.680550373473793e-10).transl(-2.1413776258598435e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.874822477487359e-09).transl(-4.284382337608278e-08,-3.754332657594785e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.6853427222043726e-10).transl(6.786465272903616e-08,-2.88542335309434e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2155216179749598e-09).transl(-9.328192707541309e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.8593422463339153e-09).transl(7.11861933537412e-08,-2.6961499965934826e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.0969041077127895e-09).transl(8.767724168427467e-08,-1.0078120649428538e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7884512638762781e-09).transl(-4.883798735095748e-08,-3.6145362116224825e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.39201274364987e-10).transl(2.4076524391731514e-08,-3.9857291149973974e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1563477710403013e-10).transl(8.179441379590558e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.871752080434736e-09).transl(-1.951097483944379e-08,-3.999119098616782e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.3468529142103165e-09).transl(1.0732024586599804e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.103169806128664e-10).transl(-6.661907062841463e-08,-2.9503012878313136e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.7083182317859727e-09).transl(4.954700462482741e-08,-3.595601951356135e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.371699929731383e-10).transl(1.802543783398275e-08,-3.9999997503536196e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.6423035173752946e-10).transl(-5.879493523071878e-08,-3.29598205616663e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4178576942591496e-09).transl(-3.2685696255682812e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.062541311393904e-10).transl(8.524892480799435e-08,-1.4289576968147741e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.409593959104764e-10).transl(-2.2276739826986802e-08,-3.992937243252938e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0629727098335437e-10).transl(3.295310162502388e-08,-3.912785607368958e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1429130794761226e-09).transl(6.013854586021807e-08,-3.243389741423705e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.526073817693925e-09).transl(2.205785345623137e-08,-3.99364225654149e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.6477678249464135e-10).transl(-5.4432993496227955e-08,-3.4501015304901944e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4799839108427502e-09).transl(5.28693111628071e-08,-3.499616883366468e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.504465326893654e-10).transl(-8.262207957116447e-08,-1.7638226863325187e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.6641675231965058e-09).transl(-2.0407874412488753e-08,-3.997762545835074e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.2136154720829014e-10).transl(-2.682393268919522e-08,-3.969847080075868e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.127069455028646e-10).transl(-3.1264038272497553e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.412505503585225e-10).transl(8.143066499364867e-08,-1.892603160636911e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1143696824455413e-09).transl(-4.4552401747466725e-08,-3.7180615060099006e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2596384174118187e-09).transl(-1.67091408107651e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.777539559642414e-11).transl(3.2249801288505305e-08,-3.9208776272690364e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0000750422829244e-09).transl(5.510016912757379e-08,-3.428087258992053e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4869650200509297e-09).transl(-2.6910101647519885e-08,-3.969253003948541e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3255964100566554e-09).transl(-8.867652182005114e-08,-7.634175584696375e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.61822136493006e-10).transl(-4.191772903221866e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0837935315707284e-09).transl(6.369752994966293e-08,-3.091074245176987e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.210557828618695e-09).transl(9.779261934828089e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5294617747252376e-09).transl(8.264444382929642e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.173851776915113e-10).transl(5.975612638138617e-08,-3.258619107304005e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.666906124339976e-09).transl(-7.904942084774379e-08,-2.1205696111628223e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7436571603174598e-09).transl(3.4931448744389304e-08,-3.887827650205712e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.616684640222162e-10).transl(-6.726045002325504e-08,-2.9172793343329168e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8970006199062993e-09).transl(2.8299059367771564e-08,-3.95886619264829e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.944721020303345e-09).transl(-4.4139909861171606e-08,-3.727071928723964e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.287687762787691e-10).transl(-1.2518368593542077e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6780464977446002e-10).transl(-1.821082570508091e-08,-3.999982852016514e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.958798767867909e-10).transl(5.3304419893959866e-08,-3.4861267976411e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.2156521172214137e-10).transl(2.78358037231674e-08,-3.962500521914257e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2222958824511916e-09).transl(7.742997135916783e-08,-2.2580982549840502e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1353119363583852e-09).transl(8.603464950056342e-08,-1.3091398402790374e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.6506407254976806e-09).transl(1.8484868659502123e-08,-3.9999092977305234e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.859771124982952e-10).transl(-6.141163512728536e-11,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.289274668951889e-10).transl(4.848837773031156e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.930431250265772e-10).transl(-5.53694292337201e-08,-3.4190487444780955e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3372711767670767e-09).transl(4.086904972226231e-08,-3.7928647129664854e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.0577723499501775e-09).transl(-7.627140291844844e-08,-2.349444117282655e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.8954622037506774e-10).transl(-7.765816581436369e-08,-2.2394493726798004e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.950119794701857e-09).transl(-6.795193834925246e-08,-2.88075985301058e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.191439100262789e-10).transl(3.953416834730756e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6093126388963848e-10).transl(2.1902819381185525e-08,-3.9941191340557655e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.883294663811518e-10).transl(-6.258149512521465e-08,-3.140972903260036e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1239484883330161e-09).transl(1.5239094726061097e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1686086180958065e-09).transl(1.4528415534957256e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7963082796946464e-09).transl(8.109957599725151e-08,-1.926459290524082e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.887824013584304e-10).transl(-8.12365381291794e-08,-1.912548107550227e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.642006780447097e-09).transl(2.980612562241339e-08,-3.945858665798378e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0262242918853939e-09).transl(6.965262693572705e-08,-2.786655884835715e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0193425773053897e-09).transl(-1.1200493724032192e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2339808383717313e-09).transl(-4.2925174226712555e-08,-3.752668058996482e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0522282027059525e-09).transl(-4.348246392974557e-08,-3.7410980893039784e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.281460400476064e-10).transl(-1.4899283667200296e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.267923981653448e-12).transl(-8.969353500275717e-08,-3.6866893881337914e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.2792195067262292e-09).transl(5.646481253242948e-08,-3.3813478012806496e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.150765639837356e-09).transl(1.976301269701786e-08,-3.998800663652032e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.647506902907935e-09).transl(5.02059044915947e-08,-3.577527473938504e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.6259748075298025e-10).transl(3.2915061462494796e-08,-3.913233697060355e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8121801947344438e-09).transl(-8.317990716685185e-08,-1.6992915205982426e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.6377255742614112e-09).transl(-8.241687686727094e-08,-1.7868397292727684e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.382296562638267e-10).transl(5.554031237454137e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.24641091351556e-10).transl(-4.378005593446089e-08,3.734799941762325e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.94390620013379e-10).transl(7.020819599540706e-08,2.75451608469045e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.3783110776529256e-09).transl(3.6681546330928816e-08,3.863009056584143e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.669625613030873e-09).transl(4.590585155754165e-08,3.687342149309644e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1017404426719798e-09).transl(2.227297655724979e-08,3.992949678341704e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.257572151300143e-09).transl(8.957547722266428e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.124051612327981e-10).transl(6.160289043101668e-08,3.1830899393381754e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.441129612555673e-12).transl(2.9654484411701308e-08,3.947249782176604e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.3793551564905145e-09).transl(3.6682217998782265e-08,3.862999031107752e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.045055586604819e-09).transl(-3.512087352327574e-08,3.885266443744737e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7254412504605433e-09).transl(-7.449288099146156e-08,2.4798909756032174e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.24484514462828e-10).transl(2.2561998075238237e-08,3.991962671140911e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.58664041437102e-09).transl(-1.5997587500639888e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4919933624509147e-09).transl(-2.46896575352784e-08,3.982697331087503e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.071295937360371e-09).transl(-8.650944632569011e-08,1.2303464383983845e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.120129967452131e-09).transl(-7.613759228788367e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.172865578490184e-10).transl(-2.8913744329662935e-08,3.953780104316936e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.9670813976720676e-10).transl(1.4532045458293997e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3335643388996596e-10).transl(-8.478598222387456e-08,1.4944677594136625e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.7525832498887796e-09).transl(-5.365941062885506e-08,3.474957337691179e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1248418106658244e-09).transl(6.62108011459721e-08,2.9709076287336342e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.963018838591336e-10).transl(-8.691027466098373e-08,1.1592010421025702e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0235098318534011e-09).transl(3.092274187810723e-08,3.935044645907258e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.041834576311704e-09).transl(-6.483425719577033e-08,3.038107939934443e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.6035715313972663e-10).transl(-8.214659515845692e-08,1.816602385523483e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.3859358293789535e-10).transl(8.730087970222619e-08,1.0849533080036546e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0653316116133793e-09).transl(-2.1881227170892866e-08,3.994184072663746e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.841273331060777e-09).transl(2.423000074777985e-08,3.9849977503140726e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.96271498315189e-10).transl(-7.69024242469136e-08,2.3003652540335493e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0290690004762696e-09).transl(-3.686708131628287e-08,3.8602250152721983e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0177979113258045e-09).transl(4.185998990791751e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.184988321922952e-10).transl(4.590051900514621e-08,3.6874666934019886e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.8154216903161904e-09).transl(-1.0145457484694824e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.148189213108595e-09).transl(8.104878372892668e-08,1.9315851533491835e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.6226016482978643e-09).transl(-1.9655399510027195e-08,3.9989426273990255e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.589470383597375e-09).transl(1.5110109018308795e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.663358566965203e-09).transl(5.151374207603935e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.33502395382678e-10).transl(5.971566988933792e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.1723911661330863e-10).transl(-2.2433331663443647e-08,3.9924100716396035e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.060683921899322e-10).transl(7.845024638924947e-08,2.1729025018032197e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4921479857032955e-09).transl(8.97595675504186e-08,3.266197291340564e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4287951219978058e-09).transl(-3.120087958571415e-08,3.932194113963255e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9203753367427007e-09).transl(7.195747241241251e-08,2.6484278884733967e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5956527336408902e-09).transl(-2.4096984988400075e-08,3.9856326751402664e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4486729763407128e-09).transl(-7.94795883369794e-08,2.081858898928548e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.163723857914786e-09).transl(4.909286588014083e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.853464464314603e-10).transl(-1.2187496388501086e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.63067770267473e-10).transl(7.369711665198783e-08,2.534838244927494e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0981860343245677e-09).transl(7.101894426733513e-08,2.706297838386072e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.802767781479505e-10).transl(5.974032160429462e-08,3.259244000981251e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.6229815150088382e-09).transl(6.597080626846194e-08,2.982873824509427e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.6104379713211805e-09).transl(5.696400395824495e-08,3.3636612894569165e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1343005733730848e-10).transl(-6.855764487016011e-08,2.8479603624125037e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.070652151972986e-09).transl(7.99576980479824e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.910930242252556e-09).transl(4.929069615628057e-08,3.602507843076824e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.344072616354369e-10).transl(8.845260773344885e-08,8.248270742014691e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2846538985340282e-09).transl(2.6912730559497843e-08,3.9692347872373854e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4407906187617483e-10).transl(-8.996133615924649e-08,1.3106988730365841e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6334104516242241e-09).transl(5.4648966332198074e-08,3.443034329091224e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0598310916881164e-09).transl(7.053386599804651e-08,2.7353385391507304e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1875293080500402e-09).transl(7.047513807014875e-08,2.7388155751506408e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.4446457895242354e-09).transl(6.206610035557113e-08,3.1633407482705584e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.551755618835362e-09).transl(3.234362375312325e-08,3.9198216046696166e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.602616015373395e-11).transl(-6.50846270896394e-08,3.02614017479342e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8872716447621244e-09).transl(-1.9358406448055717e-08,3.9992880276561665e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1359196669140904e-09).transl(-5.781193277969543e-08,3.332874972349213e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.4691819046695767e-10).transl(-5.535356189038333e-08,3.419583855855306e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.483913660151361e-09).transl(-6.459132078381146e-08,3.049614844948587e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.292070958556121e-09).transl(-8.628796552100264e-08,1.2677794393337489e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.009334719347359e-09).transl(4.2063143168185367e-08,3.769994081301398e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3012918837102343e-10).transl(-9.39390780371709e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6700844452620119e-09).transl(-6.456779626251454e-08,3.0507236296264066e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.036677775408306e-10).transl(7.765949618530751e-08,2.239339984136695e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.780264300813808e-09).transl(1.283918121634952e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.382987413239132e-10).transl(3.971841252990336e-08,3.813681736375089e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.382093567853591e-09).transl(2.3544283144061785e-08,3.9881231563147045e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.820843517539921e-09).transl(-4.3823242509908764e-08,3.733878988842056e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2718805324912098e-09).transl(-8.913983500182325e-08,6.1645110324791456e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.7636707829320682e-09).transl(-2.5973267981707314e-08,3.975397719714748e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3346604537944077e-09).transl(-7.343250590242288e-08,2.5526779023974874e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9592250685821655e-09).transl(-7.623907320859954e-08,2.3519169695148523e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3647926145259036e-10).transl(8.504864491366012e-08,1.4577159701094377e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2184636346981286e-09).transl(-2.4542174386541452e-08,3.9834534129956165e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.418961399772138e-09).transl(6.464160196454764e-08,3.047241702652564e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.7702589899239755e-10).transl(-8.980537405459314e-08,2.9391071584544117e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.4692887040657084e-09).transl(-6.780569591353081e-08,2.888564434007001e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6136740734677576e-09).transl(1.4388799299844445e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.848238781125964e-10).transl(4.233429618395274e-08,3.764618432467364e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.47646995155769e-10).transl(4.3036980896687233e-08,3.7503701823784285e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.459474613954718e-09).transl(-2.7090079263266848e-08,3.967993265169516e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5586870060738359e-09).transl(-1.4702322638473555e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1460118319451338e-09).transl(-5.846686724422397e-08,3.308440690224877e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.764832794028421e-10).transl(6.990473683211983e-08,2.7721600384856017e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.339898260407392e-09).transl(2.4065270105640795e-08,3.98578202224413e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.6013297900378293e-09).transl(5.400448130537749e-10,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3794397620015166e-09).transl(-2.9326436127495493e-08,3.950196058835563e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.759981269268754e-10).transl(7.875360811890574e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.199625712570927e-09).transl(4.949885894178544e-08,3.596904484193603e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.237768161979995e-09).transl(-4.139661746962467e-08,3.7829206378679916e-08,0))


    vIsland := hIsland.rotz(pi / 2)
    vIslands := Universe().Inverse()

    hIslands := Universe().Inverse()
    hIslands = hIslands.add(hIsland.transl(-a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, 0, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, 0, 0))

    vIslands = vIslands.add(vIsland.transl(-a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(-a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, -a/2, 0))

    DefRegion(1, hIslands)
    DefRegion(2, vIslands)
    TableAdd(m_full.Region(1))
    TableAdd(m_full.Region(2))
    setgeom(hIslands.add(vIslands))
    save(m)


    r2o2 := sqrt(2) / 2
    m = RandomMagSeed(4)
    B_ext = vector(Bmax*r2o2, Bmax*r2o2, 0)
    relax()
    minimize()

    for B := Bmax; B >= -Bmax; B -= Bstep {
        B_ext = vector(B*r2o2, B*r2o2, 0)
        minimize()
        tablesave()
    }

    