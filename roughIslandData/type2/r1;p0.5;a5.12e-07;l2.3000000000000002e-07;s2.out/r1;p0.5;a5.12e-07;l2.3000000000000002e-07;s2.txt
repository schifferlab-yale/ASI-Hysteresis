
    randSeed(2)
    ThermSeed(2)


    resolution := 2e-09
    zResolution := 5e-09
    a := 5.12e-07

    gridSize := 512 //2*a/resolution
    gridDepth := 5 //25/zResolution

    SetCellsize(resolution,resolution,zResolution)
    SetGridsize(gridSize,gridSize,gridDepth)

    SetPBC(16, 16, 0)


    Msat = 700e3
    Aex = 13e-12
    alpha = 0.2
    Bmax := 0.1
    Bstep := Bmax / 500.0


    TableAdd(B_ext)
    TableAdd(m_full)


    islandWidth := 8e-08
    islandLength := 2.3000000000000002e-07
    ellipseConstant:=5.7500000000000005e-08


    hIsland := rect(islandLength-2*ellipseConstant, islandWidth)
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(islandLength/2-ellipseConstant, 0, 0))
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(-islandLength/2+ellipseConstant, 0, 0))
    
    hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4247597247112925e-09).transl(-1.5242150490249488e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.5052389260438476e-10).transl(-5.9089135124027925e-08,-3.9984720859890544e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1722702965093983e-09).transl(-8.850251335678302e-08,-3.368777204866805e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.0889138091718057e-10).transl(-5.2164124616382305e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2652937674440062e-10).transl(3.2334576997678156e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4158621411163534e-09).transl(-3.90764000257296e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.668553692275322e-09).transl(6.074064023235791e-08,-3.993642282557188e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.786110238744288e-10).transl(2.0031033313312157e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.109693185316497e-09).transl(-6.711734182488033e-08,-3.9436525642730495e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.4606096932794005e-09).transl(5.241982109440905e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0157751451010943e-09).transl(-2.2235634901493973e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.911276657528436e-09).transl(9.945304003794106e-08,-2.7354193717908386e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1934562376099578e-09).transl(-6.408130874357955e-08,-3.973712562864068e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.1680744475123807e-10).transl(4.3236003627016895e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.9120078705766965e-09).transl(-7.367346734696439e-08,-3.838505666377661e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0594097527987325e-09).transl(-3.664689895641592e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.16707444481507e-10).transl(8.705351740008614e-08,-3.431222535815928e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.96942949499982e-10).transl(1.1175212744440165e-07,-1.3253162902846041e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0083544378059728e-09).transl(8.886184187469585e-08,-3.3526428584243393e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.6859232246574146e-10).transl(-2.4876398232859884e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.530194863264425e-09).transl(-1.4072308413089605e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.64260587401541e-10).transl(2.5977644631522753e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.4739116373201016e-09).transl(-6.66591416463372e-08,-3.94892771409426e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2152496836869197e-09).transl(-8.004976262497146e-08,-3.679571409615966e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8222106206107028e-10).transl(6.950019331603169e-08,-3.9119196749940516e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.880446019761178e-09).transl(3.06770501227761e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9430400921099406e-09).transl(-9.199197401934723e-08,-3.200418670720332e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.5288897639695493e-09).transl(-5.24765141511003e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1052144382775826e-09).transl(1.1435154617210384e-07,-5.990356877082361e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3199688605618492e-10).transl(-6.355758871170081e-10,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.2540062217207092e-09).transl(3.870474504672075e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9019196282526662e-10).transl(1.54289393939575e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.069790418614145e-10).transl(-8.794088543606893e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0895143935094817e-09).transl(4.3276704371197613e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.270090280035435e-10).transl(1.01457250602359e-07,-2.578618607732528e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0983405554918015e-09).transl(7.961474124445919e-08,-3.692326340421966e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1266740035926847e-09).transl(-5.996002848895997e-08,-3.996337535291616e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0896707269027522e-09).transl(-8.299583373871661e-08,-3.585283905845514e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.372655566117816e-10).transl(-9.367066948340141e-08,-3.109442790409749e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7852809880653277e-09).transl(-1.0386971953633417e-07,-2.365318780560092e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4614459295889088e-09).transl(-8.874813870983241e-08,-3.3577767977843666e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.443291841820057e-09).transl(8.898446752154672e-08,-3.3470762741645365e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.8011708623432744e-10).transl(-9.639109705879682e-08,-2.9462594843487807e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0807282957554285e-09).transl(6.319779789489961e-08,-3.9803130496478334e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4549797305947746e-09).transl(8.526352616623158e-08,-3.5028256846163564e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.587590218269772e-09).transl(7.14006720607331e-08,-3.881353458328573e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.036084610847963e-09).transl(-3.194439540734451e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.819554057791215e-10).transl(8.704771749264239e-08,-3.4314642531153223e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.877867977661149e-10).transl(1.5112925015971816e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7449975681426348e-09).transl(-3.3410393009223106e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.129236840548631e-09).transl(-9.391021841331049e-08,-3.0958835244044866e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.7532802421598837e-10).transl(-3.557076757474295e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.109969064236887e-09).transl(-3.941649545148023e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5022624850018146e-09).transl(-4.91482880189684e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.904198431750354e-10).transl(9.634108386691719e-08,-2.9494505343111773e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8585428972110032e-09).transl(-6.899228773220943e-08,-3.919293063946411e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.927554819990518e-09).transl(-2.685968148889762e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6740414334022484e-09).transl(9.642995949486318e-08,-2.9437746718472874e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.389926010123799e-10).transl(-6.314935609611537e-08,-3.9806471877861526e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.801605999197607e-09).transl(-8.0094260102133e-08,-3.678250203170662e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3025936117576168e-09).transl(-1.0077958171506082e-07,-2.6335077934822872e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.760559171775974e-10).transl(-1.1048762927898615e-07,-1.553285758820511e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5990152653091168e-09).transl(1.097017614349101e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.3530619176429665e-09).transl(6.963863386625464e-08,-3.9098521125500036e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.828412685273672e-09).transl(-5.908195958597078e-08,-3.9984858556474645e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.945367916314359e-09).transl(-8.476933705873923e-08,-3.521562297311591e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6232367571120154e-09).transl(8.480748558241878e-08,-3.5201314504866126e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4198306987987436e-09).transl(3.8344873641770506e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.3905265310817505e-09).transl(-2.9844341577449934e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.8201016464872716e-09).transl(-7.147088617397088e-08,-3.880133275134828e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.859429185365708e-10).transl(6.7500880102079175e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1151554002533233e-09).transl(7.249784445030848e-08,-3.861536745703064e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.084440525505486e-10).transl(8.547070130215292e-08,-3.4948403945438134e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6322401389439182e-09).transl(-8.614351261095283e-08,-3.468367973226171e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.024754583979882e-09).transl(5.651206740066895e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.4317975794739096e-09).transl(2.543274404878453e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.5645726402173104e-09).transl(1.0960734744601062e-07,-1.6912709932333437e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.103213009181212e-10).transl(-4.1244659093559504e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0872814781681054e-09).transl(5.187479137739729e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.251228570925937e-09).transl(-8.323979578475781e-08,-3.576838181218411e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4017513261065597e-09).transl(-5.6371742064503446e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.5863540901324584e-09).transl(9.208839157152673e-08,-3.1953790215547686e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5821608209865057e-10).transl(-7.205312622470795e-08,-3.869762741354481e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.164943802525076e-09).transl(-8.756469010146128e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.952097396188906e-09).transl(7.485220160898003e-08,-3.813513632772201e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1002360838117216e-09).transl(-5.795812938033518e-08,-3.999873036908827e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6704486965077622e-10).transl(-9.761696919993102e-08,-2.8656131159272427e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.418153762563374e-10).transl(-5.843672889356086e-08,-3.999469175503292e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.4046996178420447e-09).transl(-2.6758690352297145e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.540361990446325e-10).transl(1.8898517185184574e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.107185923435713e-10).transl(7.854275829634063e-08,-3.722520729489237e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9239087058146874e-09).transl(5.775429772824263e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.3506162550659783e-09).transl(-1.045223861671583e-07,-2.302120215252311e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.3497408748665226e-10).transl(-8.703137642876251e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0884040894720108e-10).transl(6.509877470926258e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2353948931238179e-09).transl(-8.124329374872621e-08,-3.643056778833307e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8843290209960004e-10).transl(8.661541057677204e-08,-3.4493005617894397e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.949820151406902e-09).transl(-4.913381824596083e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.216491821410887e-09).transl(-8.777544663238084e-08,-3.40062742123109e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1196799497776067e-09).transl(6.107683517872297e-08,-3.992253368340521e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.8197396095494287e-09).transl(-7.715218466414196e-08,3.7591241471479234e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.906775790511642e-09).transl(-5.359724249705876e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.82689702905669e-10).transl(8.640085168066895e-08,3.4580216534164294e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.761450705430878e-09).transl(-4.780073719924206e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.2182399422768785e-09).transl(-8.821779325050909e-08,3.381375648519677e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6000002564062745e-10).transl(4.083441323304343e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0346893867245926e-10).transl(1.1157262728319608e-07,1.3603530798294329e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.5407316665928517e-09).transl(1.563051147096852e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.02948044547277e-10).transl(3.9189260177922326e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.83754571847092e-10).transl(-4.1295837665364966e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.375216983183063e-10).transl(1.7052727083162306e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.787450703000086e-10).transl(8.422259841746611e-08,3.5417870059895286e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.268665778486999e-09).transl(-9.378676100106893e-08,3.102890200566242e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5546619496027567e-10).transl(4.0763508599919074e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.096026306139153e-09).transl(7.929243894654425e-08,3.701588426268246e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5826903950036702e-09).transl(-2.1012182107641875e-10,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.5430115230023023e-10).transl(-9.202490773029972e-08,3.1986997329664663e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6702895016816605e-09).transl(1.4675923766842436e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.53503773746199e-11).transl(-6.051341284767278e-08,3.994503198123521e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8995126992342663e-09).transl(4.9314960499465473e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.149158557662974e-09).transl(-7.712676768215274e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.410255752578679e-10).transl(8.129411148421654e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.667313946191666e-09).transl(-6.543479711399037e-08,3.9617308820067953e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.241141798972548e-09).transl(2.1417100580750066e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0618334912292236e-09).transl(-1.0624902863026173e-07,2.1212055866363466e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8663088383563563e-09).transl(-2.7637586495947498e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5935330144932399e-09).transl(-9.425105249671859e-08,3.076332594089074e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.580814173651985e-10).transl(-3.0827449975318684e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.178685651073827e-10).transl(-8.358291940312157e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.3385713818508455e-09).transl(9.019862338044642e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.438002246322248e-10).transl(1.0346456945010267e-07,2.40328280110447e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.7668360332495855e-10).transl(5.8393953888207935e-08,3.999516550865226e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9890943893654306e-09).transl(-8.39076058794287e-08,3.553201964052126e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.940455600316664e-09).transl(5.0290277842555195e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.349761572666478e-09).transl(-5.957366471865455e-08,3.9973979678242675e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.6417270887574223e-09).transl(5.0945533629354015e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.999549660873315e-10).transl(-9.921629595746915e-08,2.7528852944432485e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.062117333023285e-09).transl(-2.549093513245613e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.284783428174742e-11).transl(-7.360402887464361e-08,3.839918243619053e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0374113906050103e-09).transl(-4.585362532521573e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0704141850055857e-09).transl(-5.851614915916852e-08,3.9993753407971756e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5594935800036356e-09).transl(3.979684279545799e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.671976660733754e-10).transl(2.1237487584401528e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.042277535168129e-09).transl(-1.0588173066586039e-07,2.1615180693867248e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.0018882730887996e-10).transl(7.391366060796718e-08,3.833568492693451e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.319755362536603e-09).transl(6.55069111426925e-08,3.9610286794079326e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8005833888524701e-09).transl(3.038202930625102e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.2298827341573002e-10).transl(9.936319888601395e-08,2.7420721961256632e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.502467419269011e-09).transl(-7.794196564437778e-08,3.7386861879474006e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0490148128479824e-09).transl(1.055798960037217e-07,2.193868589691865e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6149769769093008e-10).transl(-5.2711445005620144e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.898088972679601e-10).transl(4.207255727866462e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.415755368010605e-09).transl(2.57620321383285e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.791703143086165e-09).transl(1.036626071584121e-07,2.3848430783287465e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.911258574628121e-09).transl(4.468628774928147e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.074339798885648e-10).transl(-8.25840322966225e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1589317069996737e-09).transl(2.327547986957262e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.842469956287685e-10).transl(-3.46248179420073e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.3173720029585007e-09).transl(8.913620057744321e-08,3.340145362440427e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5261719470430222e-09).transl(1.236918735255789e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3288904026468262e-09).transl(2.348196643886424e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.26271229143882e-11).transl(9.690544542681366e-08,2.9129979973830792e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.776107850210036e-11).transl(-4.021326656698537e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.491431669723652e-10).transl(4.2185603882030066e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.200436004324981e-09).transl(-1.9919268370945388e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3997737134178917e-09).transl(-2.3430832887187556e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.110761530460374e-09).transl(2.229431331552549e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.954670686349143e-11).transl(-5.741529209392003e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.1794428646516178e-09).transl(-4.9238265021339595e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.557636249600304e-12).transl(-3.8762313847983196e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.646580635794118e-10).transl(6.132664207281368e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.4084699006457423e-09).transl(-2.673269475034855e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.9466916433041504e-09).transl(2.291384822258191e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.845086312129272e-09).transl(1.1294973401262924e-07,1.0586194193582195e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.357056501430032e-10).transl(-6.722062636521653e-08,3.942426906266577e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.299129849817606e-09).transl(-5.159174126567514e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.657739364861683e-10).transl(-1.9306096225709497e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.276278455323069e-10).transl(9.855061225973171e-08,2.800894036561085e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.7182639315130435e-09).transl(7.001727763286576e-08,3.904070259160004e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0859621128875e-09).transl(3.257563149585761e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.703665775236656e-09).transl(-4.817347932497219e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4973434808364687e-09).transl(2.1696665265567872e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.602142275399372e-09).transl(-3.887457608563321e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6542655788133925e-09).transl(9.216257666205292e-08,3.1914864284678874e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.6006505841719264e-09).transl(-1.0145211032712172e-07,2.5790425951608073e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4194115667266488e-09).transl(6.63774763386943e-08,3.9520393767389525e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7234423684628139e-09).transl(-1.830547971358372e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.363179574548089e-09).transl(5.834487543781797e-08,3.999568179637074e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1055283489725158e-09).transl(1.0533744816304079e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3689044895741748e-09).transl(-2.726404347299803e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.084084522370828e-10).transl(3.0876103408508474e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0290615873623864e-09).transl(4.932473151380124e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.937880395746923e-10).transl(-2.062865993788144e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.004491237044907e-09).transl(-1.4205464668623631e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.974407407473986e-10).transl(-1.1171004027028555e-07,1.3336244279686285e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.8459070015117334e-09).transl(7.810630686977758e-08,3.734317706551556e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.41085711040737e-09).transl(-1.1135189850086205e-07,1.4020852356881845e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.189718963294668e-10).transl(8.643971079806105e-08,3.456448573370273e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.16400652387741e-10).transl(1.0519311794046215e-07,2.234350424653917e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.579041387210266e-10).transl(-8.094560931114546e-09,4e-08,0))


    vIsland := hIsland.rotz(pi / 2)
    vIslands := Universe().Inverse()

    hIslands := Universe().Inverse()
    hIslands = hIslands.add(hIsland.transl(-a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, 0, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, 0, 0))

    vIslands = vIslands.add(vIsland.transl(-a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(-a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, -a/2, 0))

    DefRegion(1, hIslands)
    DefRegion(2, vIslands)
    TableAdd(m_full.Region(1))
    TableAdd(m_full.Region(2))
    setgeom(hIslands.add(vIslands))
    save(m)


    r2o2 := sqrt(2) / 2
    m = RandomMagSeed(4)
    B_ext = vector(Bmax*r2o2, Bmax*r2o2, 0)
    relax()
    minimize()

    for B := Bmax; B >= -Bmax; B -= Bstep {
        B_ext = vector(B*r2o2, B*r2o2, 0)
        minimize()
        tablesave()
    }

    