
    randSeed(2)
    ThermSeed(2)


    resolution := 2e-09
    zResolution := 5e-09
    a := 5.12e-07

    gridSize := 512 //2*a/resolution
    gridDepth := 5 //25/zResolution

    SetCellsize(resolution,resolution,zResolution)
    SetGridsize(gridSize,gridSize,gridDepth)

    SetPBC(16, 16, 0)


    Msat = 700e3
    Aex = 13e-12
    alpha = 0.2
    Bmax := 0.1
    Bstep := Bmax / 500.0


    TableAdd(B_ext)
    TableAdd(m_full)


    islandWidth := 8e-08
    islandLength := 3.0000000000000004e-07
    ellipseConstant:=7.500000000000001e-08


    hIsland := rect(islandLength-2*ellipseConstant, islandWidth)
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(islandLength/2-ellipseConstant, 0, 0))
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(-islandLength/2+ellipseConstant, 0, 0))
    
    hIsland = hIsland.add(rect(6.000000000000001e-09,1.0089525462070232e-09).transl(-1.054875582240352e-07,-3.6546017432291706e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1982047474962106e-09).transl(7.261436306816509e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.496281521547842e-10).transl(7.723513845570734e-08,-3.9982233053604326e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.73635337870312e-10).transl(-1.0625729814211738e-07,-3.636058941110745e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.927760103185083e-10).transl(3.668149531701654e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.484878663832066e-10).transl(-1.1384486103475782e-07,-3.42168842893669e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.524777330227084e-09).transl(-9.740981566716904e-08,-3.817266097631564e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.498771781131542e-10).transl(5.7505171729734894e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.578902264929414e-10).transl(-1.1308472340227916e-07,-3.445908659238283e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.2208979583640684e-09).transl(7.368391368801277e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.820325108926932e-10).transl(7.746787761802498e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2801003499160596e-09).transl(9.1711370300258e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5292742127293363e-10).transl(-1.9262320150559154e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.791824785063736e-10).transl(-5.86292827241396e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.310995168739924e-10).transl(7.344856661061038e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.592948929139444e-09).transl(1.44117221798812e-07,-1.552915790119923e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.277317366778757e-10).transl(-1.6552785272614156e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.162326429543984e-10).transl(-9.401087201607537e-08,-3.869364298589959e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.432833631193939e-10).transl(-6.58582819323968e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5596341849301997e-09).transl(-1.3350648997735908e-07,-2.5026865596249672e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.61265073411507e-09).transl(-7.585924849735278e-08,-3.999737481881458e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.739661503870316e-10).transl(-1.1695838223192891e-07,-3.3154696417496416e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.2200031278071165e-09).transl(1.0124781412602121e-07,-3.747042355012366e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.147209623417676e-10).transl(-8.130765267385383e-08,-3.98582859159657e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.8905345412576432e-09).transl(-1.0844906930277347e-07,-3.5801565752092064e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.9979939317538332e-09).transl(1.4858810989160825e-07,-7.7248704513144e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.623723691856605e-09).transl(-1.2443689708654465e-07,-3.008015700410275e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4538977901036139e-09).transl(1.513674787180712e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.4331050266535e-09).transl(-3.642111978998246e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4688768497947893e-09).transl(5.421804852589817e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.2887735647831146e-09).transl(-6.341868405406783e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.937866942357387e-09).transl(1.4797249264324855e-07,-9.237840131302091e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1154203742917822e-09).transl(-1.0341232882759551e-07,-3.7018633897474184e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.538157081261572e-10).transl(8.392448137170384e-08,-3.971580331772514e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.4653577471134866e-09).transl(-1.688002611299792e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.984528852793288e-09).transl(-4.525862832618378e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.8441911342055675e-09).transl(3.473457852649575e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.008052575305733e-09).transl(-7.052938550893913e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0155080423806472e-09).transl(-9.711351673762129e-08,-3.822178042016686e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.451486855184326e-10).transl(-7.221220000899283e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6469287455230516e-09).transl(8.304324094604687e-08,-3.976931265884765e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.267835894634371e-10).transl(7.840989928150825e-08,-3.995863670018775e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.058248651399472e-10).transl(-1.0358132501854072e-07,-3.698161122935503e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.467484769305696e-10).transl(-1.4078841973774409e-07,-1.920654576130707e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.132230797859025e-09).transl(1.1619346281177713e-07,-3.3426424130271755e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.99316973888451e-09).transl(-2.4935896908658934e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0166229537634971e-09).transl(-6.871535205878432e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0457105329475506e-09).transl(1.3274164990739763e-07,-2.5527128873866966e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.928945884691462e-09).transl(1.229604624878987e-07,-3.0752547748373576e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.6229999928492177e-09).transl(-4.8242833268777617e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.824524869644108e-09).transl(-2.240227840762536e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.996656780886485e-09).transl(-9.458243906205024e-08,-3.861247910797692e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.524858097030592e-10).transl(-9.495595431828392e-08,-3.855804471666525e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.452413927250599e-11).transl(-9.862665568764266e-08,-3.7963373753900414e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.4224971200161666e-10).transl(1.3114263276356843e-07,-2.6522301419162626e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.842374261359028e-10).transl(5.724523581129651e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.858436485878031e-09).transl(-1.4822071673979933e-07,-8.661153366111785e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.679886485016621e-10).transl(-1.5177195640834843e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.8720674268513257e-09).transl(-7.44449878282888e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.611256363238596e-10).transl(-1.3159970201478514e-07,-2.6244518482710663e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.480150284243055e-10).transl(1.4423742588111096e-07,-1.5376092101540954e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.794175274094684e-09).transl(9.431398503146524e-08,-3.865092086648145e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.452845758723705e-10).transl(1.4821853896050606e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6252519871027016e-09).transl(-1.0226607143193372e-07,-3.7263024647008163e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3290229332393719e-09).transl(1.2365042818073567e-07,-3.044271075834733e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1348531532109035e-09).transl(1.4724311125073014e-07,-1.0745480521003839e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.6569809757964082e-09).transl(1.3402242190916414e-07,-2.4679873722574832e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1365645667272464e-09).transl(-2.8089335716703804e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0642946237260355e-09).transl(-4.627550244168373e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.3215967177924233e-09).transl(4.335846630091542e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.086472586317456e-10).transl(-1.023846093705202e-07,-3.7238291096721464e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.9814195561171604e-09).transl(-1.3104965574662224e-07,-2.6578179003239053e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1514483126258243e-10).transl(-7.385101264544573e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.297314055409878e-09).transl(5.727557413244012e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.510859236256557e-09).transl(2.2287812244845806e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0974103945409606e-09).transl(-1.1678477706404724e-07,-3.321700193611057e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.8978947802412104e-09).transl(-1.2367576834843905e-07,-3.04311866964068e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.5476979841154035e-10).transl(1.4097199716948154e-07,-1.9026591652044955e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.6845839084151105e-09).transl(-4.489948799816077e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1246129243371494e-09).transl(-1.0904089741356701e-07,-3.564254058845079e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.155796794588453e-09).transl(6.539825749850628e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.3244513260028206e-09).transl(1.4051770945748696e-07,-1.9467979845712108e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.866551100719297e-10).transl(-4.720621602588572e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.475446154488032e-10).transl(1.1283499290764548e-07,-3.453724893807771e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7252519998861425e-09).transl(-3.332299009865924e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.715948619039253e-10).transl(-1.1319320258467576e-07,-3.44249182156607e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1155978066330572e-09).transl(-1.4175412584209458e-07,-1.8234125237611108e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0102251758649613e-09).transl(1.3630288670950983e-07,-2.304441982965212e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.1058080645037483e-09).transl(1.3055068739661412e-07,-2.6874502769963468e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.082568954839046e-09).transl(7.972414829128792e-08,-3.9920569750276356e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.063061772136659e-10).transl(3.819352262076712e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.741432549248815e-10).transl(6.738480864848287e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.8616248266380238e-09).transl(-2.3017475425438182e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.948404969266687e-10).transl(2.3509656009033527e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.442165663443872e-10).transl(1.1459062432189082e-07,-3.397288316102752e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.079140753537405e-11).transl(1.2394419902940453e-07,-3.030847218611269e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.264953228931338e-10).transl(-7.973365190591067e-08,-3.992024952808647e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2545990545878048e-09).transl(8.855706606336502e-08,-3.9341082932856596e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1466270475353286e-09).transl(-1.0281416052376018e-07,-3.7147623722951294e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.4796754567817292e-09).transl(-8.867203408693789e-08,-3.932976429972818e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.073749583533868e-10).transl(4.7406285779869424e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.038414916161021e-09).transl(1.0381760967476563e-07,3.692941638967822e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.549194245391194e-09).transl(-6.150243413043612e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.9936380824509e-10).transl(1.7645697576754618e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.612659590945235e-09).transl(-2.696933667071696e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1213267882916668e-09).transl(1.3671906431069612e-07,2.2726240774260944e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.335332244386657e-09).transl(6.728891748071013e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.810211750299652e-09).transl(-3.317436387021863e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.096157734276058e-09).transl(-8.113741159898018e-08,3.986584499974556e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.045755533152158e-09).transl(1.4631919627299805e-07,1.2377151628941899e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.464346996073684e-09).transl(1.0429049788282895e-07,3.682343884971235e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.771829764798199e-10).transl(-6.284630518666436e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.062223842736048e-10).transl(-8.932112309836707e-08,3.9264003742466245e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.102295247683418e-10).transl(-3.290752790194548e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.915801074068944e-09).transl(-1.6751948758440885e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.152766914813901e-09).transl(-1.3331101623140056e-07,2.515629585062386e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4607615160231648e-09).transl(-3.3208798872687866e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.101957477445125e-10).transl(4.55608816830324e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4764511558141962e-09).transl(3.639178396339892e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.236759198123272e-10).transl(-1.3448575526454167e-07,2.436139705160619e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.734760791734422e-09).transl(2.4338940757930598e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.895670411475122e-09).transl(-6.857221989893096e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.4068460348073336e-10).transl(-9.284572048687924e-08,3.8851165385607876e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2079803025546775e-09).transl(-7.712450258123354e-08,3.998394873957794e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.94791906028674e-10).transl(-1.2066581859249714e-07,3.1730568001761136e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.983533172746732e-10).transl(-5.728795083526563e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.142221804370643e-09).transl(-1.3673136069316432e-07,2.2716739089746013e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.8206707747591496e-09).transl(-7.53528219688888e-08,3.999955739011394e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.4113030870111085e-09).transl(3.565685007533908e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.08275543687168e-09).transl(1.3765984512401708e-07,2.198177060689541e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.89207040596625e-10).transl(-9.691187868489895e-08,3.8254797964286744e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.208831384809709e-10).transl(-1.3590565121236408e-07,2.334210364941075e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.76683293482034e-10).transl(8.931611020815936e-08,3.926452372559464e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2681403157858559e-09).transl(2.246755080483744e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.205173697283822e-10).transl(-4.2554418217870446e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1644275168406359e-10).transl(-2.4785708786964065e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4393161956037445e-09).transl(-8.575980783285423e-10,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0129098542371348e-10).transl(-8.048562470795087e-08,3.989286246268819e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.033839010431226e-10).transl(-8.865019532754561e-08,3.933192193633114e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9237998676353983e-09).transl(-4.120333877226373e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0722766217916054e-09).transl(-1.4768465447535124e-07,9.862211661606484e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.3071195403540437e-09).transl(9.435480224903883e-08,3.864511263126087e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4228060661673404e-09).transl(-3.9659951722678326e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0198952947139659e-10).transl(-1.4040928482821748e-07,1.9571411046468518e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.682553735071801e-10).transl(-2.6844361504953382e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.271147692228872e-10).transl(1.2932476811773642e-07,2.7578127598440266e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2709210239826048e-09).transl(4.954868541175681e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5344307834233917e-11).transl(-1.1828467971115093e-07,3.266611810065912e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.375960395049299e-10).transl(1.4837674034528956e-07,8.277051134364052e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2078808669729033e-09).transl(-4.5052687571779826e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.6548611101922437e-09).transl(-5.629889674512876e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.6880288115196e-10).transl(-1.979993690312888e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.34489685228673e-10).transl(-1.4106602999908317e-07,1.8933556281581204e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9386818733024496e-09).transl(1.4117618505144947e-07,1.8823814945768902e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.584031736710511e-10).transl(4.39049024485759e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.230790796851989e-10).transl(-2.8272741564942353e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.009762239479881e-10).transl(6.716762724539948e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6804896967776532e-09).transl(-8.673651903391628e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.277817711567615e-09).transl(-6.572334034667193e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1831458803969475e-09).transl(3.1339952193258295e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.534595911517344e-10).transl(-1.3293455842108126e-07,2.5402498931796e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.66955828115303e-10).transl(-1.358264049992808e-07,2.3400807309080612e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.738087451977223e-10).transl(-1.3789355614232367e-07,2.179109279085608e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.707853812660359e-09).transl(6.622905745975596e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.127699719895738e-10).transl(-2.6668622764594848e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.3457751256969683e-11).transl(-3.97696568875889e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.8532679371151417e-11).transl(-1.0927035538892377e-07,3.557994038200485e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.337877193782918e-09).transl(2.856774341360009e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.766674642636403e-11).transl(-1.2381983417274177e-07,3.03654718130199e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.5217281726174783e-09).transl(7.292783988612574e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.838282035117886e-10).transl(-6.967159114145748e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.59794263137674e-10).transl(9.011403556355548e-08,3.917937209269122e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.7538862115816175e-09).transl(3.71286490008431e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.716391959582482e-10).transl(-1.2598353520691832e-07,2.9336625937896583e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.145452268403325e-10).transl(-9.458769425471083e-08,3.8611720901081265e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.713256212373488e-09).transl(8.622183147945486e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.2508874409054595e-09).transl(4.15354182783744e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.337813494036253e-10).transl(-2.8859393302955075e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.25798156391573e-10).transl(9.932600541158992e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.668894392002771e-10).transl(-4.674339534316338e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.367613227680482e-09).transl(5.252365745992028e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0754606288139008e-09).transl(-1.1961027739406016e-07,3.215483939059047e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.714318879519541e-10).transl(9.908109173409669e-08,3.788206643062518e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.277371774038225e-09).transl(9.218423538068271e-08,3.893589783108772e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.1444271624664586e-10).transl(8.084856494152815e-08,3.9878194233049367e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.079546659666635e-10).transl(-1.1867738521214163e-07,3.2517093306337094e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.856829495357326e-09).transl(1.0235638496297075e-07,3.724419148821858e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.7746053983588612e-09).transl(7.703356105438025e-08,3.9985293756804524e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.4614869139776047e-10).transl(1.4932721122161918e-07,5.345736830649221e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7032201076717822e-10).transl(1.336248569352698e-07,2.4947952359210706e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.355419250627687e-10).transl(-8.30416574272867e-08,3.976940374668941e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.531798862793337e-11).transl(-5.405261235956801e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.963842925830872e-12).transl(3.1835247532659755e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1463157296312804e-10).transl(-1.2995779398584147e-07,2.721903062470388e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4907995520281382e-09).transl(-5.7089533702548334e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4909188325807268e-09).transl(-5.105710882978561e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.663169948768781e-09).transl(-5.461462558825172e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5503892437938517e-09).transl(-1.8405575489537192e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.558759136570311e-09).transl(1.2954243863862622e-07,2.7455647691869115e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.313577739731394e-10).transl(3.9379800336053216e-08,4e-08,0))


    vIsland := hIsland.rotz(pi / 2)
    vIslands := Universe().Inverse()

    hIslands := Universe().Inverse()
    hIslands = hIslands.add(hIsland.transl(-a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, 0, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, 0, 0))

    vIslands = vIslands.add(vIsland.transl(-a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(-a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, -a/2, 0))

    DefRegion(1, hIslands)
    DefRegion(2, vIslands)
    TableAdd(m_full.Region(1))
    TableAdd(m_full.Region(2))
    setgeom(hIslands.add(vIslands))
    save(m)


    r2o2 := sqrt(2) / 2
    m = RandomMagSeed(4)
    B_ext = vector(Bmax*r2o2, Bmax*r2o2, 0)
    relax()
    minimize()

    for B := Bmax; B >= -Bmax; B -= Bstep {
        B_ext = vector(B*r2o2, B*r2o2, 0)
        minimize()
        tablesave()
    }

    