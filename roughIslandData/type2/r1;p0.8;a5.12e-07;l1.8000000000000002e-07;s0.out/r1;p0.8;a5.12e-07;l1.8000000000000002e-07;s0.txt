
    randSeed(0)
    ThermSeed(0)


    resolution := 2e-09
    zResolution := 5e-09
    a := 5.12e-07

    gridSize := 512 //2*a/resolution
    gridDepth := 5 //25/zResolution

    SetCellsize(resolution,resolution,zResolution)
    SetGridsize(gridSize,gridSize,gridDepth)

    SetPBC(16, 16, 0)


    Msat = 700e3
    Aex = 13e-12
    alpha = 0.2
    Bmax := 0.1
    Bstep := Bmax / 500.0


    TableAdd(B_ext)
    TableAdd(m_full)


    islandWidth := 8e-08
    islandLength := 1.8000000000000002e-07
    ellipseConstant:=7.200000000000001e-08


    hIsland := rect(islandLength-2*ellipseConstant, islandWidth)
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(islandLength/2-ellipseConstant, 0, 0))
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(-islandLength/2+ellipseConstant, 0, 0))
    
    hIsland = hIsland.add(rect(6.000000000000001e-09,1.3197698097074311e-10).transl(-2.0477360384065108e-08,-3.9976315077031636e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.125015963630438e-10).transl(1.9855046386874883e-08,-3.998672157267228e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2289432750497024e-10).transl(7.676972171342542e-08,-2.3108171619464168e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4209141428900953e-09).transl(-3.9679782228896875e-08,-3.8143600674017275e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.180384631020021e-09).transl(8.340949870975528e-08,-1.671841483546378e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.1568904214019964e-10).transl(5.175829890713351e-08,-3.533078805864141e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.004304389287578e-09).transl(-8.934548445381082e-08,-5.3812043735190156e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0493604459716542e-10).transl(-2.817383265345467e-08,-3.959865445844844e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.4772706736343746e-09).transl(4.568096743909977e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.070379377793341e-09).transl(4.8431503660484704e-08,-3.625153715328354e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.185693971121492e-10).transl(-5.483214901134571e-08,-3.436995888605368e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4820206872217208e-09).transl(-5.1941121328262593e-08,-3.527668538544969e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3298003964797163e-09).transl(-8.336115898246782e-08,-1.677666383782353e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.049573072918709e-10).transl(6.43566138113358e-08,-3.060634342760063e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1362192524972335e-10).transl(4.4647190718590344e-08,-3.7159678909657574e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.646119885293448e-10).transl(4.893384170603969e-08,-3.6120073406239406e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.831377666438231e-12).transl(4.045247547584143e-08,-3.800538600965422e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4613556278645888e-09).transl(6.220481715861652e-08,-3.157361640797857e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.575911732063947e-10).transl(7.260512126224386e-08,-2.607136888022528e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.376607814043532e-10).transl(8.433418479342315e-08,-1.5553332458128824e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0109742338534789e-09).transl(-2.104880593751241e-08,-3.996412273108524e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5900375554597612e-09).transl(-4.858814569886916e-08,-3.621082533173154e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.046527974490525e-10).transl(-1.4856480647428659e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.8349635937005686e-11).transl(6.437746688619328e-08,-3.059659146079074e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.681934298439403e-09).transl(-7.790508687812904e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.020235476137527e-09).transl(-8.884779466294984e-08,-7.127368382555194e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0510140599279838e-10).transl(-3.5768004878495266e-08,-3.876288317353648e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.774740282996835e-09).transl(5.787737122936909e-08,-3.330459531483461e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.308491033333005e-09).transl(4.773212145366511e-08,-3.6430218064537934e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6322553554581613e-09).transl(-3.9640835390817066e-08,-3.815042612413328e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.0289589789742727e-09).transl(-1.6715221391685302e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.537402659909274e-09).transl(-8.58395415527027e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.89826873097786e-10).transl(8.331303329126307e-08,-1.6834412161014186e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.927746892572001e-10).transl(-7.426638801643578e-08,-2.4957331362957482e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3059743089787835e-09).transl(-8.850232514254556e-08,-8.116097202146386e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9386649284358906e-09).transl(-7.735457083053479e-08,-2.2642108983827077e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.0521234470343448e-09).transl(6.944912186691537e-08,-2.798251139861924e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.5368781666222836e-09).transl(-2.5816687735946642e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.643426335833403e-09).transl(5.1685717779214734e-08,-3.535216312421985e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.483925091897852e-09).transl(7.134855787519687e-08,-2.686231108796594e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.351792208458012e-09).transl(-6.616396427238924e-08,-2.9732514031063904e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.956199308397986e-10).transl(3.7063349985375465e-08,-3.857247742380044e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.74234592122736e-10).transl(2.41386074775771e-08,-3.985435482128722e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.0874032680261177e-09).transl(-6.897364514517957e-08,-2.8249808808559364e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.8233877986141278e-09).transl(4.504353530111531e-08,-3.7071199423164275e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7334460029622215e-10).transl(8.048311468700239e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4827226635204177e-09).transl(-4.571954355560275e-08,-3.691676868587627e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.729272414319599e-09).transl(-5.068993453702002e-08,-3.563951969635443e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8847642949346286e-09).transl(-2.3336093602620318e-08,-3.9889995748586454e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.8176046703256347e-10).transl(-4.5557218947854404e-08,-3.6954258027682655e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.770788467655963e-09).transl(6.611068781853135e-08,-2.9759124120236603e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.53377472905859e-09).transl(1.1614498776066655e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.993400431374575e-10).transl(-6.5629854235088395e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.53396454293138e-10).transl(-7.785584134493044e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.740286078470546e-09).transl(-7.092700738736625e-08,-2.7118463762855525e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.601246138704346e-10).transl(6.796821695902797e-08,-2.8798883797897226e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.415842311337035e-09).transl(5.111903316835779e-08,-3.551703487127394e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.502952934771024e-10).transl(1.9789079995143052e-08,-3.998764929993076e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.067360107056778e-09).transl(5.435468489797452e-08,-3.45265012098373e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4427882647003422e-09).transl(5.933259080065333e-08,-3.275242398769403e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.054613365478792e-09).transl(-6.416977877570747e-08,-3.069338373130653e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1238813682693632e-09).transl(3.348923578627805e-08,-3.9063432012613005e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.06853312840682e-09).transl(3.868179816365972e-08,-3.831425944429442e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9953001449699403e-09).transl(1.9881124051238298e-08,-3.9986345556426874e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.780403387126367e-09).transl(-8.03401210853356e-08,-2.0013184720943293e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.698743266321686e-10).transl(-5.338246935986399e-10,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.398991223146321e-10).transl(5.162010957151016e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0817260800238899e-09).transl(4.2017939624890394e-08,-3.770883650646534e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.016289494260251e-09).transl(-7.866162260942812e-08,-2.1546443824418046e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.681685252933556e-10).transl(-8.15598957271378e-08,-1.8791740823992394e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.049473316058979e-09).transl(3.551652530432066e-08,-3.879819321419672e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.96325230931332e-09).transl(3.7694321530476796e-08,-3.847451336721348e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6139401236534264e-09).transl(-7.785165910054806e-08,-2.223457228287521e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.2827280275112594e-09).transl(-2.0250218624507965e-08,-3.9980460181694985e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.04044170410034e-10).transl(-1.9593006650655668e-08,-3.9990208407311095e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.531684189965868e-10).transl(-4.5003141263550005e-08,-3.708028644120706e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.188043718312238e-09).transl(3.7791814532155184e-08,-3.845906946257798e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.821457880725622e-10).transl(-8.553979466793278e-08,-1.3859704183924295e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.644066946232249e-10).transl(5.795082099884785e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4434984154796764e-09).transl(-5.973366756506459e-08,-3.259506983647455e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.0332911703172844e-09).transl(-5.0373586515324084e-08,-3.572853277651632e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.058600323180798e-09).transl(2.6751827718458952e-08,-3.9703396905029117e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1760327853900465e-09).transl(-7.970582830272086e-08,-2.0610967006647592e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.8744189411342548e-09).transl(2.3772444934483996e-08,-3.987123905201218e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.5673459402143455e-09).transl(7.576400847904747e-08,-2.3878029343282975e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.0008945457667543e-10).transl(-2.029820102367923e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2314252875652955e-09).transl(2.3923248689846907e-08,-3.98644118840809e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.7536857766693524e-09).transl(-6.080000763731775e-08,-3.216546412185825e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.406381038689055e-09).transl(4.1877969546095687e-08,-3.773626219801974e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4295000160577068e-09).transl(3.707857540703036e-08,-3.85701539783424e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.2432034560434243e-09).transl(6.4521038794192125e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.011959710754794e-10).transl(8.834693430024469e-08,-8.522099712234364e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.919535879196268e-10).transl(8.829948026949132e-08,-8.642113971769284e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6723384747340486e-09).transl(-9.865545178767767e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.992642048726967e-09).transl(2.0357866135446782e-08,-3.997854543179083e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.40335235136813e-10).transl(-4.4540342812953255e-08,-3.7183272338259157e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.154390499318127e-09).transl(-8.161298396689435e-08,-1.8736215268861647e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.908478964469931e-09).transl(1.4181869707513891e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.035830899300267e-10).transl(8.202773623716424e-08,-1.8294985081124214e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.2263513624193934e-09).transl(-6.981662507256289e-08,-2.777242929669555e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.272682312044843e-09).transl(7.882918785014922e-08,2.14001406587282e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.581973691748092e-09).transl(-4.496463736748318e-08,3.7088933541515506e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0080503673056725e-10).transl(8.965082128777624e-08,3.934643880349364e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1414312571819106e-09).transl(-1.7718858140005867e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.2827266679501635e-09).transl(-3.127474429619255e-08,3.9314265481253296e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.4960674941493665e-09).transl(6.372145820687886e-08,3.089981950602839e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.421488316761396e-10).transl(-3.12791145397216e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.0292910252880305e-09).transl(-7.672212789046485e-08,2.314548522767794e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.941640112088792e-09).transl(-7.750265067788997e-08,2.2521831399784282e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.836997793616584e-10).transl(6.029719253491092e-08,3.2370098912425475e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.291062573653526e-09).transl(-7.417594943371588e-08,2.5020132049694203e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.448453188482226e-10).transl(8.517654644595175e-08,1.4394267630404359e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3358682578122894e-09).transl(-7.342601708391531e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.960698137980013e-10).transl(4.1375700225268634e-08,3.7833197254521045e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.7709658691185976e-09).transl(-4.614490688752258e-08,3.6817300919593695e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.754311669217194e-10).transl(-2.7123777972041918e-08,3.9677545487344254e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0150294710835923e-09).transl(-7.838796975608343e-08,2.1782405324237465e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.7487075875309704e-09).transl(4.1344853730132236e-08,3.78390752875502e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.640814495878494e-11).transl(4.14764098339155e-08,3.781394584547257e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4409270121568673e-09).transl(8.926008514113148e-08,5.719801690820523e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5215557884127398e-09).transl(-8.294851462664783e-08,1.726420016517548e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3441062649371848e-09).transl(-1.874609949554481e-08,3.999785231712235e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3212652518920904e-10).transl(4.2800679110702906e-08,3.755212967464319e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.855438228311132e-11).transl(8.06934303869676e-08,1.9669599485607547e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9486694111989526e-10).transl(2.949094724326114e-08,3.9487293359612317e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.0731261616229118e-09).transl(-6.542835428195711e-08,3.0095276741230056e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.794207962132174e-09).transl(6.100784878112684e-08,3.207978548550804e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.562265890672478e-10).transl(-1.6859868679653166e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0407617676280717e-09).transl(-7.682131469625002e-08,2.306762025301397e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.914658661596162e-09).transl(-7.32548294652013e-08,2.5645396554462857e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.5684085055229015e-11).transl(2.3313316405215956e-08,3.989093413503962e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.226443526941395e-09).transl(-7.936614391959203e-08,2.0921637895598498e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.822938395261013e-10).transl(-3.817294750705429e-08,3.839790129326946e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1613947192986797e-09).transl(-2.08177047785528e-08,3.9969357629502866e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.783254571037767e-10).transl(3.855790040916104e-08,3.8334833830403317e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.506353992627079e-10).transl(-8.786556531383946e-08,9.667349646652277e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.433242215506306e-10).transl(7.875623681064346e-08,2.1464007258556696e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.313795494362967e-09).transl(4.990516780035907e-08,3.585834728841334e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.732640046144179e-10).transl(-5.186734861937839e-08,3.529856210783531e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.146564498056286e-10).transl(8.782822109056182e-08,9.750269691230833e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.314859430944178e-10).transl(-4.574583484409099e-08,3.6910672319973763e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.0308976469268847e-09).transl(5.271251615826895e-08,3.504424549880963e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.09804803358989e-09).transl(-4.536460399634359e-08,3.699840857489808e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1335457586339391e-10).transl(-4.3653249532338843e-08,3.737493873991246e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.839510878132622e-11).transl(-8.481440973259113e-08,1.4905408042561504e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.941676120464956e-09).transl(4.063454454012078e-08,3.7972038906577295e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.514171996265578e-10).transl(4.7466805152774374e-08,3.6496691013920215e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.911305169553471e-10).transl(4.829954857497743e-08,3.628563534163153e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.660387651359131e-09).transl(3.724694593637515e-08,3.85443270237884e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.057228592710861e-09).transl(5.0630145824944837e-08,3.565642628798496e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.5304524129138697e-09).transl(-3.021985579064332e-08,3.941969146821606e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1581415446755335e-09).transl(5.53964870896074e-08,3.418135525885939e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.088762845374175e-09).transl(-2.825687627146813e-08,3.959204188473241e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.5559099336105268e-09).transl(5.784308806431942e-08,3.331725692647273e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.051460760937405e-09).transl(-1.2891121111511856e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.4487530353945892e-11).transl(6.951343842390671e-08,2.79459667232064e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3414245393097573e-09).transl(-6.880531115032839e-08,2.8343246408096907e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0540969409472167e-09).transl(4.4135516920466876e-08,3.727167012103305e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.279921487075179e-10).transl(8.988782194241532e-08,2.2319963089868564e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.0621295527865112e-09).transl(-1.9573116760961426e-08,3.9990451420710635e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.822605109002695e-09).transl(5.142719906161583e-08,3.5427818997480557e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.4987086089252882e-09).transl(-3.841763367724694e-08,3.8357964047520964e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.176401272770985e-10).transl(6.067564333887031e-08,3.221642412208491e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.782433752316997e-09).transl(-1.5964173995432116e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.650585803933942e-10).transl(-7.180818381108653e-08,2.6577857644298472e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.165887706001652e-09).transl(8.860952666498585e-08,7.82317592329006e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.906383615447938e-09).transl(-5.5376233290539286e-08,3.4188191887106645e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.6657722438752374e-09).transl(6.800678254508403e-08,2.877821588838906e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.0650597501300627e-09).transl(-8.81879929540152e-08,8.91741334857571e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.836484072519963e-10).transl(-8.797961714795057e-08,9.409300360797886e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3782389500732724e-10).transl(-4.600132649679385e-08,3.685107547562027e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.234622749799728e-10).transl(6.88632557224001e-08,2.8311152632305016e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.737352179194112e-11).transl(-2.4753731018208563e-08,3.982363556726518e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9164229847905715e-10).transl(6.676197217749912e-08,2.9430133153912804e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.4172074256397834e-09).transl(7.351373145799054e-08,2.5472241122070493e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.863609641494363e-09).transl(7.442804006550068e-08,2.4844431365320614e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.2870014428842784e-09).transl(-1.2460828289119443e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.73104176344179e-10).transl(-8.926592442310304e-08,5.69730324230183e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.070366671184242e-09).transl(-4.2867037658508114e-08,3.75385827774766e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.7842230247728536e-09).transl(-7.453742609875278e-08,2.4767557995326736e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.566324512081161e-10).transl(6.147116658410921e-08,3.1886457881672904e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.993354730689525e-09).transl(4.667150091132677e-08,3.6691679328451434e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.035145097610038e-10).transl(8.767053483691148e-08,1.0092421303079842e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2312240195255895e-09).transl(7.30149933347615e-08,2.5804048564872865e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.123420273292115e-09).transl(6.786590947688415e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.423207935943068e-10).transl(5.411175444929471e-08,3.460509663541265e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.55026223602117e-10).transl(2.1103987385826744e-08,3.996281165693118e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.5156470839844607e-09).transl(-7.087893285635114e-08,2.7147394095284045e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.9548351139498503e-09).transl(6.137427455362597e-08,3.1927156224962655e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.336748703212259e-10).transl(4.610649562636781e-08,3.6826356401414495e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.857858290146632e-09).transl(-1.9622356195696106e-08,3.998984423689131e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.206859952575358e-10).transl(5.131593064002198e-08,3.5460153109020824e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.836489974612678e-09).transl(-1.9555580973625282e-08,3.999066313804415e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.3309042206953157e-09).transl(-4.4262224070781694e-08,3.724417092040263e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.4262807836787605e-09).transl(5.654010403663974e-08,3.378700705803653e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6214113983630645e-09).transl(4.5970676222430056e-10,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.59453867107323e-10).transl(3.328067362793157e-08,3.9088776030554644e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.5361054169060202e-09).transl(5.7755299216452126e-08,3.334960799096964e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.116869780670147e-11).transl(4.9282950783651996e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1100298425679827e-09).transl(-5.998319477444338e-08,3.249601759328664e-08,0))


    vIsland := hIsland.rotz(pi / 2)
    vIslands := Universe().Inverse()

    hIslands := Universe().Inverse()
    hIslands = hIslands.add(hIsland.transl(-a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, 0, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, 0, 0))

    vIslands = vIslands.add(vIsland.transl(-a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(-a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, -a/2, 0))

    DefRegion(1, hIslands)
    DefRegion(2, vIslands)
    TableAdd(m_full.Region(1))
    TableAdd(m_full.Region(2))
    setgeom(hIslands.add(vIslands))
    save(m)


    r2o2 := sqrt(2) / 2
    m = RandomMagSeed(4)
    B_ext = vector(Bmax*r2o2, Bmax*r2o2, 0)
    relax()
    minimize()

    for B := Bmax; B >= -Bmax; B -= Bstep {
        B_ext = vector(B*r2o2, B*r2o2, 0)
        minimize()
        tablesave()
    }

    