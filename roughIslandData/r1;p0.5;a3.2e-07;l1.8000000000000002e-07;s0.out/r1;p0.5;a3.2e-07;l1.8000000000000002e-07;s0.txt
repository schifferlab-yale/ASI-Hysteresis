
    randSeed(0)
    ThermSeed(0)


    resolution := 2e-09
    zResolution := 5e-09
    a := 3.2e-07

    gridSize := 320 //2*a/resolution
    gridDepth := 5 //25/zResolution

    SetCellsize(resolution,resolution,zResolution)
    SetGridsize(gridSize,gridSize,gridDepth)

    SetPBC(16, 16, 0)


    Msat = 700e3
    Aex = 13e-12
    alpha = 0.2
    Bmax := 0.1
    Bstep := Bmax / 500.0


    TableAdd(B_ext)
    TableAdd(m_full)


    islandWidth := 8e-08
    islandLength := 1.8000000000000002e-07
    ellipseConstant:=4.5000000000000006e-08


    hIsland := rect(islandLength-2*ellipseConstant, islandWidth)
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(islandLength/2-ellipseConstant, 0, 0))
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(-islandLength/2+ellipseConstant, 0, 0))
    
    hIsland = hIsland.add(rect(6.000000000000001e-09,2.3466874812707784e-09).transl(-4.103056116543976e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.847650782427432e-10).transl(-4.1204775736413464e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.728571823976697e-09).transl(6.873518333706412e-08,-3.398347975649727e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.6899414016530774e-09).transl(-5.4642591080955664e-08,-3.907089282913253e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1836019484040736e-09).transl(-6.834738226691568e-08,-3.419508004501448e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.575297862442332e-09).transl(-3.611250163357355e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.3429326012418017e-09).transl(1.5091970184348182e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.150633394983798e-09).transl(-4.4300190244404264e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0545995711104857e-09).transl(-8.851248370440745e-08,-1.0199540512475149e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.114825732541716e-09).transl(-7.134224382539066e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.526211533315909e-09).transl(-3.532778505652253e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.3615956538588942e-09).transl(8.24338722041131e-08,-2.2199191831467093e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.182315364950217e-10).transl(-8.309850369224667e-08,-2.1287061232832602e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3725164462813e-09).transl(-4.181580692850719e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.8058629630290607e-09).transl(-7.802094066130881e-08,-2.7174679250531055e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.031604675766535e-09).transl(8.396533669116051e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.4382295304783804e-09).transl(-8.47178952633551e-08,-1.8803494203237454e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.845573878515292e-09).transl(5.0506124187957606e-08,-3.969943964702566e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.816669417149522e-10).transl(6.508298374682439e-08,-3.579556508925501e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.9239656715369655e-09).transl(4.2278664053163444e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4643081393493845e-09).transl(7.505022379094395e-08,-2.97742492120222e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9551182404413254e-09).transl(-4.284412158450469e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1588675437566932e-09).transl(6.408993179191106e-08,-3.6222353146922856e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3842422296076835e-09).transl(7.065881033415656e-08,-3.286035341346622e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1353563246640515e-09).transl(7.079717681630177e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5457772716413204e-09).transl(-4.1755646028098564e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.0286924325732055e-09).transl(-8.546470265775623e-08,-1.7500229869544997e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9530800212500076e-10).transl(-4.479965818709837e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1152685166138976e-09).transl(-8.789793860193745e-08,-1.208257559671756e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3114261868245632e-10).transl(-2.386818657083452e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5028913536692297e-09).transl(5.3436301369232206e-08,-3.929078747758039e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.9841951610468343e-09).transl(1.6269815169588745e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.923350679483346e-09).transl(7.413989098654004e-08,-3.0480812059984544e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9204924106543437e-09).transl(-4.673362614741157e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.210769113970021e-11).transl(-2.7930439938797933e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.3168282512056785e-09).transl(-8.92658814468074e-08,-7.195704602790628e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4673689773048546e-09).transl(-7.94277716943546e-08,-2.5758284371385317e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7325646312466855e-09).transl(7.249925378475822e-08,-3.166230508793775e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.370844421854204e-09).transl(7.084873441867398e-08,-3.274253235999729e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.597107928260656e-10).transl(3.9508219030075744e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.057400608433268e-09).transl(-4.305834978884768e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.6400968714950684e-09).transl(-8.099554989006976e-08,-2.400527329905186e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2638087209799833e-09).transl(1.422965862266888e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.446973456383735e-10).transl(-3.038587118710468e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4210468962234368e-09).transl(-6.187684063369355e-08,-3.708033055081837e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.937621281060911e-11).transl(-6.698138313210287e-08,-3.4903111559332685e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.5428564271500774e-11).transl(-2.9949107216469636e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6211348863657148e-09).transl(-4.4445185885267764e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.256867726387552e-09).transl(-5.140797251597741e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2213388160448257e-09).transl(5.7225009191317814e-08,-3.849565401435395e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0569556860887434e-09).transl(3.6198599892307196e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.137148428364306e-10).transl(6.493027172446118e-08,-3.5862940949150924e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.642460292215035e-09).transl(3.931206617423865e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.8079371554650373e-10).transl(-8.050704008389853e-08,-2.457339891842978e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.129785920032698e-10).transl(5.8854567990404256e-08,-3.805701708972106e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.477898187389636e-10).transl(3.4573867605674055e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5905281069118165e-09).transl(-7.379393727180766e-08,-3.073948425810181e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.070034655548274e-09).transl(8.2633492130579e-08,-2.193089519367979e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.960242579901271e-10).transl(3.378737517561409e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4833949417944946e-09).transl(4.3155776830723276e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7601383707249428e-09).transl(5.735797134322895e-08,-3.846209531119377e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.818480807066573e-09).transl(5.875730704869736e-08,-3.808488507692724e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4002625784392328e-10).transl(4.0637673283134e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.2396366223955303e-10).transl(3.946535667628983e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.343919459642882e-10).transl(-8.81187930443983e-08,-1.1444584642743406e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9845604840876843e-09).transl(2.4889057054158665e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.38187780707279e-10).transl(3.663341696044442e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6984049468652632e-09).transl(7.871684414676544e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0695106086661417e-09).transl(7.710326279704884e-08,-2.8030044096931907e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.312239620262649e-10).transl(7.190000262267775e-08,-3.206647242753128e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.484321131369658e-10).transl(3.760079254598e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.936117749555578e-09).transl(1.2801668711906255e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.011195042186527e-09).transl(5.951002396867756e-08,-3.7863528345990515e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.297937724374834e-10).transl(-1.5301111275845297e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.190434410060822e-09).transl(-5.907199130331722e-08,-3.7993933870689966e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1227124387548041e-09).transl(1.5152519379969073e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.3863756379661734e-11).transl(3.549789244867041e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.5862306881211416e-09).transl(-6.98790563080549e-08,-3.3330756134096695e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.559738647964238e-10).transl(6.391584897369103e-08,-3.6294440972615576e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.718623417475726e-10).transl(3.002870813669657e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.605882064216502e-09).transl(6.62679559260592e-08,-3.5250626340034073e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.254372589467812e-10).transl(-7.002504182346956e-08,-3.324429330605691e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.837007370964741e-10).transl(4.985385021574493e-10,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7120142407093074e-09).transl(3.581837439751885e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8606015288952595e-09).transl(5.066872988377111e-08,-3.9681353038509e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1733932116562355e-09).transl(3.9143446656447965e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6729126611958544e-09).transl(-1.8841524788786857e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.57604791988542e-10).transl(-8.84719262218693e-08,-1.0335283182740543e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9533951506397274e-09).transl(-8.12745812610085e-08,-2.3671075300819772e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.934859061671645e-10).transl(5.961697456503877e-08,-3.7831011430163264e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.3103429683023185e-09).transl(5.756421297053239e-08,-3.8409263825279e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6889807481626167e-09).transl(8.401337432987453e-08,-1.993483950008115e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.179836368209842e-10).transl(-2.8135538631093755e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1482698188929764e-09).transl(-7.758360357130963e-08,-2.758863646273192e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7947557447031601e-09).transl(2.937051712716527e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.845802558430501e-09).transl(6.028804909730911e-08,-3.76208563621411e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.984616255346879e-09).transl(4.810232666840453e-08,-3.990483067875682e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7784006658479736e-09).transl(8.131893605516889e-08,-2.361727568270799e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.612731290758431e-10).transl(2.9018567457464437e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.9877787438935503e-11).transl(-6.349547014989529e-08,-3.646522533745099e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5299786807598293e-09).transl(2.295593984098033e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.353120813110469e-10).transl(5.034258002863493e-08,3.971709177012646e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.456191175484414e-10).transl(-5.498506032696943e-08,3.900286607022965e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.147030380862289e-10).transl(8.521583336163912e-08,1.794778153003806e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.85811136802343e-10).transl(-8.721354323873275e-08,1.3856884504932012e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5900253824100487e-09).transl(-6.908583392603545e-08,3.3787982132156336e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8407234556558068e-09).transl(-8.253699167461833e-08,2.206118103048789e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.2777866144469144e-10).transl(6.714936047045909e-08,3.481910451333931e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.526008221298543e-10).transl(-3.805951333071347e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.4454637503675663e-10).transl(2.1819075919294267e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.928680878948751e-10).transl(1.155371122088357e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.185627168609996e-09).transl(-1.6283169104867674e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.826069043410536e-10).transl(-7.410388330573764e-08,3.0507982055635346e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7905691391671015e-09).transl(-4.704129827750372e-08,3.995882425232821e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.338990137635135e-09).transl(7.426509745123077e-08,3.0385884587403175e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.145319616336099e-10).transl(3.816604088608798e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.551776145814476e-10).transl(-4.9051941228804364e-08,3.983751464584826e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9839010878343306e-09).transl(3.1545827113886986e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.712323907878082e-10).transl(4.1331490059318503e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.110377815686843e-09).transl(-7.579757895096702e-08,2.9164620958644316e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.52776216115749e-10).transl(1.1434678177297674e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.5785649783359988e-09).transl(-4.513413674241304e-08,3.999982229426536e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.570815879883469e-10).transl(-1.3489643055456345e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.869150895585925e-11).transl(-8.096291435214586e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.273094909142487e-10).transl(-8.398555108196044e-08,1.9977801148637505e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.367678535628569e-09).transl(5.1861222222307134e-08,3.953231406709144e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.523670596500757e-10).transl(3.984740035874214e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.83118523235198e-10).transl(-1.3671435907292519e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.718590940773887e-10).transl(-7.114326432061547e-08,3.255724355927151e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.127668713967627e-09).transl(-7.384877287668206e-08,3.069883406010026e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.282231248785639e-10).transl(3.1227485134758526e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.516197374096499e-09).transl(-1.224152178106325e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.0554037913685767e-10).transl(7.84791201162075e-08,2.6728055505532113e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.161924188992145e-09).transl(6.313790178297055e-08,3.6606863218464366e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1785462785445155e-09).transl(-3.279993680178338e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.246362118453049e-09).transl(-1.00825166199483e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.449082469908518e-09).transl(-5.283261103326326e-08,3.938941593154723e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7861601316051217e-10).transl(7.797891133409683e-08,2.7214976373979662e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.4272115410603713e-09).transl(5.97034023296897e-08,3.7804539121874034e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.3506209922934368e-09).transl(-8.617193757237179e-08,1.614432576936964e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.775798208284487e-11).transl(-3.96342096057809e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9870103753136543e-09).transl(6.289571981720365e-08,3.670092096640138e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8706273523479763e-09).transl(-8.912199967592851e-08,7.862981916559428e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5629303527551143e-09).transl(2.936397272034734e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.987777308845276e-10).transl(4.2103374790564434e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.350673347749539e-11).transl(-7.621236306995022e-08,2.8814103427275247e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.1362885653044544e-09).transl(3.5531124435104575e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.792531013111033e-10).transl(2.4752024750871457e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.721268568066708e-10).transl(7.738969834567594e-10,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.430096657660873e-09).transl(2.7319443908155917e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3918410671990505e-09).transl(3.1521431255254977e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2808732421389597e-09).transl(1.1668939607659015e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.210977744990211e-10).transl(-3.696598283347113e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.215931095634438e-09).transl(4.8713982591828706e-08,3.986353346595338e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2764726094264162e-10).transl(7.784745980738087e-08,2.7340297348839542e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.8949112425343267e-09).transl(-8.383456073822365e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.169236199730457e-09).transl(5.928652479838145e-08,3.7930621101347795e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.616174062592863e-09).transl(8.81799150310991e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.203250849812432e-09).transl(-6.946020780958191e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.902972958099997e-10).transl(-2.789981043400804e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.729688024342809e-10).transl(-5.8618448830419845e-08,3.812429679464931e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.2674633034272733e-09).transl(-4.375262133747967e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2547875776238907e-09).transl(-5.857540858860102e-08,3.813642340914407e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.253772284085179e-10).transl(3.765462436373272e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7324860629554197e-09).transl(7.52069570949143e-08,2.9648671936660326e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.540034594658334e-09).transl(-8.470915463254461e-08,1.8818074597326563e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.2772465640198035e-10).transl(-3.6288739610241956e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.593441001083827e-09).transl(7.670981674963514e-08,2.838170193634628e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1669908449698407e-09).transl(-8.288149762507153e-08,2.1590892230384094e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.4337801352636557e-09).transl(-2.3517348895898983e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.322570927992738e-09).transl(-8.157088548935848e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.340202864791424e-09).transl(5.029899613869225e-08,3.97217048847455e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.402563699163214e-09).transl(7.96188954845725e-08,2.5555085219683408e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6276055380629092e-09).transl(-2.1131708391838335e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.370501502290375e-10).transl(7.301100162445259e-08,3.130585131116817e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.633438845994357e-10).transl(-9.916247326009009e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4811121218696037e-10).transl(4.4939853015555204e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.7843505539470354e-09).transl(1.4540740408693352e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0402920839805555e-09).transl(-5.350070993746909e-08,3.927981725897513e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7399495485463407e-09).transl(-8.838287859722238e-08,1.0626808665575397e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.949276198056412e-09).transl(-1.9954580759390323e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.3160827674642857e-10).transl(7.205848301254435e-08,3.196094526712682e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.430125271384865e-10).transl(-1.0794610264873463e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0589103906236368e-09).transl(5.743422101676259e-08,3.8442673281808736e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0151373347715276e-09).transl(-6.598242467278647e-08,3.53855698269918e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3011885811479672e-10).transl(1.8723103182486808e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3291027767132035e-09).transl(-5.884795620224662e-08,3.8058918420325155e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.995715682018586e-10).transl(-1.9058407493960807e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1563393574081475e-09).transl(-6.87918828669615e-08,3.3952138392857245e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6634198880634957e-09).transl(5.389545450777836e-08,3.921069029439547e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.275528573735213e-10).transl(2.3957329548623104e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.350725495184011e-09).transl(-6.71402001096115e-08,3.482370742468536e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3874109514519855e-09).transl(-4.057528492085604e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.673271040157643e-10).transl(3.3699252249746265e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.582044597535143e-09).transl(-8.569622151735914e-08,1.7070776223045982e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.221325712426373e-10).transl(-2.981416781711858e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.850712372590081e-10).transl(3.745483799025217e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.20947907915627e-11).transl(-3.889998893319586e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6183275943818619e-09).transl(1.0144757797184815e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.485402780727357e-09).transl(1.462138660338799e-08,4e-08,0))


    vIsland := hIsland.rotz(pi / 2)
    vIslands := Universe().Inverse()

    hIslands := Universe().Inverse()
    hIslands = hIslands.add(hIsland.transl(-a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, 0, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, 0, 0))

    vIslands = vIslands.add(vIsland.transl(-a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(-a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, -a/2, 0))

    DefRegion(1, hIslands)
    DefRegion(2, vIslands)
    TableAdd(m_full.Region(1))
    TableAdd(m_full.Region(2))
    setgeom(hIslands.add(vIslands))
    save(m)


    r2o2 := sqrt(2) / 2
    m = RandomMagSeed(4)
    B_ext = vector(Bmax*r2o2, Bmax*r2o2, 0)
    relax()
    minimize()

    for B := Bmax; B >= -Bmax; B -= Bstep {
        B_ext = vector(B*r2o2, B*r2o2, 0)
        minimize()
        tablesave()
    }

    