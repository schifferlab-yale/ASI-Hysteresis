
    randSeed(2)
    ThermSeed(2)


    resolution := 2e-09
    zResolution := 5e-09
    a := 3.2e-07

    gridSize := 320 //2*a/resolution
    gridDepth := 5 //25/zResolution

    SetCellsize(resolution,resolution,zResolution)
    SetGridsize(gridSize,gridSize,gridDepth)

    SetPBC(16, 16, 0)


    Msat = 700e3
    Aex = 13e-12
    alpha = 0.2
    Bmax := 0.1
    Bstep := Bmax / 500.0


    TableAdd(B_ext)
    TableAdd(m_full)


    islandWidth := 8e-08
    islandLength := 1.8000000000000002e-07
    ellipseConstant:=4.5000000000000006e-08


    hIsland := rect(islandLength-2*ellipseConstant, islandWidth)
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(islandLength/2-ellipseConstant, 0, 0))
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(-islandLength/2+ellipseConstant, 0, 0))
    
    hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.8684296348317176e-09).transl(7.47560469968156e-08,-3.000678332691273e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.321618865479881e-10).transl(3.105503665017437e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.3168743088414013e-09).transl(-5.421287085893493e-08,-3.915273553256822e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.234041853912507e-10).transl(-2.5677951702603104e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.750086870739223e-09).transl(8.880453886128163e-08,-9.158678006947202e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7475975095032591e-09).transl(-7.20171591254007e-08,-3.198855490133581e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.733126119896853e-10).transl(5.4954736877187426e-08,-3.900899004917411e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.916740263031777e-09).transl(-8.8850895548127e-08,-8.981691539758186e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.2920698186584027e-10).transl(5.165780266668867e-08,-3.955978667659153e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.511540272385803e-09).transl(8.607437203891458e-08,-1.633950810831813e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9958072300329952e-09).transl(6.1680638782414755e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.87763040789565e-10).transl(-3.707532402205575e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.0568065159095444e-09).transl(3.435048946379756e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5016829215444677e-09).transl(-1.0836850241391901e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.4061461693586583e-09).transl(-4.50632721456909e-08,-3.999996046057878e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.849321277820435e-09).transl(-2.83243793946514e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1410693548199565e-09).transl(-4.773466292539141e-08,-3.992607112531603e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3485865259451667e-09).transl(1.4567727586767758e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.175881211681123e-09).transl(-1.999869281098852e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7522356792881086e-09).transl(1.4046887129751015e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.778812116474386e-10).transl(6.426479301900582e-08,-3.6149131437037866e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0478565311959634e-09).transl(3.444183711317721e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.733253627352371e-09).transl(1.6600769035855183e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.588228379569599e-11).transl(-8.700794061066944e-08,-1.4342076248968834e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.992455732561676e-10).transl(7.512149277604654e-08,-2.9717294101999795e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.5869510669651224e-10).transl(-2.026074163206566e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.54351409890055e-10).transl(5.381084417632359e-08,-3.922578164422515e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.470771220016064e-09).transl(-3.720666188193183e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6385199909276822e-09).transl(8.16770173304305e-08,-2.317591597496544e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6256803066263745e-09).transl(2.7463481172768354e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0378544652139486e-09).transl(8.003021878495169e-08,-2.5108299105142876e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.93596869525861e-10).transl(3.157552823827561e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.61000843853555e-10).transl(-2.156850680308477e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.542019827289598e-11).transl(-8.352603474347566e-08,-2.0670148274372603e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.797051478174695e-09).transl(2.6743020039432993e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.699318332137472e-10).transl(6.36847356531269e-08,-3.638890785896998e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.5071577331332305e-10).transl(-6.373034235184393e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.210565320193208e-11).transl(-1.6522531687894357e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3398189606480483e-09).transl(-4.956973167472477e-08,-3.979321912503003e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.610659672624531e-09).transl(-4.494247931608853e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.3540227312180394e-10).transl(7.082249757337918e-08,-3.275888563289957e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4502188844552998e-09).transl(2.9286856203436558e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5663298863860907e-09).transl(-1.786848147049943e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.9712027364845706e-11).transl(-8.159439479884145e-08,-2.3278882825962885e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.665523962538968e-10).transl(-5.6315133991368597e-08,-3.8714838374024174e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.775525391066378e-10).transl(3.331112642967809e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.949204965298404e-10).transl(3.7502675659962016e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.939115741059092e-09).transl(-4.9807647673368523e-08,-3.977106360565357e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.066634432722101e-10).transl(7.992536535342394e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.654157214152099e-09).transl(1.183051386277008e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.225778253477099e-10).transl(-1.0312308942802687e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.938732443404629e-09).transl(-4.24812051893744e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.6739758792178805e-09).transl(-3.0004628094917106e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.876501324550686e-09).transl(-2.930440183870191e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.52863085810242e-10).transl(2.138960174240666e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.118117330086113e-09).transl(6.758114070786528e-08,-3.459927448700954e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.012114558962337e-09).transl(-3.186610119904328e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.2729510895305595e-09).transl(-1.4984211738194e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5112543183214826e-09).transl(-2.435622621721609e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1758789271601055e-09).transl(-2.6367681594370228e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6200105595427588e-09).transl(-5.960833077226198e-08,-3.7833649372327206e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8031928560405509e-09).transl(6.331774208210508e-08,-3.6536040181024186e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.486432030213705e-10).transl(-5.984599900696517e-08,-3.7760480364021206e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.54673407288043e-10).transl(8.835010860935096e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.649396010314248e-09).transl(-3.701807571359469e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.916705817690319e-10).transl(7.976599362581365e-08,-2.539681227722975e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6596074351249254e-09).transl(3.505188991563844e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.7097002643125227e-09).transl(8.360509049388768e-08,-2.0553275317778198e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.2083710335216567e-10).transl(-7.40997914701507e-08,-3.0511065940162346e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0298281160449081e-09).transl(-4.5188132192051965e-08,-3.999965043085093e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1781518414195904e-09).transl(4.4120095931857554e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.224511773585653e-10).transl(-6.288659604055918e-08,-3.6704435035490606e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5258399234526553e-10).transl(-2.9041430180517518e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.388120295958857e-09).transl(5.000299390818942e-10,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1425398154490753e-09).transl(-7.593568248149705e-08,-2.9048904520653984e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.534916252783189e-09).transl(-3.6393617514309064e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.290181047683843e-09).transl(-7.810456020930268e-08,-2.7094174576450635e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.938776071150263e-09).transl(6.869987829057903e-08,-3.4002942722462344e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.52132385592988e-10).transl(4.020564459506578e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.400156478199553e-10).transl(-6.333671395912473e-08,-3.652852005255102e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.35947054147669e-09).transl(-5.2815167763963364e-08,-3.939215341127179e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.462726643871442e-10).transl(2.104202447841034e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.11258503251744e-09).transl(-2.1412568301465977e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0043262724308498e-09).transl(-1.6600711309449036e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9021205410853474e-09).transl(5.9533106709635146e-08,-3.7856532909707796e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.0860206440826786e-09).transl(-4.611578670496945e-08,-3.998770201101446e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.629120676727538e-09).transl(-2.820371542733911e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4555422406649576e-09).transl(3.792150362544763e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.124656680658838e-10).transl(-7.192429226486358e-08,-3.205036143289535e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.3110015778689605e-09).transl(8.83472956249132e-08,-1.0740925293157515e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0051101016989222e-09).transl(-5.385073327183734e-08,-3.921868559995707e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0404884377016444e-09).transl(-6.793550555137973e-08,-3.441461171276453e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.111559966819068e-10).transl(-6.672168320659923e-08,-3.5031340929885806e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9223618585732937e-09).transl(-8.819035098539523e-08,-1.1229364741624552e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0238896275345084e-09).transl(3.098649568783401e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.836434576591232e-10).transl(4.274632561358775e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.419527219238591e-09).transl(-4.593243103565604e-08,-3.9991412138490604e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8070168443669694e-09).transl(4.865542186780712e-08,-3.9867810125738185e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.648096773035657e-10).transl(8.220203578156816e-08,-2.2505018962100048e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.756988763967313e-10).transl(-2.600965330074383e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.6643859348209017e-09).transl(-3.5362452114927728e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.184389258874592e-09).transl(-1.9248927995070433e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.826188606735634e-09).transl(-7.938717609735159e-08,2.5801094742584816e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1859253789238598e-09).transl(6.22224766531215e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.243848225130464e-10).transl(-3.1243614945113335e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.0930009657306145e-10).transl(-3.4538514453181764e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.077228773649088e-09).transl(6.75978640505464e-08,3.4590646452579155e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.6229194529590967e-09).transl(-6.627273731564591e-08,3.524834667594042e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.6506739444922366e-10).transl(3.1378225746180043e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.732338518269299e-10).transl(6.187730174984838e-08,3.7080164722098093e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.64118123704187e-09).transl(6.239269842439782e-08,3.6891502360090366e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.5669358958726894e-09).transl(1.057541873874637e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0351646122240015e-09).transl(-1.353179253604736e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.7702979543655797e-10).transl(-2.637760547271147e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.335267553235224e-09).transl(-5.8095353573144925e-08,3.82688265209985e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2251655052274434e-09).transl(8.787789470307761e-08,1.2138660477502497e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1902468924384698e-10).transl(4.110964588236691e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.948276724466166e-10).transl(2.3644305919194005e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.671892429392262e-10).transl(-7.514490877420885e-08,2.9698527710038128e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.223951366291265e-10).transl(-2.4333626789693427e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.875857979877417e-10).transl(6.938007254304675e-08,3.3620829085283574e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.513773999226978e-09).transl(-1.5739752996186616e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5371694434451958e-09).transl(8.697361758850098e-08,1.4421258013562956e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.955909387690238e-11).transl(3.082643682153123e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.64652742594647e-10).transl(8.924226130014564e-08,7.309581200258279e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.8698945753796224e-09).transl(3.261579630418375e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.942909837861026e-10).transl(-7.894961012408383e-08,2.6254954672922206e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.7657068675973003e-09).transl(3.0195099376901526e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.639976451873366e-09).transl(1.8787380111087666e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.012603410346546e-09).transl(3.4617604662927946e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.222728756451469e-09).transl(1.9502448676123558e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9057759069960433e-09).transl(6.076849892410232e-08,3.746384005871733e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.824534991958648e-10).transl(-6.410073621042818e-08,3.6217852510465577e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.9094251960580245e-09).transl(7.600534000351872e-08,2.8990166285265937e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.258300243686701e-09).transl(-6.149212964531798e-08,3.721685172281031e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.3595253848214426e-09).transl(-1.9314045345084678e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.241637312102809e-10).transl(-4.4550712024093284e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.652721244924722e-09).transl(-4.1347690148021424e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.268728012978253e-10).transl(7.414843999858473e-10,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4169756639568672e-09).transl(4.819580048500014e-08,3.9899001966639276e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.692958563309495e-09).transl(2.7736215797417175e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1973682623850652e-09).transl(-3.456264215522674e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.096151382329743e-10).transl(4.836876324115098e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.541826212629123e-10).transl(-6.5139117067608e-08,3.577063794859033e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.1596739514982136e-09).transl(-1.4879239252058414e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4728162589625763e-09).transl(7.645267901931153e-08,2.8606883156979288e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4892667660271343e-10).transl(-4.6484482158983355e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.053682601230369e-09).transl(4.919152463310443e-08,3.982610220433561e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.042626703873259e-09).transl(6.104357525353882e-08,3.737144819530744e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.936732688230482e-09).transl(-6.247544640776059e-08,3.686059180114258e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0166315260244842e-09).transl(-2.6459766534563007e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.822676397473272e-10).transl(8.131518347886172e-08,2.3621834618274744e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.106274812551494e-09).transl(3.080168148541732e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1467353268413493e-09).transl(-6.8341614732217254e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3253653899548306e-09).transl(8.58034735709539e-08,1.686727375969565e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.83468540484295e-09).transl(-3.7385537209031257e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.53884328661663e-10).transl(7.11396880755426e-08,3.255951232459534e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.602004976415902e-10).transl(-4.505699303110604e-08,3.9999967918944225e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.053067574107868e-10).transl(-3.789628688291547e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.3724617130819677e-09).transl(2.9693297536081506e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2892406027358544e-09).transl(-7.987874640301518e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1978191384087548e-09).transl(-7.395310296921449e-08,3.062112984284861e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0581727593132905e-09).transl(-2.396924070478474e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.5674037957321426e-09).transl(-2.3328126925287333e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7432917855536259e-09).transl(2.973474410257923e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.8944188772931912e-09).transl(8.752949954425464e-08,1.3071251456128042e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.456459194623231e-10).transl(-1.0275079545786407e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.523558474881265e-10).transl(6.966708200187498e-08,3.345500833399057e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1201224707262914e-09).transl(5.927177019181293e-08,3.793500953757577e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.38838241079994e-09).transl(7.221200087599852e-08,3.185779524211645e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.7245214428478907e-09).transl(-7.226807354993709e-08,3.1819890229578064e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1972416376562869e-09).transl(-4.9297480178685474e-08,3.981717888811862e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5358855579910821e-09).transl(1.4882260880590305e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0168146384098145e-09).transl(-3.252180756775885e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.748571753675138e-09).transl(-7.104650922342412e-08,3.26184600588627e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.335647152221699e-11).transl(3.4967851512296447e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1957953179809006e-09).transl(8.07318186975681e-08,2.431459869461751e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.6164484405812177e-09).transl(1.821549924930127e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.348476357243695e-11).transl(4.544671006778993e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.8201796679177025e-10).transl(5.405853249355111e-08,3.918117954917658e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7341258275024817e-09).transl(6.365751821540646e-08,3.639994045895851e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.549733640458022e-10).transl(5.2620960683584195e-08,3.942220677198008e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.750930490445523e-10).transl(-1.581978866936276e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4690712225857966e-09).transl(-2.0525178431981288e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.962130843184373e-09).transl(-5.435253604584941e-08,3.91265633062362e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2443038551636189e-09).transl(-2.8377999973735273e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.1915985927347544e-09).transl(4.9478059730650505e-08,3.9801452729104526e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3873426255595905e-09).transl(-4.212134852927889e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.498077702786212e-10).transl(-1.6892761933715253e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5018166682176141e-09).transl(-8.738807793722106e-08,1.3429309351553143e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.395744797810561e-10).transl(8.740568916372021e-08,1.3385306897147303e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4927240259725647e-09).transl(-4.5968738712445826e-08,3.999073023756797e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.98859941972235e-10).transl(5.310432773681521e-08,3.93459602776486e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.822729427013855e-11).transl(-3.7391137527881614e-10,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.6398881165537854e-10).transl(6.732579749595747e-08,3.472995665587723e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.914677559939419e-10).transl(-6.2761095683369866e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7309712012688901e-09).transl(-1.2364134510938956e-10,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.367306956408853e-10).transl(3.379224826462907e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.5622540727448194e-09).transl(7.957671433054126e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.1950476276898816e-09).transl(8.758328396352353e-08,1.2932155024809872e-08,0))


    vIsland := hIsland.rotz(pi / 2)
    vIslands := Universe().Inverse()

    hIslands := Universe().Inverse()
    hIslands = hIslands.add(hIsland.transl(-a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, 0, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, 0, 0))

    vIslands = vIslands.add(vIsland.transl(-a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(-a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, -a/2, 0))

    DefRegion(1, hIslands)
    DefRegion(2, vIslands)
    TableAdd(m_full.Region(1))
    TableAdd(m_full.Region(2))
    setgeom(hIslands.add(vIslands))
    save(m)


    r2o2 := sqrt(2) / 2
    m = RandomMagSeed(4)
    B_ext = vector(Bmax*r2o2, Bmax*r2o2, 0)
    relax()
    minimize()

    for B := Bmax; B >= -Bmax; B -= Bstep {
        B_ext = vector(B*r2o2, B*r2o2, 0)
        minimize()
        tablesave()
    }

    