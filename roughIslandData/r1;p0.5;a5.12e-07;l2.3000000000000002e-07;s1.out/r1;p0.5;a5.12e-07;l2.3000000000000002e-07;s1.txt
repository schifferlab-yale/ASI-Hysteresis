
    randSeed(1)
    ThermSeed(1)


    resolution := 2e-09
    zResolution := 5e-09
    a := 5.12e-07

    gridSize := 512 //2*a/resolution
    gridDepth := 5 //25/zResolution

    SetCellsize(resolution,resolution,zResolution)
    SetGridsize(gridSize,gridSize,gridDepth)

    SetPBC(16, 16, 0)


    Msat = 700e3
    Aex = 13e-12
    alpha = 0.2
    Bmax := 0.1
    Bstep := Bmax / 500.0


    TableAdd(B_ext)
    TableAdd(m_full)


    islandWidth := 8e-08
    islandLength := 2.3000000000000002e-07
    ellipseConstant:=5.7500000000000005e-08


    hIsland := rect(islandLength-2*ellipseConstant, islandWidth)
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(islandLength/2-ellipseConstant, 0, 0))
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(-islandLength/2+ellipseConstant, 0, 0))
    
    hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.2304317325380145e-09).transl(-2.5448162327188548e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.889757420334517e-09).transl(1.0532322199584931e-07,-2.2208519291779722e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.3447145549037612e-09).transl(-8.551273929245213e-08,-3.493210611638553e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.6709518904692914e-09).transl(-9.550126814711993e-08,-3.001925426602018e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.956350194710408e-10).transl(-1.0546391722359723e-07,-2.2061198477839153e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7988847944932769e-09).transl(-3.392903890375933e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.592532808150701e-10).transl(-7.798042993278707e-08,-3.737667330988556e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.227845788468008e-10).transl(-6.606061326537235e-08,-3.955420942263579e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.32676257446281e-10).transl(-3.437855972598713e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.982034353831177e-11).transl(-4.82029413774878e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.675006439515751e-10).transl(2.220775924428738e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.1351526249646915e-09).transl(7.530111945661868e-08,-3.803487498744634e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.761060310606088e-09).transl(3.204414819875157e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.865881902120875e-10).transl(-5.971831675042352e-08,-3.997022147985084e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.8291615922385193e-10).transl(2.7844465094463087e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7483871125103673e-10).transl(-3.753803994710629e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.96183702078755e-10).transl(8.613708712305369e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.985384672983135e-09).transl(-1.0077574484140625e-07,-2.6338129100775545e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.668940034503335e-10).transl(-7.935380352258739e-08,-3.6998372352913926e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.251095164176446e-09).transl(-3.5690965152486806e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.899622246453157e-10).transl(-4.82807892156454e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.8434226193299234e-09).transl(-8.558428411981618e-08,-3.490429486689904e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.390897057186157e-10).transl(3.1714697140606466e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.701344411805061e-09).transl(3.4948497883664005e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.346350165281232e-10).transl(-3.2301980478848054e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.8149382195810497e-09).transl(1.7432426933508318e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.511139228719246e-09).transl(-8.799812521620152e-08,-3.390984588392381e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.2955524371801633e-09).transl(-3.258027994092841e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9890978701916022e-09).transl(-6.255562130083333e-08,-3.984508796482689e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6361437356146207e-09).transl(1.1257162951149743e-07,-1.1501754569429443e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.208203978950801e-10).transl(-3.226515031852983e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.4481332696366e-10).transl(4.381912319528826e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.5675642575768964e-09).transl(1.2898593914204825e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.155055760758831e-09).transl(1.3710292767554928e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.01533269508613e-09).transl(-1.0410344546519915e-07,-2.3429838589463824e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0463673266193057e-09).transl(-5.194235870414338e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.423259722255273e-09).transl(-2.545752378029827e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.391506686248588e-09).transl(-1.0261656413440828e-07,-2.4798274378218594e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.507462104721714e-09).transl(-1.599142377964609e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.226945268712169e-10).transl(-5.3515984214068e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.963106820516796e-09).transl(8.618515739731866e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.32377900537556e-10).transl(-6.625176483089643e-08,-3.953396024659407e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.829158652156093e-09).transl(-9.941193281927934e-08,-2.7384671769871655e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5379115392435108e-09).transl(8.496661991224627e-08,-3.5141348562826085e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.64319699131108e-09).transl(-2.901789446230279e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1996105490689461e-09).transl(-1.105676043973896e-07,-1.5400164304580506e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.8971857131208146e-09).transl(6.783450359204881e-08,-3.934863552108878e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9823120744495086e-09).transl(-9.565920930714352e-08,-2.992214013395561e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3333561178417627e-09).transl(6.855083967493622e-08,-3.925432102145638e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.6686303693034484e-10).transl(-2.8951083079483668e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5179102158431607e-09).transl(-6.426926809470503e-08,-3.9721842743865525e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.2715917628635804e-09).transl(-9.865088571681699e-08,-2.793764251334718e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.73390621093837e-09).transl(3.620386900547993e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.435924007949257e-09).transl(-3.460700735546361e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4794049659436044e-09).transl(1.0569217118715283e-07,-2.1819146085211583e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.828026699880863e-10).transl(-1.1939130133927616e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4474393180567892e-09).transl(-6.12384599127356e-08,-3.991536705548512e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.800439928825696e-10).transl(-9.699416298655111e-08,-2.9071778682454174e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.3050168041674704e-09).transl(-2.1065945128863143e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6228876836299419e-09).transl(8.568043437434891e-10,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.729545731451776e-10).transl(3.4694773300841014e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4896156187837688e-09).transl(1.6951457872905536e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6351906342412037e-09).transl(6.93863173438824e-08,-3.913601790508547e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.751140363986102e-10).transl(-7.622316169141897e-08,-3.782002608532076e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4883884149958613e-09).transl(-4.8055715543727246e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.154620918589784e-10).transl(1.0923291420845263e-07,-1.7460115521579217e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.130529229263002e-10).transl(8.404944820324418e-08,-3.548083059817719e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.794973478865233e-10).transl(-4.96734222157751e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.965591682255076e-09).transl(-1.0819719784336643e-07,-1.8873136182474773e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.154519704745373e-11).transl(-5.176078734629235e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.913426762357863e-09).transl(4.674480721447523e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.9953021520896808e-09).transl(4.553320432242951e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.544741454009922e-10).transl(-7.378265777347438e-08,-3.836271066481002e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.962671505276485e-10).transl(-1.0859412076406313e-07,-1.8347828702705225e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.52945107804179e-10).transl(9.695465053671169e-08,-2.9097730540605663e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.468960906119841e-09).transl(8.03529111764206e-08,-3.670509304155865e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3625640169768504e-09).transl(-8.294337266653632e-08,-3.587086968806006e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.7107702694694632e-09).transl(1.0235535806627842e-07,-2.5026533907804636e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9615154803381533e-09).transl(-1.012481728604257e-07,-2.5957684304014652e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.62371924922058e-11).transl(-8.989990881641092e-10,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.219729305295513e-09).transl(-1.00093555654944e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.5893405539052534e-09).transl(-5.413433215923384e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.487500898845578e-10).transl(-9.621067487879534e-08,-2.9577357306486612e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.65113614629783e-10).transl(1.1323170334631114e-07,-9.843594827855455e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.392744645812325e-11).transl(-1.5862604326746964e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.7778972029739025e-09).transl(3.1980291551654846e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.2952221674175324e-11).transl(1.3897542366389358e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0229359651012768e-09).transl(2.0894503346061875e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.419523662382587e-10).transl(-9.824485667495328e-08,-2.8224166921543152e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.8528152876171095e-10).transl(-4.263901532926384e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5942827702295324e-09).transl(2.3157341510823038e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.297160792086765e-09).transl(-7.58244907805945e-08,-3.791440308775159e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.397740423028186e-10).transl(2.302777385840673e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4305274944106701e-10).transl(-8.595086350001091e-08,-3.476032932452798e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.860558197205202e-11).transl(-8.29060731522962e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.118993160855321e-09).transl(5.3816012818038454e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.915657812773903e-10).transl(-5.0896714440321836e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.89249033574596e-10).transl(1.728975188391913e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.326944193989093e-11).transl(1.9036613708232212e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.899375494684747e-10).transl(1.0585630590820054e-07,-2.164269592632953e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3914074346548005e-09).transl(7.36776020985627e-08,3.838421345533183e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.0013755100267517e-09).transl(9.029060586280181e-08,3.285825371247048e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.46451778095023e-10).transl(1.3896481628371397e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.725506314192269e-10).transl(6.59823044662914e-08,3.9562372826576704e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.575341724204717e-10).transl(3.681401966057068e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.853459146231064e-09).transl(-1.622326755369333e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.817875689237923e-10).transl(-6.119806562348035e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3456908496302984e-11).transl(-1.0277842683154046e-07,2.465509530643368e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4985380495905386e-09).transl(-1.1417221849442509e-07,6.7628573389275125e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1624004208994318e-09).transl(2.691456648969639e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.148972416458604e-11).transl(-4.940301363530572e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1093072625004076e-10).transl(2.0961663479074868e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2888638109076672e-09).transl(-4.928422924503668e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0823210046409551e-10).transl(-1.62734903844989e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.7045671364452562e-09).transl(6.953584705921578e-08,3.9113895700528526e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.620771421004819e-10).transl(-2.8550319635901177e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.668544051428004e-09).transl(2.0286909980934155e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.241377975081076e-10).transl(-2.543451833283588e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.258428946956956e-10).transl(-4.436861919076344e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2601731793296347e-09).transl(-6.215321926287007e-08,3.9868805950900923e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.3290367480483134e-09).transl(1.707333586517468e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8904434707402095e-09).transl(1.0945162723593414e-07,1.714297033341372e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5195961184784483e-09).transl(2.868939872970471e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0198751707906296e-09).transl(6.330203928740098e-08,3.979584249042481e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.544987097252267e-09).transl(-2.1968827349613217e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.7976918564766785e-09).transl(-4.550819745112848e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0884455425297316e-09).transl(-1.0719738896233813e-07,2.0118899867488373e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6281965823740203e-10).transl(8.303833807329444e-08,3.5838196609058296e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3297348975475694e-09).transl(-7.019407377938539e-08,3.9013067600528e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.792184701571323e-09).transl(-8.685299519581168e-08,3.439542184709261e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.741432751088609e-10).transl(8.059618589126736e-08,3.663133004976562e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4234120308400882e-09).transl(-2.1232878685697983e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.7137593256509375e-09).transl(3.8434768604705416e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.684648811905821e-09).transl(-3.792043833181093e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.076312833582766e-09).transl(-7.805688821188729e-08,3.735635557922059e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.43095629803552e-10).transl(1.5781994821996883e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0447182355223027e-09).transl(1.1351447079046547e-07,9.033548048095745e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9191223726641447e-09).transl(4.9402475605674466e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1508949401912973e-09).transl(-6.476697090948216e-08,3.967926539841225e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.743008988300382e-10).transl(-8.331764765093813e-08,3.574121864897008e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.584838114101088e-09).transl(-6.791546791007682e-08,3.9338303320957955e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8170965549788214e-09).transl(1.5300155569625095e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.926377698267753e-10).transl(5.3947091017784846e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.7441247307854076e-09).transl(-6.400970138412079e-08,3.974283328052938e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.339570117504711e-10).transl(-5.706117311199048e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0402262390799457e-09).transl(7.302536954523375e-08,3.8514340798137725e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2979116173075444e-09).transl(-1.0263689541426612e-07,2.4780363442326294e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2278913341538815e-09).transl(-5.482637178722027e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.5045069886607943e-09).transl(-7.642982854578244e-08,3.77702077851403e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.47873032830442e-09).transl(-3.132313805051287e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.546598462088641e-10).transl(1.1048755527597387e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.440886766125211e-10).transl(-6.25051808022261e-08,3.9848169553658134e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.8449596016718289e-09).transl(-4.40925613791857e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1599601368203265e-10).transl(-7.18076263480693e-08,3.8741904649621496e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3484835683911656e-09).transl(-5.795590504901278e-08,3.99987426680955e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.035622776456241e-09).transl(-7.888848982488157e-08,3.7129730182979646e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.4086906773539832e-09).transl(9.976561064173798e-08,2.712033842978029e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7424349819608565e-09).transl(-5.049727291883634e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1393703862999654e-10).transl(1.0207594114405086e-07,2.5266978255894765e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4996122232400298e-09).transl(-4.677067126295888e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0812959590338098e-09).transl(1.04448854046197e-07,2.3093714992083233e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.348778158641131e-10).transl(-8.846064954811498e-08,3.370639867809946e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.91444213567027e-09).transl(-8.116876940660099e-08,3.645402819563288e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.014474684693194e-10).transl(7.357054004068174e-08,3.840597145000936e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.501526087283178e-10).transl(-9.024697006824152e-08,3.287930622700014e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4626208810790462e-09).transl(-6.38001500395082e-08,3.975917285529991e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.8582076968395155e-09).transl(-6.052440048311348e-08,3.994463011859569e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.164826696492197e-10).transl(3.939026525168159e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.8856057913267474e-10).transl(-1.4836092478599798e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4634885864668246e-09).transl(2.128197982650907e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.262635963522856e-09).transl(-5.171851285558743e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.430600476083114e-11).transl(9.135904983469973e-08,3.2329604923587764e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.442120182648576e-09).transl(9.390975363757904e-08,3.095909976603423e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.711732381676723e-10).transl(7.186383677268948e-08,3.873183773280671e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.261273180861596e-10).transl(-1.0362852242560824e-07,2.388032588764314e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.712143949044644e-09).transl(1.1479114792927126e-07,3.4061654457739684e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1734119125606123e-09).transl(-7.857784478764102e-08,3.7215599853564605e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.2107737380370077e-09).transl(-8.504246703809801e-08,3.511260854276985e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6965247269610917e-09).transl(5.4203654715380114e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.299364257740973e-09).transl(3.6533782643379973e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0332805681717458e-10).transl(8.025123751438371e-08,3.673564647850356e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.719778478812784e-09).transl(-2.5966332571935396e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.483639352000185e-09).transl(-6.873620374357077e-08,3.9228847688235334e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.275870176378746e-11).transl(-6.4717285674268016e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.343158158597078e-10).transl(2.990614423869015e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.2950392410254084e-10).transl(9.248300723307572e-08,3.1745217893358936e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.642453573776814e-10).transl(-8.948774324067281e-08,3.323903165698664e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.322406697431825e-10).transl(8.855516279325995e-08,3.36642961301754e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.738783780933968e-09).transl(-3.71112257686925e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.140891256077601e-09).transl(1.685785337493175e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.351416883852448e-09).transl(-1.7356976519709314e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.771606710540674e-09).transl(-6.997431692865203e-08,3.904735631931002e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.192859449085202e-09).transl(1.0371442633934991e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.6968902350528e-09).transl(-5.233735624661014e-10,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.817603262888178e-10).transl(-3.959095748507589e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9243404150398423e-09).transl(-1.9292062354638228e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.6156099540362296e-10).transl(-6.156900355691421e-08,3.989971980357904e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.895222316316397e-10).transl(-1.0056721873847132e-07,2.6503021033846956e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.45854149059971e-10).transl(7.386231810406953e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.258685522888902e-09).transl(-1.5195792952339934e-09,4e-08,0))


    vIsland := hIsland.rotz(pi / 2)
    vIslands := Universe().Inverse()

    hIslands := Universe().Inverse()
    hIslands = hIslands.add(hIsland.transl(-a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, 0, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, 0, 0))

    vIslands = vIslands.add(vIsland.transl(-a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(-a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, -a/2, 0))

    DefRegion(1, hIslands)
    DefRegion(2, vIslands)
    TableAdd(m_full.Region(1))
    TableAdd(m_full.Region(2))
    setgeom(hIslands.add(vIslands))
    save(m)


    r2o2 := sqrt(2) / 2
    m = RandomMagSeed(4)
    B_ext = vector(Bmax*r2o2, Bmax*r2o2, 0)
    relax()
    minimize()

    for B := Bmax; B >= -Bmax; B -= Bstep {
        B_ext = vector(B*r2o2, B*r2o2, 0)
        minimize()
        tablesave()
    }

    