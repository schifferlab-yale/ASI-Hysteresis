
    randSeed(0)
    ThermSeed(0)


    resolution := 2e-09
    zResolution := 5e-09
    a := 3.2e-07

    gridSize := 320 //2*a/resolution
    gridDepth := 5 //25/zResolution

    SetCellsize(resolution,resolution,zResolution)
    SetGridsize(gridSize,gridSize,gridDepth)

    SetPBC(16, 16, 0)


    Msat = 700e3
    Aex = 13e-12
    alpha = 0.2
    Bmax := 0.1
    Bstep := Bmax / 500.0


    TableAdd(B_ext)
    TableAdd(m_full)


    islandWidth := 8e-08
    islandLength := 1.8000000000000002e-07
    ellipseConstant:=7.200000000000001e-08


    hIsland := rect(islandLength-2*ellipseConstant, islandWidth)
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(islandLength/2-ellipseConstant, 0, 0))
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(-islandLength/2+ellipseConstant, 0, 0))
    
    hIsland = hIsland.add(rect(6.000000000000001e-09,2.120554840757073e-09).transl(7.904357535144622e-08,-2.121088926832587e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5594700914061715e-09).transl(4.58060548424885e-08,-3.689668305417387e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1968309404982698e-09).transl(2.6117246638961395e-08,-3.974498301673685e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.888127028683903e-09).transl(-5.856364199556474e-08,-3.3047809307383414e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1754469230717623e-09).transl(6.664735145723524e-08,-2.948862092838688e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0240071352963388e-09).transl(-1.4017881189310585e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.7125147459169546e-09).transl(8.85831179984828e-08,-7.896386374890743e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7778558622157324e-09).transl(3.340088476537982e-08,-3.907421218862348e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.857593111926083e-10).transl(2.4060040972958018e-08,-3.98580657117957e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.3213685204236954e-09).transl(-8.143155840635843e-08,-1.892510741803542e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6803289162987093e-10).transl(2.436757178335787e-08,-3.984326557399548e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.5804992043745036e-10).transl(5.914384490329164e-08,-3.2825690154629523e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.400452595490423e-10).transl(1.4249357159021921e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.7334628278338665e-09).transl(5.638178011598428e-08,-3.384258656135839e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.4388264716729165e-09).transl(-8.962312881093824e-08,-4.087296615234944e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.41728667757937e-09).transl(5.185887641440464e-08,-3.53010705602801e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.557898668222196e-10).transl(7.945215686357386e-08,-2.0843570942479386e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.352448158880738e-10).transl(-3.405541876314371e-08,-3.899281165290334e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1323386787200817e-09).transl(-5.452571997411988e-08,-3.447074166563679e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.4867998353213743e-09).transl(-8.775797221161228e-08,-9.904253247162515e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.215732772531495e-10).transl(5.2669955605068116e-08,-3.50572467383161e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.8331969295047376e-09).transl(-2.9896248732626475e-08,-3.9450231445954115e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.227446920083773e-09).transl(-4.3158996059293135e-08,-3.7478491433764554e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.953963607233692e-09).transl(3.353853324939979e-08,-3.9057388863472416e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.348497405344224e-10).transl(-4.597921190397815e-08,-3.685625941960235e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4800938299450958e-09).transl(2.190389467924854e-08,-3.9941158906499435e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.4896545867726184e-09).transl(1.2546907404258233e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.5203132291312435e-10).transl(-3.7204570779588845e-08,-3.855085010180102e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.38628911094275e-10).transl(-2.964301678564957e-08,-3.947354231950455e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.7730489229933936e-09).transl(3.631952171709175e-08,-3.868356560822363e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.142061335768056e-09).transl(5.69678659829357e-08,-3.363523202774856e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.9048547328864643e-09).transl(5.7459513750629765e-08,-3.345785433707156e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.243407478704397e-09).transl(2.8220714208781677e-10,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0337104923264672e-09).transl(1.4815928536312697e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9022234615868105e-09).transl(4.640837116930129e-08,-3.6754794965205896e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.60793558492804e-10).transl(1.5905077965807994e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3899109754935145e-09).transl(6.443324167726841e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.2503411552314877e-10).transl(-8.638022815130865e-08,-1.2523365790913308e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7746341886420206e-09).transl(4.439198317685837e-08,-3.7215850300347956e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.27597024850246e-09).transl(-3.7374299580266856e-10,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.912674659828114e-09).transl(-1.9740624438937467e-08,-3.9988309350878227e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.027758283165216e-09).transl(6.0242633565830196e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.8211195777561886e-09).transl(3.354699237041799e-08,-3.9056349874308174e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.750394288663385e-11).transl(7.36449372295709e-08,-2.5383727658698235e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.446258866041888e-10).transl(-7.285152056512216e-08,-2.59112367283856e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.67926774672253e-10).transl(-7.170727519488668e-08,-2.6640777891202197e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.019997500564559e-09).transl(7.067531816381803e-08,-2.7269295220696505e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5679414226515541e-09).transl(4.154855315743512e-08,-3.780009816186652e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.03104462176536e-09).transl(2.740185788462642e-08,-3.9657503876040604e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.8526740128969607e-09).transl(-2.3399838668828735e-08,-3.988734809137526e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.996869727609945e-09).transl(-6.571208559872671e-08,-2.995653686891966e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.586380735668214e-10).transl(-3.587594925035116e-08,-3.874756240201978e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.668176684922271e-09).transl(-3.627542557731205e-08,-3.869000261642921e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.789262879738241e-09).transl(3.038650428061354e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.1800032605893553e-09).transl(-2.316999514549679e-08,-3.9896746170566636e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.913963725279007e-09).transl(2.4429018462209692e-08,-3.9840219928540756e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.730523515365279e-10).transl(1.6764276901090695e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.247639672121267e-09).transl(-2.452562818301725e-08,-3.983537177806438e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.211689593463524e-10).transl(7.589164374422756e-08,-2.3782434542643773e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.9977310925699747e-09).transl(7.331479117869042e-08,-2.5605469834587317e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0470167408696313e-09).transl(-5.430693562983169e-08,-3.454200531563993e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.8769658665774708e-10).transl(3.319046099316013e-08,-3.909962700248062e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.308621228601932e-10).transl(-4.245909619158732e-08,-3.762121402752084e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.0250941252195597e-10).transl(-7.958332446693585e-08,-2.072374247923648e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2979946072640545e-09).transl(8.31007532642264e-08,-1.7086308904636657e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.903006513416304e-09).transl(-5.970923378128741e-08,-3.260472120521393e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1579236213348016e-10).transl(5.5140755459542785e-08,-3.4267305639193316e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3145987407465768e-09).transl(-1.0215103345025615e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1384012554507208e-09).transl(-7.339204613972421e-08,-2.5553872072899375e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.511469645395057e-10).transl(8.471070925147953e-08,-1.5048084156436216e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1036507070086373e-09).transl(4.896578575307222e-08,-3.6111624409577645e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.988268238565803e-09).transl(-4.8801602735300535e-08,-3.615493609443691e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.6474891187290148e-09).transl(2.4126341288291786e-08,-3.98549373555011e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.5136053562434133e-09).transl(5.39933109881622e-08,-3.464316138717678e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7543381557435592e-09).transl(9.582415430223581e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9269003768591523e-09).transl(-4.493928794877791e-08,-3.709461861079722e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.869046790157068e-10).transl(9.570819946972226e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.426788208933139e-10).transl(-8.560904362419963e-08,-1.3755102534959342e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.123550111525259e-09).transl(-1.4146799970299587e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.441620001129155e-09).transl(4.266341480389055e-08,-3.758002149410367e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5201311269425286e-09).transl(8.037640792422991e-08,-1.997825773794723e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0267082818282813e-10).transl(-1.747282571994578e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.861783196353298e-10).transl(6.1469653702318684e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1181167491914052e-09).transl(-2.2486289099619065e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.776930144515867e-10).transl(5.87267253919578e-08,-3.2985845443833375e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.204304075405807e-09).transl(6.443170352068236e-08,-3.05711925047551e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.3810747299345503e-09).transl(1.6860470063646073e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.297282441804086e-10).transl(8.936621454049759e-08,-5.295683723435928e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.469592671185187e-09).transl(-4.1568814811127095e-08,-3.77962004442817e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.132264734330658e-09).transl(-2.179013596656535e-08,-3.994454052435883e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.7269025430779055e-09).transl(-1.9453616668715194e-08,-3.999184715748993e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.326253094183838e-09).transl(2.4664191880473642e-08,-3.982829096622393e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.172557904510369e-09).transl(2.3373141352818037e-08,-3.9888460814797726e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.999327087851934e-10).transl(8.72442931567801e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7474067257497183e-09).transl(-3.151375079393508e-08,-3.928912510722501e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.728840376796687e-10).transl(7.448784445322815e-08,-2.4802450527500416e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.210694845633212e-09).transl(-7.93586699907259e-08,-2.092840246958099e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.8091849343143357e-09).transl(8.778992332802212e-08,-9.834535423523674e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.402089508669136e-09).transl(7.556578378057179e-08,-2.4025324458751644e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3639550801018447e-09).transl(-7.143241453851047e-08,-2.6810820303856275e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.417205793222017e-09).transl(2.3370835805448144e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.9164015435017324e-09).transl(-8.272867786444518e-08,1.751717201513077e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.8602032372810665e-09).transl(-5.4186153114547315e-08,3.458110132364698e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.3350473786678986e-09).transl(2.081101009374423e-08,3.996950312060028e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9647116495377752e-09).transl(-1.1048667543054188e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.936623644221628e-10).transl(-3.701727609857952e-08,3.8579496288649555e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.35872243686415e-09).transl(8.758841266115786e-08,1.0265801179554868e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.545937832802201e-10).transl(-7.78758882771185e-08,2.2214429210121277e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8568035259835303e-09).transl(2.0998041626612995e-08,3.996530805155759e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.549005667203295e-09).transl(5.722827292459461e-08,3.3541675768821024e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1828547950541978e-09).transl(-6.258987640331854e-08,3.140605687011082e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.2992314672419976e-09).transl(-1.9752073244536722e-08,3.9988155033809155e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.11471461029075e-09).transl(2.0917741521998747e-08,3.996714230870557e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5761266457659416e-09).transl(7.871428183188552e-08,2.1500617143298674e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2187775693565088e-09).transl(4.869297633445116e-08,3.618343698798134e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.907190207189058e-10).transl(-6.186836736257884e-08,3.171811777757968e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.5915245604630295e-09).transl(6.261047794889203e-08,3.1397025775096e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.9107874285673626e-09).transl(8.757086928244114e-08,1.0302435096387404e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1587604148674506e-09).transl(-5.1664326642457944e-08,3.535845155273005e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4075775756410386e-09).transl(-3.1899395428538165e-08,3.9247579176431077e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3313844077223038e-09).transl(-2.2042247917912336e-08,3.993691101797244e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.032717072229693e-11).transl(-6.956067158854826e-08,2.7919069246187584e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6308802607975154e-09).transl(5.446840957419933e-08,3.448946476792465e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.542286389217075e-09).transl(2.787930904328237e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.115545762521442e-10).transl(-1.7536988782333053e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.7819224405645524e-09).transl(5.387305388855347e-08,3.468163852582649e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.631775960762614e-10).transl(-7.713334545892229e-08,2.2820065453345797e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.142509385297938e-10).transl(7.709634915983584e-08,2.2849625952437104e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.144395254019886e-10).transl(5.726884293679109e-08,3.352702049409723e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.025702016108084e-10).transl(4.082256114533729e-10,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3062857242498619e-09).transl(2.2904296286560318e-08,3.990709843542965e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.8416012205305305e-09).transl(-8.135685058516192e-08,1.900218866479084e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0620075147458252e-10).transl(3.180078120486906e-08,3.925831844750511e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0249374639189233e-09).transl(-4.479170556120945e-08,3.712759328400076e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3543689481635086e-09).transl(8.939460528690847e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.3270699898021466e-09).transl(5.3987240617777276e-08,3.4645107758234666e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.408735952421547e-10).transl(-2.317968740552208e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.906971986873854e-09).transl(8.561102397011985e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3914686696019872e-09).transl(5.694618473464898e-08,3.364298165126303e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.775010888846e-10).transl(-2.0907023772541648e-08,3.996738335619834e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.916782354976061e-11).transl(3.029650642720602e-08,3.941233407276816e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2877865433090906e-09).transl(-4.987145631790658e-08,3.586759891470438e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.035101539442232e-09).transl(-2.6943650106391448e-08,3.969020124577834e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.1075943654605387e-10).transl(-8.112334162257673e-08,1.9240547963240634e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.662599517946886e-10).transl(6.369489053871366e-08,3.091194672294441e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.6947085538272623e-10).transl(4.457296258904236e-08,3.717608109979708e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.204593667758918e-10).transl(-6.485310044217575e-08,3.037211084138771e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.147193724416515e-09).transl(2.009460479916889e-08,3.9983069838166935e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.7063877057273348e-09).transl(-2.982984411477122e-08,3.9456394074995e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.2152333097052697e-09).transl(-7.73528488407682e-08,2.2643502150856443e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.456433226520972e-09).transl(-5.7575502779261436e-08,3.341554482170044e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.665145463717015e-10).transl(-3.4928089790850905e-08,3.887872794253825e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.64084233291825e-10).transl(5.087888724865883e-08,3.558583247919947e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.218691111319847e-10).transl(-3.021804023256998e-08,3.9419865162199085e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.899369958627171e-09).transl(3.841115894908523e-08,3.83590275818249e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.065024199255847e-10).transl(-1.4103492721895703e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3932949781062936e-09).transl(7.353941392940624e-08,2.5454955982427234e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0186780535055652e-09).transl(7.198108940716704e-08,2.6469420898856377e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.413708472225937e-10).transl(5.261775073192106e-08,3.5073165739911684e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.098393013045177e-09).transl(6.24234006470523e-08,3.147878707127786e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2639927434755851e-09).transl(4.51706563500618e-08,3.7042499088704604e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.590835400413872e-10).transl(4.2106645184147455e-08,3.769136218449424e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.267454808333226e-10).transl(-5.324441473023667e-08,3.488000254100061e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.829245540600921e-09).transl(6.821237451729356e-08,2.866751422807688e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.186890523085716e-09).transl(3.963410294965649e-08,3.815160461960301e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.730037414254021e-10).transl(-8.510881147392355e-08,1.4491455789974108e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.939379252076191e-10).transl(7.880813560920323e-08,2.1418598729199212e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.0799041237630897e-09).transl(-5.3620770360113226e-08,3.476180285813975e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.9291311614983587e-09).transl(-6.505582190056822e-08,3.0275227340401e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4738770674121153e-09).transl(-6.739316321724446e-08,2.9103452275994073e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.030357612000214e-09).transl(-1.3980078083233602e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4955918754060995e-09).transl(-7.34046679112939e-08,2.5545425369252755e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3029334458026798e-09).transl(-6.856854273790533e-08,2.8473631322121523e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.865019115596206e-13).transl(-8.927357977883258e-08,5.667669451315862e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.270531643118071e-11).transl(5.233325759548603e-08,3.515937006487236e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.96139772238588e-10).transl(-6.68341231241678e-08,2.9393186089392986e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.671098721900542e-09).transl(-4.152201804216462e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.382549771608061e-10).transl(-2.9695899399842943e-08,3.9468716855958064e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.754125381304144e-09).transl(1.0864518650019804e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.050041833603732e-11).transl(-4.9426298973393585e-08,3.598862874607911e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.917823472015448e-09).transl(3.384198458477777e-08,3.9019746205677096e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.672146126596229e-10).transl(-2.1607026221825943e-08,3.9949773102443865e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.104564799427075e-10).transl(4.7984448731403e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.4612765257037257e-09).transl(8.265043900192652e-08,1.760612211894883e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.04733707840055e-09).transl(6.682500092421082e-08,2.9397862969020603e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1121074663967143e-09).transl(-7.307704228640018e-08,2.5763162840815427e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.790564083223248e-09).transl(7.661238290202773e-08,2.3231182286217363e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.3447030143613495e-10).transl(8.85241928973104e-08,8.057245343515568e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.420712818326296e-09).transl(-5.7652455473036324e-08,3.338737644457114e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.026674196693303e-09).transl(-1.3343102205397776e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.6422006463504e-10).transl(8.780153925875128e-08,9.809058504125002e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1758058060281587e-09).transl(-7.964327313353212e-08,2.066865938260894e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.505244506803386e-09).transl(6.4320548400499795e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.116820550275268e-09).transl(-7.41014158060956e-08,2.5071694386887705e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.172014028247206e-09).transl(-1.3565844027427635e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.812964713604119e-09).transl(-5.9029083510698725e-08,3.286999413266628e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8582658519433407e-09).transl(-1.2284445746079013e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.289680645876155e-10).transl(1.531603663779703e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.041588171362195e-10).transl(-5.464728798998112e-08,3.4430894660063704e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.069893236983411e-09).transl(1.8900030357524276e-08,3.999687466708398e-08,0))


    vIsland := hIsland.rotz(pi / 2)
    vIslands := Universe().Inverse()

    hIslands := Universe().Inverse()
    hIslands = hIslands.add(hIsland.transl(-a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, 0, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, 0, 0))

    vIslands = vIslands.add(vIsland.transl(-a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(-a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, -a/2, 0))

    DefRegion(1, hIslands)
    DefRegion(2, vIslands)
    TableAdd(m_full.Region(1))
    TableAdd(m_full.Region(2))
    setgeom(hIslands.add(vIslands))
    save(m)


    r2o2 := sqrt(2) / 2
    m = RandomMagSeed(4)
    B_ext = vector(Bmax*r2o2, Bmax*r2o2, 0)
    relax()
    minimize()

    for B := Bmax; B >= -Bmax; B -= Bstep {
        B_ext = vector(B*r2o2, B*r2o2, 0)
        minimize()
        tablesave()
    }

    