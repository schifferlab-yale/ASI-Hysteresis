
    randSeed(1)
    ThermSeed(1)


    resolution := 2e-09
    zResolution := 5e-09
    a := 5.12e-07

    gridSize := 512 //2*a/resolution
    gridDepth := 5 //25/zResolution

    SetCellsize(resolution,resolution,zResolution)
    SetGridsize(gridSize,gridSize,gridDepth)

    SetPBC(16, 16, 0)


    Msat = 700e3
    Aex = 13e-12
    alpha = 0.2
    Bmax := 0.1
    Bstep := Bmax / 500.0


    TableAdd(B_ext)
    TableAdd(m_full)


    islandWidth := 8e-08
    islandLength := 2.3000000000000002e-07
    ellipseConstant:=9.200000000000002e-08


    hIsland := rect(islandLength-2*ellipseConstant, islandWidth)
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(islandLength/2-ellipseConstant, 0, 0))
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(-islandLength/2+ellipseConstant, 0, 0))
    
    hIsland = hIsland.add(rect(6.000000000000001e-09,1.3417398939489405e-09).transl(-8.39660911873929e-08,-2.995628738890632e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.507103772498213e-10).transl(-1.1333353003462441e-07,-7.578865144453333e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.7070853412102193e-09).transl(1.774705176378571e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.252140709578893e-10).transl(1.7930156211607557e-10,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.4308785742862e-10).transl(3.5219753978694476e-08,-3.964558872831126e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.827134961977511e-10).transl(-6.373745738302954e-08,-3.586484703083968e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1013187713114043e-09).transl(1.0897252005820454e-07,-1.424021432875399e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.055095496613253e-10).transl(-5.0450905603282785e-08,-3.8177893675689116e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7697393144866446e-10).transl(-2.872325617450263e-08,-3.992252501466442e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.196600875683689e-11).transl(-5.592270810560729e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8554777688431034e-09).transl(-1.082691005695831e-07,-1.5018454231248023e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.228973507401159e-09).transl(-9.697606691335402e-08,-2.3780428816841145e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.441860945229996e-10).transl(1.2432427183309235e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.994016956677751e-10).transl(-9.766499917202029e-08,-2.3369870164409626e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.580220642297449e-11).transl(1.026422383097395e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.6707867022365565e-09).transl(-6.473135016390776e-08,-3.564818220892904e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.928611725746768e-11).transl(1.0285211711211847e-07,-1.9865518533371332e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.8333512037141223e-10).transl(-3.4914729031777435e-08,-3.9663135479773e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.9873234346517785e-09).transl(4.1308913364195836e-08,-3.91998989510637e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.999373339090921e-10).transl(6.918385841148549e-08,-3.459474052879707e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2945739754153704e-09).transl(3.5816086172134885e-08,-3.9609979302514606e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.986757577217631e-10).transl(-3.25318492449533e-08,-3.9784732302483104e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0566298901963983e-09).transl(-5.2297816344568824e-08,-3.7917525556364625e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0655129684732733e-09).transl(6.339130762033299e-08,-3.59387797790561e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.487603095902005e-10).transl(-8.011594797008655e-08,-3.1357950748377795e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.656522078950717e-10).transl(-5.4701539427363185e-08,-3.755024962961972e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.047081688502146e-09).transl(-8.691520831510068e-08,-2.8770804574225208e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7268783433978803e-09).transl(-1.0865239243345818e-07,-1.4600331912383794e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.1315810341491075e-09).transl(-1.2191262427566592e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.4263983418225334e-09).transl(-5.0358260671537644e-08,-3.819046282094418e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.9650979400479475e-09).transl(-5.363509369184842e-08,-3.771721221481519e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.128552690150733e-09).transl(-3.91895589199908e-08,-3.9375796405007125e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.166287659790782e-09).transl(1.0562446568428355e-07,-1.759230407433829e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.3525594142136415e-09).transl(-8.291324620333586e-08,-3.035518451147361e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.053265735732115e-09).transl(2.9102219258505527e-08,-3.9911913690842245e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0162925409571042e-09).transl(-2.0298274935372927e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.2882186791650366e-10).transl(-8.467083704919891e-08,-2.9682337895132576e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.07314656981517e-11).transl(-4.427220288342464e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.416986675678208e-10).transl(-8.858934062948516e-08,-2.8049505236377187e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.188012073611718e-09).transl(-7.678084906010705e-08,-3.245360298584069e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0230033999005887e-09).transl(9.519609705965485e-08,-2.479299389326497e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.2685528985875182e-10).transl(1.4310621276071546e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2511165275888043e-09).transl(5.622715366688719e-08,-3.7300081491108054e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3050734856500503e-09).transl(-7.269807709883148e-08,-3.3661556754744054e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7760898398790558e-09).transl(5.3176310271564175e-08,-3.7787062074048003e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.847260616084926e-10).transl(7.806241751152296e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2566470196981998e-09).transl(3.183278483220016e-08,-3.981522044678989e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.926652753903139e-11).transl(5.33195804737637e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.58608207810179e-10).transl(-7.944220114879464e-08,-3.158772083661602e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.76340534168009e-09).transl(-4.490969288441549e-08,-3.884914685404876e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4458543883853553e-10).transl(-1.1134737244917428e-07,-1.1159115403271532e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.935275573634797e-09).transl(-1.082895789973397e-07,-1.499645650934838e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.75064634574103e-10).transl(-7.014194961142204e-08,-3.4349577794721755e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.180428846189941e-09).transl(-5.539998284412084e-08,-3.7437385941141616e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7831208263247868e-09).transl(-1.0672023155045395e-07,-1.658410898766126e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.280058983774816e-09).transl(8.397901774388265e-08,-2.995131334475752e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.0663570039479482e-09).transl(2.1922234315622004e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.3232749916622824e-09).transl(-2.1661728371630112e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.4252907046328664e-09).transl(-9.38979527141948e-08,-2.5491316957986185e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.192181428296592e-10).transl(7.369458306411613e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5658876090132248e-09).transl(1.0864979115980096e-07,-1.4603216326738962e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0424222688726725e-09).transl(-9.930361900606187e-08,-2.234697057480122e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.769001712036406e-10).transl(1.5644227101603727e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.80828990145425e-10).transl(-9.978535086485213e-08,-2.20328414975005e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.85690156726365e-10).transl(-1.1396241626050372e-07,-5.9905222568173004e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.085877055073289e-12).transl(1.037818463291322e-07,-1.914176198083401e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2577654945672966e-09).transl(8.883196386848343e-08,-2.7941853387718822e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6780189907146588e-09).transl(2.086755128069736e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.713684462956683e-09).transl(8.23844241493695e-08,-3.0550989849806557e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5542381016273788e-09).transl(9.37672987474595e-08,-2.5559853873886054e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.7527060280717047e-09).transl(1.9648107995223594e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.448579159873766e-09).transl(3.674667209136209e-08,-3.9550950620358293e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2349880420340616e-09).transl(-5.74631599851128e-08,-3.708746776710807e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.811975617712949e-10).transl(-5.671750217988528e-08,-3.721680730634208e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.7748105652276486e-10).transl(-8.560281859286759e-08,-2.9311207764442338e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.290303536046553e-09).transl(-7.903502451731338e-08,-3.172446363724242e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.831594829320797e-09).transl(-7.968006640454856e-08,-3.1507103266005564e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4007018511778277e-10).transl(9.677256083027565e-08,-2.3899637619921542e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.90029329973366e-10).transl(-5.287440425255043e-08,-3.7832383210506524e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3364042398511572e-09).transl(-5.091923523219423e-08,-3.811364040453845e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.028374401587601e-09).transl(-3.531041390674577e-08,-3.964028642711294e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.143660375201639e-10).transl(-5.6862984436046194e-08,-3.7191829613464745e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.9906707537055153e-10).transl(7.78139598559548e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5937438422849819e-09).transl(-1.0495975371372673e-07,-1.8170577867393775e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.5102672720746313e-09).transl(9.234702896601892e-08,-2.6285439030492423e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.5919405011851953e-10).transl(5.789003451832663e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0666861636503776e-09).transl(3.1715723890898393e-08,-3.982009675156376e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.352842416043094e-10).transl(1.0253618906451541e-07,-2.0103675655857765e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5937232842533365e-09).transl(3.997122294155967e-08,-3.9313527188651385e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4097202727342314e-09).transl(6.254510648939957e-08,-3.611623891248578e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.147420687742478e-12).transl(9.266582967037566e-08,-2.612559521246761e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.022034801217205e-10).transl(-1.1473424810677369e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3333796080381674e-09).transl(2.3469424953971664e-08,-3.999947929768031e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.2784099396440658e-09).transl(3.240546871443511e-08,-3.979041776115378e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5611050543927092e-09).transl(-3.343106443376741e-08,-3.97420627183276e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.303291646903151e-11).transl(6.353403032917365e-08,-3.590839106951277e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.224244286361374e-10).transl(1.1387881936808864e-07,-6.225749782319018e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6523303317579086e-09).transl(1.0814518944761233e-07,-1.515076541348344e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.918901843399058e-09).transl(-1.0183338692789714e-07,-2.0620328332588543e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.938511801172904e-10).transl(-3.141943364426973e-08,-3.9832145773015396e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5385232244130568e-09).transl(-9.1706937678551e-08,2.6601294490851026e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.02890317825441e-10).transl(-9.830477080778732e-08,2.2978544663570286e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0699929573030565e-09).transl(-2.924538307326955e-08,3.990772719702013e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.8431392425835505e-09).transl(3.37110491921882e-08,3.972798203721225e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.104503472175464e-10).transl(8.896674953340968e-08,2.7881696999977647e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.481770586485092e-10).transl(-3.861395091806203e-08,3.9419714624574136e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.0442573542691105e-12).transl(-3.393367396696378e-08,3.971651619317235e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.8211334259372346e-10).transl(-6.540290040033117e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5464846268863894e-09).transl(5.997633900508931e-08,3.6627048879200985e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5036902724136843e-09).transl(-9.294704890290738e-08,2.5983164353577232e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.196213820579151e-10).transl(-5.792515063942661e-08,3.700568048361569e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.042935827746301e-10).transl(-2.756207095396107e-08,3.995079087588742e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.049930693023447e-10).transl(5.956080875794502e-08,3.6705817835083565e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.8741084042761337e-10).transl(1.9723780283187408e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.9878552392414422e-09).transl(4.144799656697995e-08,3.918757041922791e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.437903080691595e-09).transl(-4.773300541913271e-08,3.8527427303409444e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.249708545596857e-10).transl(7.589478924705638e-08,3.272772845655774e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.088267051995902e-10).transl(4.8750059715224574e-08,3.840126027946853e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3889945953751844e-09).transl(-6.56541935097831e-10,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9111658770457348e-09).transl(1.088117640475145e-07,1.4422343717608037e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6495965920041675e-09).transl(-6.819674633288981e-08,3.484031658738681e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.453619265711277e-11).transl(-7.442320472064544e-08,3.3168111682202535e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.182142472072815e-10).transl(-4.058976811427053e-08,3.9262097476311116e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.904420360541838e-11).transl(-1.1071019378828836e-07,1.2071948029580988e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.0331684322817246e-10).transl(8.125550091365932e-08,3.0959137082055874e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.41758943329296e-09).transl(1.3222001805431415e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0337413680425265e-09).transl(5.583665643633298e-08,3.7365395457686604e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.2697063112067613e-09).transl(9.500857944919312e-08,2.4895868143261486e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.62009382593765e-09).transl(7.341792544459306e-08,3.345858482737931e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3259321677129424e-09).transl(-1.0178001086548584e-07,2.065885424237146e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1073432349852775e-09).transl(7.791326093225477e-08,3.209312352008224e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.389036215052388e-09).transl(-1.0030010198086253e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.366444229076124e-10).transl(3.2345610371273446e-08,3.979308383541055e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.426620943444609e-10).transl(-5.950277296973317e-08,3.6716735045799795e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.6139506628549015e-09).transl(3.291384927878722e-08,3.97670808196234e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4344969638114077e-10).transl(-5.765583453131575e-08,3.7053512452322984e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3544816009603502e-09).transl(-8.636905648803176e-10,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0714922183223005e-09).transl(-8.961821178433964e-08,2.758733805422559e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.69969122440058e-09).transl(-8.877840827972485e-08,2.7965685847342537e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.7019630644817084e-09).transl(-9.751161945131267e-08,2.34622270804223e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3750072781989884e-09).transl(-1.0380528406518406e-07,1.912305226695543e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.9026235450905217e-09).transl(-8.67200512823262e-08,2.8852519406485952e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.7518911077609116e-09).transl(1.8606130743373846e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3533784449375557e-09).transl(-6.240342738046811e-08,3.6145499686338284e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.650390410036188e-10).transl(-5.0043104350286915e-08,3.8232871443418655e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.1003178844476354e-10).transl(-9.213364219362822e-08,2.6391481687834047e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.0595711046945546e-10).transl(-6.366796529027006e-08,3.5879752437828844e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.567509444250166e-09).transl(2.729000029802431e-08,3.9956488379233254e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.473618489267336e-10).transl(-7.833873215075177e-08,3.195467230361838e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.354999337442732e-09).transl(-8.73039161483005e-08,2.8606602169974977e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.280100939815464e-09).transl(-3.574521711898207e-08,3.961430170938895e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6244589647001055e-09).transl(-8.782782929778288e-08,2.8382189590021376e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.855832650983295e-09).transl(-1.072238341445486e-07,1.6094861524232785e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.573334040691645e-09).transl(-2.782052386572392e-08,3.9945053351701995e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7064229772136235e-09).transl(-3.393738360827918e-08,3.971632310932448e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.026607205398006e-09).transl(1.5724372606849226e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.441957318528232e-13).transl(-5.920988692506969e-08,3.6771516697584953e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3048532199613196e-09).transl(3.314387907257879e-08,3.975611309976973e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3397529949810905e-09).transl(-4.2632929620541237e-08,3.907858418461789e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0131733757544591e-10).transl(7.376207596806586e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.6456633230207215e-10).transl(6.803724699314286e-08,3.487933936328788e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.5345330946192025e-09).transl(5.8104665549880454e-08,3.697355734376082e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.104804457817816e-09).transl(-5.7336092259898475e-08,3.710974061420582e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.32426723620439e-09).transl(-2.057071826946944e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.8684221858208003e-09).transl(-7.041431194033863e-08,3.427863979458866e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7219181962358789e-09).transl(-4.881799757696222e-08,3.8392636249277947e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.6926530127362503e-10).transl(-9.922727496974987e-08,2.2396168955261465e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.403994549801626e-11).transl(-1.1210106561251106e-07,9.962122088474488e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3108481508816855e-09).transl(2.9543541629241446e-08,3.989869511666452e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.290243966105863e-09).transl(-2.0882054105279947e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7057002710150577e-09).transl(-5.883674006680003e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.819889916680105e-09).transl(-9.382400969938988e-08,2.553014323558776e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.2590212961994305e-09).transl(2.898785486370361e-08,3.991518795539373e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2312679311178818e-09).transl(-5.768309448577683e-08,3.704869058269641e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4139294404093873e-09).transl(-7.705974210363972e-08,3.236589106279696e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.53718372202291e-10).transl(-4.059222735680813e-08,3.926188918851827e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.894445544141128e-10).transl(-2.5501227672981256e-08,3.998521432809257e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.119757023026189e-09).transl(-2.503779210975251e-08,3.999018642215749e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0027447910371826e-09).transl(1.9440963597137786e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.453616657572405e-09).transl(-1.0271437142450213e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7081847914496287e-09).transl(8.941154201641437e-10,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.337591309706724e-10).transl(-1.0501764006881196e-07,1.8121135752821242e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.096803428817863e-09).transl(-2.791269492228589e-08,3.9942930528046454e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8651324612093363e-09).transl(1.0523116198490172e-07,1.7937277816479512e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.861955636037983e-11).transl(-9.314918122616852e-08,2.5879948129376875e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.66753588956375e-10).transl(3.8394353656195395e-08,3.943603822244367e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0908500994795364e-09).transl(3.313733553157841e-08,3.975642861147799e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.5254960876956523e-09).transl(-6.894944580560475e-08,3.4653697064767434e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.558618164994175e-09).transl(-9.922350650382364e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.682477818073255e-10).transl(-9.775975367477566e-08,2.3312535998591155e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.0431004954763987e-09).transl(-1.0134832991823937e-07,2.096688900618944e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.114593388225771e-09).transl(3.165881173040118e-08,3.9822443775404694e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.6226277964504624e-10).transl(9.8429328640159e-08,2.2901186524163652e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.5792996750766998e-09).transl(9.085216353801802e-08,2.7012858043191887e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9819539418583406e-09).transl(-2.060288437831912e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.600054352938707e-10).transl(9.26849634237505e-08,2.6115947197829194e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.6640195792946797e-10).transl(-6.14392721313215e-08,3.6341226668458537e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.093161981042803e-10).transl(6.464610770731468e-08,3.566702159764176e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.7467957153800584e-09).transl(6.790403739727632e-08,3.4911791155795225e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6178732990923884e-09).transl(-9.943741875516637e-08,2.2260364354182793e-08,0))


    vIsland := hIsland.rotz(pi / 2)
    vIslands := Universe().Inverse()

    hIslands := Universe().Inverse()
    hIslands = hIslands.add(hIsland.transl(-a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, 0, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, 0, 0))

    vIslands = vIslands.add(vIsland.transl(-a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(-a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, -a/2, 0))

    DefRegion(1, hIslands)
    DefRegion(2, vIslands)
    TableAdd(m_full.Region(1))
    TableAdd(m_full.Region(2))
    setgeom(hIslands.add(vIslands))
    save(m)


    r2o2 := sqrt(2) / 2
    m = RandomMagSeed(4)
    B_ext = vector(Bmax*r2o2, Bmax*r2o2, 0)
    relax()
    minimize()

    for B := Bmax; B >= -Bmax; B -= Bstep {
        B_ext = vector(B*r2o2, B*r2o2, 0)
        minimize()
        tablesave()
    }

    