
    randSeed(2)
    ThermSeed(2)


    resolution := 2e-09
    zResolution := 5e-09
    a := 5.12e-07

    gridSize := 512 //2*a/resolution
    gridDepth := 5 //25/zResolution

    SetCellsize(resolution,resolution,zResolution)
    SetGridsize(gridSize,gridSize,gridDepth)

    SetPBC(16, 16, 0)


    Msat = 700e3
    Aex = 13e-12
    alpha = 0.2
    Bmax := 0.1
    Bstep := Bmax / 500.0


    TableAdd(B_ext)
    TableAdd(m_full)


    islandWidth := 8e-08
    islandLength := 1.8000000000000002e-07
    ellipseConstant:=4.5000000000000006e-08


    hIsland := rect(islandLength-2*ellipseConstant, islandWidth)
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(islandLength/2-ellipseConstant, 0, 0))
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(-islandLength/2+ellipseConstant, 0, 0))
    
    hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.6167174444566325e-09).transl(-1.8734264113120263e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.350074665646226e-10).transl(-2.2651867693679012e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3902273759299035e-09).transl(2.634625886586528e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0208798075047658e-09).transl(-3.832198007762941e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7811239223047408e-10).transl(-3.80665842675811e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.068237807471702e-09).transl(-7.279362687186714e-08,-3.1458558971901163e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4124876444276707e-09).transl(8.060827435697755e-08,-2.4457383199001227e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3939279800493776e-09).transl(-2.6000603902621825e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.330147995438905e-11).transl(4.472742520855659e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.413032068636717e-09).transl(6.278385029165793e-08,-3.674386130025617e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.3423472138871156e-09).transl(-7.328905119868229e-08,-3.1107677045753195e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.862746522442438e-10).transl(4.7055140460569055e-08,-3.995826363520577e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.533028701005284e-09).transl(3.479627842134973e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.957486501876931e-09).transl(3.876901747706079e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.1088595495112606e-09).transl(6.748958847514289e-08,-3.46463577003588e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.832992775911005e-09).transl(-8.947513363177194e-08,-6.091482882069165e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.6388501802770874e-11).transl(-4.0745588299324246e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.612639934491328e-10).transl(-4.477384053758921e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1583155842561836e-09).transl(-6.845930740791362e-08,-3.413450109045291e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.981082133120602e-10).transl(-1.8132398306733958e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.249529094796972e-10).transl(-1.845664900704754e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.593693112848225e-10).transl(-8.830066756709801e-08,-1.0888514759782859e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.5803976921621936e-09).transl(8.778361908971292e-08,-1.2398707621583531e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.549000623270162e-10).transl(-5.1028892538364386e-08,-3.963938637150948e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.131957124069316e-10).transl(6.430029120381443e-08,-3.613416710201601e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.381698044183179e-10).transl(-4.663974054718836e-08,-3.997343563288772e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.282668913359599e-09).transl(5.9233058786355964e-08,-3.794649944091765e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.894515232634238e-10).transl(7.29220621003516e-08,-3.136856582515684e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.034621579529657e-09).transl(-1.663586515360477e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2174571377662055e-09).transl(8.923703894259563e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.76545728433291e-09).transl(7.217895664909172e-08,-3.1880075473886134e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.697111021048693e-09).transl(-4.002833155629141e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.562400230101384e-10).transl(-5.346945250599621e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.341307261647494e-09).transl(-1.6495201942203575e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.699254774126911e-10).transl(8.880602063269711e-08,-9.15307652857489e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.502222839645088e-09).transl(-1.2564131909430349e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.10806762141014e-10).transl(-3.579286675100131e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1377194747872377e-09).transl(3.9935519252690545e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.05246071301454e-09).transl(4.314980371166267e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.960662952198616e-10).transl(3.280546111514292e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2533142012910403e-09).transl(4.072632250071833e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1217801615583104e-09).transl(-5.71637312067083e-08,-3.851098819631293e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1879654829946741e-09).transl(-7.623640649445711e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.5428768761832745e-09).transl(-7.031048114655376e-08,-3.3073112204893713e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8501263874234434e-09).transl(-7.905200690808473e-08,-2.6149969391675786e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.35561318434633e-09).transl(4.6018377640884345e-08,-3.99897557941838e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4867434423627591e-09).transl(3.723626382614933e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.656522294513563e-09).transl(6.74518522297295e-08,-3.4665690373197285e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.533701893003484e-10).transl(1.2552210560321056e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.4469962443247853e-09).transl(-2.2207750688052396e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.770969959186919e-10).transl(4.129566153922479e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.293960838171875e-09).transl(6.368224292437111e-08,-3.638991909587428e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.047951480791539e-10).transl(5.96668429490626e-08,-3.78157583499427e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.5570203757006224e-11).transl(5.598853131228247e-08,-3.878910046320847e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0857636652255462e-09).transl(4.3452360501968e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.641442194316332e-09).transl(1.3503346200146007e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3759750998477884e-10).transl(-1.2697236580048024e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.579516119548337e-10).transl(-6.358038393122687e-08,-3.643110143784949e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6988911770578122e-09).transl(-4.923126662285876e-08,-3.9822781571133966e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9780510470742505e-10).transl(-5.057961507957718e-08,-3.969133147206935e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.299429421675669e-10).transl(7.302050218639354e-08,-3.129913288394373e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1933936956973683e-10).transl(-6.593958937165954e-10,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.025335975383634e-10).transl(6.66455440218329e-08,-3.506855845057786e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.015117892683721e-10).transl(1.4735219922403864e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.818002594000154e-09).transl(8.478503121469676e-08,-1.869101673701017e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.5773224074680487e-10).transl(8.904438595409236e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0334560316478883e-09).transl(6.932084427419251e-08,-3.365470600934129e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4288867527008692e-09).transl(1.500124733120113e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.792200232972408e-10).transl(8.670008581229199e-08,-1.5035177667862327e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.115916770579709e-09).transl(-2.0255903670121816e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.989027960931188e-09).transl(-2.1876838506244593e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.93593323809446e-09).transl(6.546903773756568e-08,-3.5622364944310886e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.398024844083608e-09).transl(8.318396062897038e-08,-2.1165733325545132e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.6891568832617145e-09).transl(8.014954274452083e-08,-2.497619045729146e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4409688304789227e-09).transl(-5.624277135873748e-08,-3.8731491939912134e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6184411046654045e-10).transl(-4.644750825174416e-08,-3.9979300519315423e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.0674676409738987e-09).transl(5.7124971463015874e-08,-3.8520644503368636e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.166027852150292e-09).transl(-1.4167651660639035e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.001148077480128e-09).transl(6.811488316406438e-08,-3.431965554302555e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.9044267617780534e-09).transl(2.3464295892655163e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7653708074522756e-11).transl(8.365492293692895e-08,-2.0479138344915554e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.85443290245076e-10).transl(-5.578544282762027e-08,-3.883411225935969e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.362123023503313e-09).transl(2.1682012250730314e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.873710813519055e-09).transl(-6.286305706001952e-08,-3.671349136723097e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.2663050110161417e-09).transl(-3.8611722344584325e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6699290350141154e-10).transl(-5.290736309921948e-08,-3.937761333115502e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.2580335464155047e-10).transl(7.899739721007456e-08,-2.6206051253923987e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.8736748181886765e-09).transl(-5.500842804571218e-08,-3.899813347154877e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4842275925495964e-09).transl(1.3159500014113388e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.557834284195928e-10).transl(-5.278699850486327e-08,-3.9396560900582295e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.758373066454616e-09).transl(-4.417988009631553e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.195217790610395e-10).transl(-5.7417074113475536e-08,-3.8447052144935924e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9984712788888408e-09).transl(8.826790577362662e-08,-1.0990935163782678e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.428809972911611e-09).transl(-2.7316270038139834e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5573777645713793e-09).transl(8.241649868521924e-08,-2.222232224224581e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.104817827038588e-09).transl(-1.060076894123051e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.762225365113172e-10).transl(-6.133685510888225e-08,-3.7270923126975263e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5597246136182362e-09).transl(-7.580244234129397e-08,-2.91605625214419e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.147162154339155e-09).transl(-2.6143829283173597e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.70504743123738e-10).transl(7.178374714347638e-08,-3.2143270496110544e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.585702933692585e-10).transl(5.387394232098861e-08,3.921454149721194e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5118549761523549e-09).transl(-4.221762996262365e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4090491437431572e-09).transl(-8.898283639982905e-08,8.456604214762266e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.8103829700113255e-09).transl(3.58018629080479e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.532518293377804e-10).transl(-8.921783330407788e-08,7.4254533428864255e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.2686239350250754e-09).transl(-8.044261971643182e-08,2.4646770075803048e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.3339385374978387e-10).transl(-2.2988003308836608e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4749125218856952e-09).transl(8.126162577122156e-08,2.368675406562156e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.2786511363086424e-10).transl(2.8587924163300693e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.13502982836004e-09).transl(5.969326497621332e-08,3.7807653173529604e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.742441581319696e-11).transl(-5.162502687561508e-08,3.9564134089972024e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1727471091558844e-09).transl(8.985404256077869e-08,3.219062475998104e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.622477982214083e-10).transl(-4.9586156226396304e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.24857579721073e-09).transl(-5.710487840104321e-08,3.8525637256783316e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0877271667007468e-09).transl(4.8869323904660377e-08,3.985185735116296e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1758583638597619e-09).transl(-2.1677368009966667e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0840247466816004e-09).transl(1.083690657023458e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.836852040379194e-10).transl(-2.6481004578103598e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.029074570222366e-09).transl(-6.32493468143793e-08,3.656307349480446e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.5969786711668093e-09).transl(-2.311984667192172e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.481335552412587e-09).transl(-4.288242643103726e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2459504945067409e-09).transl(-5.103817980583114e-08,3.963826942075745e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1786687110726106e-10).transl(-4.499219844376883e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6919445427870581e-09).transl(1.6498295098510082e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.049735837639642e-09).transl(-7.59367925967858e-08,2.9047970389714774e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4304095859856382e-09).transl(1.1951937548355931e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.979454738571553e-11).transl(-4.6944853117630394e-08,3.9962624971935715e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7805231884665957e-09).transl(-8.065453947455034e-08,2.4404068713313652e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.787369150508322e-10).transl(4.7433416017434425e-08,3.994147309843445e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.169168914810424e-09).transl(2.0983185021082087e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2557855548436937e-09).transl(7.733817617111098e-08,2.78158652578065e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.841597082059515e-09).transl(-8.500670786219477e-08,1.8313340231718243e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.6844442938399316e-10).transl(-7.064570862022707e-08,3.286843363131152e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2305336345354873e-10).transl(5.1425768321616986e-08,3.95900923031804e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.153431761039634e-09).transl(-2.048638247882689e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.6380930509068163e-09).transl(-4.651185871736759e-08,3.997741864547449e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0234874199297978e-09).transl(3.453592230362851e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.9879041782394575e-12).transl(-5.383492448045721e-08,3.922150188245916e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.624786745945856e-09).transl(-6.453666618181726e-08,3.603365970455807e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.6629299975837033e-09).transl(3.7108236475073833e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1697090389729502e-09).transl(-5.157576019096799e-08,3.9570627619500675e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.13709866518228e-10).transl(8.676220206848869e-08,1.4898331424099054e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.591258243912055e-11).transl(9.625730929922158e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5139571623544972e-09).transl(-1.4153398553728012e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6409324840725209e-09).transl(-3.115450195522013e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0481001266194639e-10).transl(-4.618951048994787e-08,3.998602288930648e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8545939918714385e-09).transl(-5.576410858347895e-08,3.8838788974552705e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.024505220428051e-10).transl(-5.84560538774006e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.1022453055035034e-09).transl(7.843529168132262e-08,2.6771368825445826e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.913785032101453e-10).transl(8.357643479271248e-08,2.0595743128357046e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.5467913935438853e-10).transl(3.8162569662900446e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0323516112695562e-09).transl(7.386662879608644e-08,3.068556895002646e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.682819122779204e-10).transl(8.168112218644452e-08,2.3170782370663377e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.762473581914854e-10).transl(-7.791300227835149e-08,2.727794613788612e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.355514516955302e-09).transl(4.208244163681806e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.2646226588200203e-09).transl(-6.076294022815991e-08,3.746568830000791e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.478460901149544e-09).transl(-1.067691413308852e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3783583933747533e-11).transl(-3.036123756816432e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.607352807063047e-09).transl(-1.9546723698646126e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.1770795201152113e-10).transl(-2.4185046043610017e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.578029245796799e-09).transl(5.380239752003345e-08,3.922727998009155e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5015777656977529e-09).transl(8.25140968322874e-08,2.209192983955375e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0174348774897563e-09).transl(-7.458416072767567e-08,3.0140771734018603e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3129125262859076e-09).transl(-2.3332562929338742e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2789249797427592e-10).transl(8.292363980130563e-08,2.153235946374006e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.361214389120054e-10).transl(-8.091327388854004e-08,2.4102444051786498e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0659344648253282e-09).transl(8.92681661100989e-08,7.184590877220556e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.463984553320032e-09).transl(4.6218727364462965e-08,3.998532771508634e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9228459312808206e-09).transl(-6.497876495151505e-08,3.584161538480496e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1966013367858017e-09).transl(6.914000041115675e-08,3.3757425215129245e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6187721972197536e-09).transl(-1.7916222050542467e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.385673127330422e-09).transl(6.331941869744446e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.961031816269371e-09).transl(2.8040465114455576e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8628926795426265e-09).transl(-4.9011858130885996e-08,3.984071985405136e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.914662941433154e-09).transl(-2.8162609499448143e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.122515104230124e-11).transl(8.463564719421574e-08,1.8940123383292615e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.265216156585901e-09).transl(7.745980418956445e-08,2.7703703716024898e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7780995566111982e-09).transl(4.444023252403254e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.698204348866355e-10).transl(6.742671753682655e-08,3.4678543156760155e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.572306066595897e-11).transl(-8.740200957012987e-08,1.3394513987807595e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1772291740479313e-09).transl(-1.7461367266606235e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3392496444828484e-09).transl(7.478720123818046e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.7180676309977733e-09).transl(4.900664448755628e-08,3.98411343975572e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.6108359716259717e-10).transl(-8.083173380084038e-08,2.4198142613357053e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.970903088487003e-09).transl(-1.253876065649824e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.588259636797212e-10).transl(1.6463566063057813e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.604910760469259e-10).transl(5.968387819187544e-08,3.7810534517390744e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2137975132243103e-09).transl(-4.363849100066898e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.1765829793152673e-10).transl(-6.29140319307704e-08,3.669386153779317e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.1974483494537016e-09).transl(6.391975704680839e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.927774227037005e-10).transl(2.2256902612241106e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.14199457680017e-09).transl(4.978109062320862e-08,3.9773593050667825e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.162159627220214e-09).transl(5.578766231724845e-08,3.8833625157170416e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.257956204707655e-10).transl(7.562076350520772e-08,2.9311356647720832e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0151683713765036e-09).transl(-4.427080563078456e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.4417366580458327e-09).transl(-6.715843756690835e-08,3.481454096200042e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.371422519513496e-09).transl(2.0575975888243972e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.23746387837099e-09).transl(1.877037805382853e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.221228986725565e-10).transl(-4.3073682010677205e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.774089715318716e-09).transl(-7.985980503891966e-08,2.5295004027659656e-08,0))


    vIsland := hIsland.rotz(pi / 2)
    vIslands := Universe().Inverse()

    hIslands := Universe().Inverse()
    hIslands = hIslands.add(hIsland.transl(-a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, 0, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, 0, 0))

    vIslands = vIslands.add(vIsland.transl(-a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(-a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, -a/2, 0))

    DefRegion(1, hIslands)
    DefRegion(2, vIslands)
    TableAdd(m_full.Region(1))
    TableAdd(m_full.Region(2))
    setgeom(hIslands.add(vIslands))
    save(m)


    r2o2 := sqrt(2) / 2
    m = RandomMagSeed(4)
    B_ext = vector(Bmax*r2o2, Bmax*r2o2, 0)
    relax()
    minimize()

    for B := Bmax; B >= -Bmax; B -= Bstep {
        B_ext = vector(B*r2o2, B*r2o2, 0)
        minimize()
        tablesave()
    }

    