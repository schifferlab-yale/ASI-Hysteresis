
    randSeed(1)
    ThermSeed(1)


    resolution := 2e-09
    zResolution := 5e-09
    a := 5.12e-07

    gridSize := 512 //2*a/resolution
    gridDepth := 5 //25/zResolution

    SetCellsize(resolution,resolution,zResolution)
    SetGridsize(gridSize,gridSize,gridDepth)

    SetPBC(16, 16, 0)


    Msat = 700e3
    Aex = 13e-12
    alpha = 0.2
    Bmax := 0.1
    Bstep := Bmax / 500.0


    TableAdd(B_ext)
    TableAdd(m_full)


    islandWidth := 8e-08
    islandLength := 3.0000000000000004e-07
    ellipseConstant:=1.2000000000000002e-07


    hIsland := rect(islandLength-2*ellipseConstant, islandWidth)
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(islandLength/2-ellipseConstant, 0, 0))
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(-islandLength/2+ellipseConstant, 0, 0))
    
    hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.649147755242983e-09).transl(-1.181197195580923e-07,-2.7151662574433772e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.4205367288648785e-09).transl(1.2591451120595106e-07,-2.4037948100921805e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.466108087212303e-10).transl(5.806533318627427e-08,-3.889064022378565e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3265460721522492e-10).transl(-1.4691720201364206e-07,-9.008439705207414e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1675490776781347e-09).transl(-1.4197942390366602e-07,-1.437825759109556e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.378770769160742e-09).transl(-9.447243643961929e-08,-3.3736404569576454e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.5302538305006447e-10).transl(2.0910212777343174e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.323693222680282e-10).transl(2.9730791186015317e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2435692197036465e-09).transl(-8.486778234740833e-08,-3.5573908135469535e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3136240813216407e-09).transl(-7.778646415467797e-08,-3.66915882633634e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.107865433761681e-10).transl(6.863817506933823e-08,-3.7869793631616763e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.9442722835351065e-09).transl(-2.520316299623801e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3618515103025489e-09).transl(-7.378279269687283e-08,-3.724254893959426e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.6014985253641637e-09).transl(8.087929524699354e-08,-3.622659752657072e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1246894637291706e-09).transl(1.0204321972617753e-07,-3.198918999961933e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4746834525676987e-09).transl(-1.3438287993524752e-07,-1.9732135032377197e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.454262444116542e-10).transl(-1.4545679503386853e-07,-1.09022346359067e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2907161463538918e-09).transl(3.922167643681708e-08,-3.98817149465414e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0068829797029085e-09).transl(1.3171645339836827e-07,-2.1223056403767787e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.324123857654122e-10).transl(1.735903736285112e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.145816177537312e-09).transl(-3.009215002853306e-08,-3.999998820607082e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.039503555571201e-09).transl(1.2004333625603303e-07,-2.644112452618494e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3331699849728527e-09).transl(5.752405773290945e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.393829059184138e-09).transl(-7.846381279046465e-08,-3.6592741918173996e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.914489503731914e-09).transl(-6.892688314759998e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8180242017585188e-09).transl(-1.192565933945551e-07,-2.673586965441136e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.1320993569944848e-09).transl(1.4754757174927865e-07,-8.045484419143953e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0098379851447528e-09).transl(-2.830277500548151e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.712266486209894e-09).transl(8.799585860122484e-08,-3.5018218092090196e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.243635582707919e-10).transl(-2.899061320129293e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6206929914056487e-09).transl(2.4105886200189303e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.953637887189447e-09).transl(-4.962927930146128e-08,-3.946122061820134e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.479644528564884e-10).transl(-5.175409715385076e-08,-3.933723039595614e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.072659436770514e-09).transl(-1.2123011712142268e-07,-2.598517895949215e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.3664919114397767e-09).transl(9.117600053686054e-10,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.933560756121748e-09).transl(4.296391181605606e-08,-3.9765894083617716e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.41597337612594e-10).transl(7.17273330660402e-08,-3.750382154630786e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0403635909982089e-09).transl(-1.2088718028901572e-07,-2.611836403569964e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.597879275305276e-09).transl(3.0833405048286366e-08,-3.99990353161805e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4918346755644627e-09).transl(9.579797219350301e-08,-3.34508376497394e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0851190050397488e-09).transl(1.4162253363167649e-07,-1.4683361655838203e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.324941311903156e-10).transl(-8.653481548319305e-08,-3.52826911267036e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.091514131474889e-09).transl(6.406530159121554e-08,-3.8354422065055184e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.094240740657078e-10).transl(-1.7912293002615386e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.0230002208801497e-09).transl(-1.3485913656872094e-07,-1.9449540063291795e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.468048934505851e-09).transl(-9.466595679300493e-08,-3.3695225563613646e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.298428201286178e-10).transl(4.642796128267137e-08,-3.962339669114568e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.808376955062677e-09).transl(-3.700809566097039e-08,-3.99317286756154e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1885832398817947e-09).transl(1.1342507755171564e-07,-2.8752307029157068e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.8963720663420424e-09).transl(-6.078919892127173e-08,-3.866095536812641e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.017427248281796e-09).transl(4.205139004033716e-08,-3.9797772129292284e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0997884580633514e-09).transl(1.2574529603044425e-07,-2.4112786575781274e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1511407050221632e-10).transl(-1.335535867274511e-07,-2.021180808856344e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1643608509584045e-09).transl(9.194960560268395e-08,-3.425759666875511e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0606117948098907e-09).transl(1.4338362191538145e-07,-1.3098576179408182e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.886433374886906e-10).transl(-6.798561771802731e-08,-3.7943075560019134e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.5354360210125614e-09).transl(-1.322528157388404e-07,-2.09347177713077e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.349271276356315e-09).transl(1.053228150032486e-07,-3.1138531935683784e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.7716110286232968e-09).transl(7.6754938073929e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.298308393428341e-09).transl(4.789040860435376e-08,-3.9552964883908466e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.2745444300546694e-09).transl(1.3477796775777077e-07,-1.9498083873241242e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1208837595060476e-09).transl(-5.163806428143004e-08,-3.934434051374367e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4800911094050621e-09).transl(5.4139341090435907e-08,-3.91823262478259e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.983559059885018e-10).transl(1.33021803086091e-07,-2.0511536290289288e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.925787080635869e-10).transl(9.254911692652902e-08,-3.413634096728295e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.9652027726589268e-09).transl(5.8661991481649106e-08,-3.884225969554563e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.404502970631954e-09).transl(-3.7543439847695114e-08,-3.99208891507305e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.7055593471843514e-10).transl(2.158282853367123e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.973846905182563e-09).transl(-3.214015281258145e-08,-3.999363803009285e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2090338913446357e-09).transl(5.1342572129924975e-08,-3.936226988554021e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.468779363749954e-09).transl(3.0244024858718346e-08,-3.999991729417606e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.15855121692996e-12).transl(1.1034080664189915e-07,-2.9712239879904666e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1704111598290333e-09).transl(8.088843313990619e-08,-3.622517137842338e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.4945137766233826e-09).transl(-2.074813401993728e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.250069123643865e-10).transl(-1.1685932197427257e-07,-2.7599231442941892e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.160132152315543e-10).transl(-7.998948934002632e-08,-3.6363979362250154e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.4232194893388997e-09).transl(2.4144865969358847e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.5999340661432926e-09).transl(-7.509562414768168e-08,-3.7068082531008665e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.792672335508689e-10).transl(4.2690436841159634e-08,-3.9775694438774124e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3147350812649436e-09).transl(1.0796360177297504e-07,-3.0407741701716845e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.469443311859689e-09).transl(-1.0742393348277653e-07,-3.05605674104803e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.8655571302904866e-10).transl(-1.1745379797445846e-07,-2.7389846496350123e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.768332319958213e-10).transl(6.953462094855442e-08,-3.7766848699846865e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.030646455666768e-09).transl(-1.9602308572116676e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.802389476600139e-10).transl(1.8249823854536747e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.396129226244056e-10).transl(7.820812436774272e-08,-3.663024971089734e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5393707942340865e-09).transl(1.3172455712958334e-07,-2.121874034587282e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1393912737860095e-09).transl(-5.8732804537662704e-08,-3.8836446146200336e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.386614353423643e-10).transl(-9.943432639714023e-08,-3.262390793025432e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.805609059866308e-10).transl(-1.4424263480600751e-07,-1.2241189087944045e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.537051144602793e-10).transl(1.1055174701053974e-07,-2.9648713769272064e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.482440697371099e-10).transl(2.5294835755631316e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.84758700090488e-09).transl(-5.8326305282496404e-08,-3.8869611708095193e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.021284907154415e-09).transl(-3.031051289789618e-08,-3.999986608552617e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.486290510021513e-10).transl(-8.157676683412366e-08,-3.6116842982093e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.6949390399451736e-10).transl(-1.2193076499170512e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.942071570352519e-10).transl(-8.715266045710743e-08,-3.517191651599736e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2237947183811928e-09).transl(-1.3002507821225512e-07,-2.2098224485319702e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.272501952932014e-09).transl(3.834227536857599e-08,-3.990322521311174e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4930579896300254e-09).transl(-9.363617819567142e-08,-3.391236553341692e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.90417812585933e-10).transl(-1.0963394270162229e-07,2.992292909346859e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.1575282476763837e-09).transl(5.352267466480522e-08,3.922397761094288e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.684332634509829e-09).transl(1.0881050793483113e-07,3.016418744702606e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4114480307206588e-09).transl(3.469810448196568e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1740044784072034e-10).transl(1.4636864500925687e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8530107640295366e-09).transl(-3.5491838719255015e-10,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.92492024405842e-10).transl(-5.0227104804453697e-08,3.942766123087479e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.9695519854924924e-10).transl(1.6496481372661478e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.984172699234809e-10).transl(-7.07026859577775e-08,3.7628729207323234e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1002016271078902e-09).transl(3.382035381407461e-08,3.997972388423257e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.247921827070669e-09).transl(-1.2484109552778882e-07,2.4506612710968984e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.915710849788012e-09).transl(5.176498497546348e-08,3.933656120797356e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.0869390948914845e-09).transl(-5.6310191966037805e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0378124700299754e-09).transl(-1.2672569811527267e-07,2.3674034825129828e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0008804366565197e-09).transl(4.4952139330089235e-08,3.9688276367844445e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.234423610944408e-09).transl(9.827422705125418e-08,3.289483228673835e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3878678712351549e-09).transl(8.820155405212012e-08,3.498027873899194e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6925856783766828e-10).transl(-1.1304778512470282e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.531409658588121e-10).transl(1.6395579475326744e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2574143215362838e-09).transl(-4.816017093654651e-08,3.9539302797702176e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1268655318696816e-09).transl(-6.548226124524022e-08,3.821141356093683e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.455980516195178e-11).transl(-6.796185154682445e-08,3.794571828742395e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7552300395703247e-09).transl(-1.1427617158550612e-07,2.8475187840352705e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.573147984123745e-10).transl(1.0657011857377695e-07,3.079865967790326e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.616896236407332e-09).transl(7.747995340756302e-08,3.6735774305490836e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1969280813362251e-09).transl(1.0271995088319094e-07,3.181859823636747e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.963472618802711e-09).transl(-4.928751535571236e-08,3.947994111135308e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7715116563809655e-09).transl(1.2747919939559579e-07,2.3328108189225007e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8600172847554515e-09).transl(1.3103369635193273e-07,2.158238016290516e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.348153677292882e-09).transl(7.84442117514438e-08,3.659562564597225e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8140750633255778e-09).transl(8.692470822983947e-08,3.521296729733341e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.850022845726858e-09).transl(-3.8082113056230794e-08,3.9909173894602095e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.919351675932168e-10).transl(5.3521637723409496e-08,3.922404670438315e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.28967432609696e-09).transl(-1.2217189080672928e-07,2.5613239946715877e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.757251996958838e-10).transl(4.8658614034632175e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5016498405036506e-09).transl(3.389154667801532e-08,3.9978960945383965e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4722581681722704e-09).transl(-1.443860393153278e-07,1.2091475462546544e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.965477370754795e-09).transl(-1.3155896187633667e-07,2.1306694990075036e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1010046400565541e-09).transl(-1.1568989695456678e-07,2.8002463304176437e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1688402761342037e-09).transl(-1.1912126234190246e-07,2.6785984308933328e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0046267084844369e-09).transl(-9.443293605182533e-08,3.374478848938733e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.17314049585258e-09).transl(1.3591803858972971e-07,1.88012088893375e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.0239539571510927e-09).transl(-8.143779193417686e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2277442246608955e-09).transl(-5.945678402225568e-08,3.8776135093445445e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.476258788205497e-09).transl(1.0669508952850496e-07,3.07640902536538e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6629986149753546e-09).transl(-6.880626922418401e-08,3.785069127344697e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.6028821513791205e-09).transl(-1.0791871616316465e-07,3.0420522443253094e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1909736001134402e-09).transl(-1.3614366375892805e-07,1.8659292126122004e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7403164036005747e-09).transl(9.411369575081993e-08,3.381228247770869e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1090115643777103e-09).transl(1.1627582598916116e-07,2.7801842164959715e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.5372520868191455e-10).transl(1.2322861709909323e-07,2.5184706456698552e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.778913351732568e-09).transl(-1.8824251616922254e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.9117157962542944e-09).transl(-1.46674916891236e-07,9.350958170887443e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1614628310862435e-09).transl(-1.207558043176029e-07,2.6169074162421765e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.704411860588632e-10).transl(-4.493196766400216e-08,3.968912017400738e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.0062311899013e-11).transl(-1.198905104619984e-07,2.649883881917462e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.764825639636994e-10).transl(-3.5220189677649775e-08,3.9962134327009226e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.376755824767715e-09).transl(-6.510618719016983e-08,3.824999000866791e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0484450834732898e-10).transl(-2.487151893330996e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.3753707081211285e-09).transl(1.0466048451819508e-07,3.131526438497571e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.576189018999857e-10).transl(-9.115917291914083e-08,3.441504123336293e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.2258031733081505e-10).transl(-1.406912680490788e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.358524747264476e-09).transl(1.3745527413944047e-07,1.78056297577096e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0143060055293522e-09).transl(4.8805873985443276e-08,3.950575078199745e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6009432289700447e-09).transl(1.164894942952588e-07,2.7727979003467076e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.6603072041583104e-09).transl(-1.692942793843939e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.237614202254259e-09).transl(9.322555844560334e-08,3.399759592683904e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.294704683405984e-09).transl(1.21060779249365e-07,2.6051091857046384e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.302695757906839e-10).transl(-4.4760594907029504e-08,3.9696242248676636e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.754094115427868e-10).transl(-1.192069119294837e-07,2.675428701681978e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.5005236906614556e-09).transl(-3.317283156291439e-08,3.9986015805352884e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.956418645261013e-09).transl(9.373860217851873e-08,3.389098633417402e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.88124173997028e-10).transl(-3.83950391597285e-08,3.9901995658121363e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.7718334065371e-10).transl(5.824569286014425e-08,3.887612925812559e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.433525455493264e-10).transl(-1.0670100545714076e-07,3.0762451430028327e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.342744530307353e-09).transl(-4.0807199676861537e-08,3.9837453671338604e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.004601386249945e-10).transl(-1.0354208869145832e-07,3.1607947648403033e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9888454919276635e-09).transl(5.5602761592424986e-08,3.9078977865118005e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.8300014067106435e-09).transl(1.090176176215214e-07,3.0103923895988184e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.313352354253581e-09).transl(-9.918827033758852e-08,3.268194072792559e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.385013126343935e-10).transl(-1.061194726154726e-07,3.0922530241345456e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5060392369525808e-09).transl(8.517892878712419e-08,3.552039448277172e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.251176173793222e-10).transl(2.3333950330932324e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.077955883790991e-09).transl(-1.0337145705390562e-07,3.165197780337288e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2438686304740616e-09).transl(1.0364947377930268e-07,3.158015377492609e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.971676295097027e-09).transl(-3.8453663293037947e-08,3.9900620403040715e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.886428108307581e-10).transl(-4.6329668759208805e-08,3.962791092457509e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.767453817499427e-10).transl(-1.7745106445984703e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7589370208646297e-09).transl(-8.912759248099017e-08,3.4807291393553926e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.6523428303297453e-10).transl(2.0593999492420356e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1856533588638554e-09).transl(8.112015749482954e-08,3.618890176360676e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.39446191305645e-09).transl(-9.778091927700073e-08,3.3007990584713326e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.9950757815021163e-09).transl(3.6670085055050273e-08,3.9938160483647715e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.31186964711478e-11).transl(9.866116217064396e-08,3.280522453203746e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0457712350647143e-09).transl(-1.3808296690406186e-07,1.7378378217439786e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.630147369009775e-10).transl(1.0894765123097875e-07,3.012431348247116e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.3027848926990025e-09).transl(1.2777079885618233e-07,2.319212244377613e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0725071593792606e-09).transl(1.1911660988432472e-07,2.6787704150152925e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0971335534998327e-09).transl(1.2766086564678674e-07,2.3243530333120587e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.633376349204385e-09).transl(1.0699492248361833e-09,4e-08,0))


    vIsland := hIsland.rotz(pi / 2)
    vIslands := Universe().Inverse()

    hIslands := Universe().Inverse()
    hIslands = hIslands.add(hIsland.transl(-a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, 0, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, 0, 0))

    vIslands = vIslands.add(vIsland.transl(-a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(-a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, -a/2, 0))

    DefRegion(1, hIslands)
    DefRegion(2, vIslands)
    TableAdd(m_full.Region(1))
    TableAdd(m_full.Region(2))
    setgeom(hIslands.add(vIslands))
    save(m)


    r2o2 := sqrt(2) / 2
    m = RandomMagSeed(4)
    B_ext = vector(Bmax*r2o2, Bmax*r2o2, 0)
    relax()
    minimize()

    for B := Bmax; B >= -Bmax; B -= Bstep {
        B_ext = vector(B*r2o2, B*r2o2, 0)
        minimize()
        tablesave()
    }

    