
    randSeed(2)
    ThermSeed(2)


    resolution := 2e-09
    zResolution := 5e-09
    a := 5.12e-07

    gridSize := 512 //2*a/resolution
    gridDepth := 5 //25/zResolution

    SetCellsize(resolution,resolution,zResolution)
    SetGridsize(gridSize,gridSize,gridDepth)

    SetPBC(16, 16, 0)


    Msat = 700e3
    Aex = 13e-12
    alpha = 0.2
    Bmax := 0.1
    Bstep := Bmax / 500.0


    TableAdd(B_ext)
    TableAdd(m_full)


    islandWidth := 8e-08
    islandLength := 2.3000000000000002e-07
    ellipseConstant:=9.200000000000002e-08


    hIsland := rect(islandLength-2*ellipseConstant, islandWidth)
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(islandLength/2-ellipseConstant, 0, 0))
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(-islandLength/2+ellipseConstant, 0, 0))
    
    hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3064331657557698e-09).transl(4.4098340875746085e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5680255493942125e-10).transl(2.3516127620576724e-08,-3.9999370534459445e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.297117374773822e-09).transl(-9.52089622628287e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2782300247780485e-09).transl(8.587920736527153e-08,-2.919915735737835e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.463192525972468e-10).transl(-1.0553462070627274e-07,-1.767184802563536e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3030836955152785e-09).transl(-1.6555455088062218e-10,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1726426669640413e-09).transl(-6.650365335701738e-08,-3.52453784247103e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.913949187315503e-10).transl(-7.903484080573974e-08,-3.1724524977414706e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.2354321749499612e-09).transl(-3.4590881672735405e-08,-3.968127141302778e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.920152970023695e-10).transl(-2.5655972558751245e-08,-3.9983327834009554e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.8638395388516826e-09).transl(5.37535794746725e-08,-3.769898021890472e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.5398261526668434e-09).transl(-9.269072270673077e-08,-2.611304191682791e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.160648844948292e-10).transl(3.87815761564615e-08,-3.9407094095247896e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.9976792960670806e-09).transl(6.83695249343253e-08,-3.479783961971167e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5533976041644601e-09).transl(7.06863797522341e-08,-3.4207222360920713e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.525107599196741e-11).transl(-8.574276836024141e-08,-2.9254586244729226e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.210464714109619e-10).transl(7.144394503419104e-08,-3.400540430062848e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.729714794777784e-09).transl(-5.788638188307044e-08,-3.7012592653776124e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.870880073334118e-09).transl(8.561204112476727e-08,-2.9307483725226794e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0538236632015583e-09).transl(1.1420842672053739e-07,-5.23588922227112e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.281915252368227e-10).transl(-1.1281407107595512e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.6549732675968537e-09).transl(1.0658705164290137e-07,-1.671061827881575e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.466200772051645e-11).transl(1.4642516884893678e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.116580574278201e-09).transl(2.2383910080095556e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.8672345772253745e-10).transl(-1.1571631864322747e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.749255011830525e-09).transl(-3.288580355140578e-08,-3.976840061832636e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.4721821786024487e-09).transl(6.898500203721491e-08,-3.4644780149596335e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.5585510421627893e-10).transl(-4.922963654096842e-08,-3.833985465538403e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.634582394575278e-10).transl(-1.0192775879163047e-07,-2.0551971523042982e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2430833181551368e-10).transl(-3.512501425868282e-08,-3.965108701129235e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.4459669958525903e-09).transl(-8.417646584091318e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.0349216400280137e-09).transl(1.134225928868369e-07,-7.3753625475125145e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1035753686399758e-09).transl(-3.152487945751517e-08,-3.982790585896471e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.942318419867336e-11).transl(1.6371091761597942e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.201467480120282e-09).transl(-1.043845088487983e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.156999418126697e-10).transl(7.902761631609382e-08,-3.172693693690298e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6904995493334378e-09).transl(4.5334774142590455e-08,-3.880336221863512e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.848995120258319e-10).transl(-9.323126000933466e-08,-2.583783262951405e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0028182433992841e-11).transl(-8.396988069149276e-08,-2.995482941034487e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.632643344654466e-10).transl(7.348556160160623e-08,-3.343929994295542e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.4855698781605105e-12).transl(8.215673683255629e-08,-3.063437808210028e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0810829349989064e-09).transl(7.932231058232325e-08,-3.162814822354799e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6675901156808218e-11).transl(8.796917626794605e-08,-2.8321026726314488e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0535636342035638e-09).transl(6.075769416171934e-08,-3.647604940073282e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2705292637365295e-09).transl(8.465334144870692e-08,-2.9689207678742848e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.806804758838578e-10).transl(-6.00766107357003e-08,-3.660788219780264e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.3794502277388658e-09).transl(5.8480457853592604e-08,-3.6905686547296534e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6945971435261808e-09).transl(7.277237777182863e-08,-3.364079801807174e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.4544491741531074e-11).transl(-1.1339152062450894e-07,-7.447015098222402e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.144896258534624e-09).transl(-8.478451827299628e-08,-2.963761373294626e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.268306551611171e-10).transl(-8.915469309306598e-08,-2.7797392071994922e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.360301193687619e-11).transl(1.1413576705517235e-07,-5.469834155020955e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.007181504708961e-10).transl(1.1152176231598482e-07,-1.0894732572250198e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6092970153280948e-09).transl(1.1247859928094898e-07,-9.300489556797426e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4320108871692495e-09).transl(-1.0951422361676114e-07,-1.3605911036046201e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6446125236454902e-09).transl(1.0309415589587047e-07,-1.9680463436687598e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1335608156200146e-10).transl(8.416399401807112e-08,-2.987992933210771e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.8880403281266364e-09).transl(8.991639628904653e-08,-2.7450577371897402e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.141012884148083e-10).transl(6.334242532844488e-08,-3.5949157330630034e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.541510995734197e-10).transl(4.8319542891299e-08,-3.845533767630709e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.312680984563642e-09).transl(1.1187089309056229e-07,-1.034348064848053e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.081598441516268e-09).transl(9.05178018274719e-08,-2.7170770031752517e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0955098621618028e-09).transl(-9.201902484450068e-08,-2.6448130960204508e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2861364815311195e-09).transl(1.4495074589316108e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.942388538813636e-09).transl(3.528233813014163e-08,-3.9641932721279183e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.504092776369243e-10).transl(5.997310518813305e-08,-3.662766598424156e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.331285938374759e-10).transl(-1.1024273357758612e-07,-1.2696139343767352e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.921162394085111e-09).transl(1.031534744077566e-07,-1.9634758252599316e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0010524437271481e-09).transl(3.8533064295228105e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.223947418579708e-10).transl(1.844936285257998e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.239890264982502e-11).transl(-5.1996945589092527e-08,-3.7961220752268975e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.8247906100779197e-09).transl(-4.0277556611093696e-08,-3.928829519619713e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.909828687102573e-09).transl(1.1110020826011455e-07,-1.1522586552301656e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.064092833106717e-10).transl(4.08671923799757e-08,-3.9238410053502825e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1958026323111246e-09).transl(8.127914930589121e-08,-3.0950722332261956e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.360719616433539e-09).transl(4.0533966409070955e-08,-3.9266815530213946e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.569717078109055e-10).transl(9.447821936807037e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3450177902549102e-09).transl(6.009700482996822e-08,-3.660397633694819e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.69301041593558e-09).transl(7.501414726953143e-08,-3.2993464678596964e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.7831764163988697e-09).transl(-1.0292408120605167e-07,-1.981073606398016e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.3655179129401307e-09).transl(-6.70267132690454e-08,-3.512238532061412e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.222854942188808e-10).transl(-1.4962065338366074e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2247139441130997e-09).transl(1.0452163859342416e-07,-1.8539399832058162e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2928468143907686e-09).transl(2.6103769286861514e-08,-3.997723032507232e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.4871254094450994e-09).transl(-4.6498956790349566e-08,-3.867317136362713e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.0231559997134114e-09).transl(1.1357202988891283e-07,-7.020189650036046e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.395199841650501e-09).transl(6.372075805176792e-08,-3.586843177046984e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9736281062517737e-09).transl(9.05784903532019e-08,-2.7142234201070227e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1252834025053054e-09).transl(-1.4751499549345304e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.040888268865989e-09).transl(-2.6619331866813395e-08,-3.996903441500245e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.902847024566445e-10).transl(1.5112941410122615e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.115557686372617e-10).transl(6.374925444883174e-08,-3.586231352748117e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.021386930330833e-09).transl(-7.568565354868083e-08,-3.279143552643558e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0065551528173288e-11).transl(-9.510115758260259e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6996473029576738e-09).transl(-5.1335537772829994e-08,-3.805551933451153e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3003020059615061e-09).transl(8.48839368762679e-08,-2.959837768472929e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9309381713478477e-09).transl(-4.45280985902975e-08,-3.8889453551816224e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.167948948960128e-09).transl(-1.0055932100159009e-07,-2.151427945279221e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.9400496992681e-10).transl(-9.814771226566241e-08,-2.307553693353071e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7975725171339196e-09).transl(-5.713597450359997e-08,-3.714462422258395e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.336568054489354e-10).transl(1.3240687285604272e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.757823586959378e-09).transl(-3.187324212712195e-08,3.981351988488928e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.7512382251257006e-10).transl(-1.959143249126512e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.8535070143650518e-09).transl(-1.6568297163889876e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.5540499638161297e-10).transl(-4.4664400774041727e-08,3.887514243399092e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0540834889837112e-09).transl(8.431180656889306e-08,2.982260841440072e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.0601113755410606e-09).transl(-6.22973824432145e-08,3.616731684506877e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.50765196209966e-10).transl(3.781870771587569e-08,3.947770039257248e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4633834797875804e-09).transl(5.47819707881138e-08,3.753739492222352e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.368287765609027e-10).transl(9.393059074085654e-08,2.5474147528003216e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.4703002112752643e-09).transl(8.336306217089164e-08,3.018625460346907e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.924157767390753e-10).transl(8.376462202173202e-08,3.003356883878369e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1967490963682558e-10).transl(5.622929807713184e-08,3.729972037099562e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0633331492536485e-09).transl(-2.2085003783331212e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.371573314039702e-10).transl(-7.660801380066823e-08,3.250761392955036e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.6203794482793314e-09).transl(3.619303867690698e-08,3.958657744122783e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.971957999050214e-10).transl(9.797040044496892e-08,2.318430738876187e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.943965085898749e-10).transl(-7.451381220591392e-08,3.3141522599745754e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.504341481442725e-10).transl(7.998248815473972e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.406546848139985e-09).transl(4.8549738325878215e-08,3.8426545624049957e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.575708459263351e-10).transl(9.004900486204597e-08,2.7389340671535424e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2905053424478947e-09).transl(-1.0238583292946593e-07,2.0215706007808025e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.365661237580455e-10).transl(-2.425003362024527e-08,3.999630752320974e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.875275547164782e-10).transl(-9.998364912349238e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.967571051708542e-09).transl(-6.334022995032244e-08,3.5949623037150934e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.4896032141417114e-09).transl(-2.7530246920015875e-08,3.9951475441484604e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.302574923727252e-09).transl(-5.644823483435943e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.851474798912621e-09).transl(-4.1873522984241625e-08,3.914924700008408e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.087845072673881e-10).transl(2.2505025075197428e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8445200758700494e-09).transl(-5.9698801491912164e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.586453455209893e-10).transl(-3.207660578058795e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.479983164493976e-10).transl(-5.46351211367376e-08,3.756083687891183e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2668956358265802e-09).transl(-4.730897505999131e-08,3.8578409908455096e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.650556490825513e-10).transl(9.426456977918918e-08,2.5297328677562374e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.877988427982954e-10).transl(1.1566694246885105e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6221077428505136e-09).transl(-6.507759335677854e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2569180489178563e-09).transl(-6.373448645708333e-08,3.58654849143746e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7498039918178995e-09).transl(-9.905623498786506e-08,2.250582415471428e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4963014698405024e-09).transl(-8.505321088237812e-08,2.9531307340987883e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.855383978729736e-09).transl(3.772262139136403e-08,3.9484495819095816e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8643848605135376e-09).transl(-8.702749087903725e-08,2.8723571436949406e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.332858502061165e-10).transl(-5.0841262521682413e-08,3.812442097536382e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.726904178414685e-10).transl(-1.9218897708435664e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1042906719672061e-09).transl(-4.693435446860306e-08,3.862266364097958e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.4306011351124255e-10).transl(-3.5407026776616024e-08,3.963459203686832e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2246330249950843e-09).transl(9.056979487315329e-08,2.7146326243280398e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.815997957250214e-09).transl(-2.4957326347436128e-08,3.999094621914773e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.067855062192211e-09).transl(5.834230668865137e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.60910655811022e-09).transl(2.8165959448755143e-08,3.993688987120608e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.979651059718965e-09).transl(4.7111004248906976e-08,3.860188804580898e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.560020821049856e-10).transl(2.7301092477977096e-08,3.9956262958654567e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5282250068465196e-09).transl(-8.676687976546083e-08,2.8832955588579842e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.738014447744417e-09).transl(-5.377576119108401e-08,3.76955582043595e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.0444388004862043e-09).transl(-1.1137332928044344e-07,1.1120194609161223e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7020393955140338e-09).transl(-6.709707451802003e-08,3.510569517115876e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.3425034346939426e-10).transl(-4.819990378916027e-08,3.8470190381883336e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.616998962277599e-09).transl(5.708942030893693e-08,3.7152705425258057e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3819294209066678e-09).transl(-3.445333462600403e-08,3.968882060826455e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.220378673164865e-09).transl(-9.352365347398253e-08,2.5686838408524303e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0710886755836038e-10).transl(8.502430494693686e-08,2.9542784314879637e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.3971621371163373e-10).transl(8.055900610272318e-08,3.120443238493997e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.649564052301547e-10).transl(2.7443319816336694e-08,3.995332084687973e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1463678493798888e-09).transl(8.568390367107361e-08,2.9278430742122752e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5330064871451885e-09).transl(2.4480584877559954e-08,3.999481976952815e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.802672817590073e-10).transl(-8.329693009930459e-08,3.021122933919067e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.221397507520307e-10).transl(-4.876853552901943e-08,3.8398917401370707e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7582788597161755e-09).transl(9.699233585047399e-08,2.377085885485983e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.827489050776389e-10).transl(-4.7318450502579725e-08,3.857728100410738e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.722284317938212e-09).transl(9.977640914692137e-08,2.2038731152105994e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.7560015920633688e-09).transl(-5.8657049457853925e-08,3.687349964641197e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.9220638759323384e-11).transl(6.892635978502412e-08,3.4659481736915134e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.6411018835084525e-09).transl(-1.0924953874406605e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.8264309988680684e-09).transl(-3.651151292628502e-08,3.956626615533763e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.2284018545357428e-09).transl(-4.128631910107157e-08,3.920189256487513e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.322835318241287e-09).transl(8.13442901759243e-08,3.092751390013452e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1781898435105558e-09).transl(9.531112153849457e-08,2.472954541086029e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.652321177637835e-09).transl(-4.728920586288089e-08,3.858076368811465e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.205508113540622e-10).transl(-1.0420060153741651e-07,1.880384422528322e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.9015807852802276e-09).transl(3.714460304998174e-08,3.952441805757394e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.816644361025078e-10).transl(3.452374166705e-08,3.968496779395683e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.645458463945467e-10).transl(6.730801673506066e-08,3.5055450681689e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.939158972195993e-09).transl(6.629546417495361e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.9430855178473384e-10).transl(-2.4361349414032323e-08,3.9995620572575546e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.510611836953105e-10).transl(5.5481160181677996e-08,3.742408632030546e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.6776706586266585e-12).transl(-6.165594803865374e-08,3.629775436411563e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.1826920997773016e-09).transl(-1.5878444044160778e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4302779156603847e-09).transl(-1.1163724546327458e-07,1.0715770374673231e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0859862565364885e-09).transl(9.231924279522608e-08,2.6299290129273185e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1654832642461456e-09).transl(-7.55980298102351e-08,3.281801588102236e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5901905615873196e-09).transl(1.1285725681620663e-07,8.582672541349786e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.510923697135616e-09).transl(7.075013153998752e-08,3.4190406844765176e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.16603174702385e-09).transl(8.888339054338786e-08,2.7918930878870958e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.442817923779748e-10).transl(-8.107082727600203e-08,3.102465334558551e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.524678840906032e-10).transl(7.166891252079368e-08,3.394462563440621e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.364684002614399e-09).transl(8.271512420068546e-08,3.04288936591334e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.294830794162684e-09).transl(-4.7926943037895005e-08,3.8503792833048895e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.434417812427763e-10).transl(8.182574840124368e-08,3.0754627804385953e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.18897140747946e-10).transl(-9.18338021978452e-08,2.653922329955518e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.405948218127798e-09).transl(1.0258697725058637e-07,2.0065643935899873e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.154099875935528e-09).transl(-4.900436210369439e-08,3.8368852442153875e-08,0))


    vIsland := hIsland.rotz(pi / 2)
    vIslands := Universe().Inverse()

    hIslands := Universe().Inverse()
    hIslands = hIslands.add(hIsland.transl(-a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, 0, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, 0, 0))

    vIslands = vIslands.add(vIsland.transl(-a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(-a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, -a/2, 0))

    DefRegion(1, hIslands)
    DefRegion(2, vIslands)
    TableAdd(m_full.Region(1))
    TableAdd(m_full.Region(2))
    setgeom(hIslands.add(vIslands))
    save(m)


    r2o2 := sqrt(2) / 2
    m = RandomMagSeed(4)
    B_ext = vector(Bmax*r2o2, Bmax*r2o2, 0)
    relax()
    minimize()

    for B := Bmax; B >= -Bmax; B -= Bstep {
        B_ext = vector(B*r2o2, B*r2o2, 0)
        minimize()
        tablesave()
    }

    