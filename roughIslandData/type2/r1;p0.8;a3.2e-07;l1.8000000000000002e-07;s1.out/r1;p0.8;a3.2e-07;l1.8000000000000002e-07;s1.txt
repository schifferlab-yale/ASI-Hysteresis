
    randSeed(1)
    ThermSeed(1)


    resolution := 2e-09
    zResolution := 5e-09
    a := 3.2e-07

    gridSize := 320 //2*a/resolution
    gridDepth := 5 //25/zResolution

    SetCellsize(resolution,resolution,zResolution)
    SetGridsize(gridSize,gridSize,gridDepth)

    SetPBC(16, 16, 0)


    Msat = 700e3
    Aex = 13e-12
    alpha = 0.2
    Bmax := 0.1
    Bstep := Bmax / 500.0


    TableAdd(B_ext)
    TableAdd(m_full)


    islandWidth := 8e-08
    islandLength := 1.8000000000000002e-07
    ellipseConstant:=7.200000000000001e-08


    hIsland := rect(islandLength-2*ellipseConstant, islandWidth)
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(islandLength/2-ellipseConstant, 0, 0))
    hIsland = hIsland.add(ellipse(ellipseConstant*2,islandWidth).transl(-islandLength/2+ellipseConstant, 0, 0))
    
    hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0725920463927883e-09).transl(7.370553885046145e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.55951177661746e-10).transl(-1.067885778958255e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3333899810216098e-09).transl(6.08545291014673e-08,-3.214305089487785e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.3534788945737383e-09).transl(-6.910045916061788e-08,-2.8179008218699145e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.8775460884417743e-09).transl(3.654638987614883e-08,-3.86501857539572e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.3929813066464605e-09).transl(1.7950995666462485e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.9778041189779135e-09).transl(1.4115220653423617e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.044615919507877e-10).transl(-6.177351426006391e-08,-3.175853851029469e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.095749478365089e-09).transl(5.022896560498415e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6263652691044213e-09).transl(6.358339968796226e-08,-3.0962709913897815e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0728848033176913e-10).transl(-1.1727257144626603e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.0422174748030674e-10).transl(4.304065112626519e-08,-3.750294552700418e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.9993069044475386e-09).transl(-5.039511202895461e-08,-3.572251043875211e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.6929897809983996e-11).transl(-5.5218915451324025e-08,-3.424112182231138e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.535495817054227e-10).transl(-3.702504070232149e-08,-3.857831471350534e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.001254874846978e-09).transl(8.048628337412102e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.525107286716164e-09).transl(-8.911654747842835e-08,-6.246892431106626e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.585936100631147e-09).transl(-1.649800651736766e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1100197336133223e-09).transl(-5.453759604885421e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1692650417960085e-09).transl(3.6306928369067435e-08,-3.8685405635246075e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.911679419932654e-10).transl(1.9122874183787738e-08,-3.999513532751797e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.67316254939239e-10).transl(-5.011596298956579e-08,-3.580022122687026e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.048745910581985e-09).transl(-2.923442427887121e-08,-3.951006947415512e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.027492040807019e-09).transl(5.1242749040379987e-08,-3.548134458632876e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.062032904178689e-10).transl(-3.372855247755183e-08,-3.903390674279498e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.665029667841644e-10).transl(1.7994166446323764e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.3848218596192545e-09).transl(-7.407868145449572e-08,-2.5087387308211714e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.021880661085382e-09).transl(-7.648919497372846e-08,-2.332681172965423e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5579647423885586e-09).transl(-4.140972218446315e-08,-3.7826704049831455e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.649009987034802e-10).transl(-4.657153152092556e-08,-3.671573983190231e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8573480434956834e-09).transl(-2.740136816188746e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.390870827329926e-10).transl(-7.342655190457682e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4906224919477943e-09).transl(7.394531582477922e-08,-2.517912150274331e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.3663288670968968e-10).transl(4.194865091251881e-08,-3.7722435441511267e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6014968925198427e-09).transl(-4.231492703461847e-08,-3.765004682215204e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.005003725951173e-10).transl(1.1758835978763753e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.1341450355053775e-10).transl(6.647100378919354e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.1050201205063994e-10).transl(-4.362154265605995e-08,-3.738165090880563e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6269377021817946e-09).transl(-2.2198726529391487e-08,-3.993192778523833e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.7044234876377461e-09).transl(4.502884464617485e-08,-3.707450605338878e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1524034194436526e-09).transl(5.773119101664444e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7709613554583757e-09).transl(6.930283486482601e-08,-2.806528508317921e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5509695947736476e-09).transl(-1.1157053759222291e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0654814228634667e-09).transl(8.952518448642244e-08,-4.586210685480556e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.108989477864087e-09).transl(3.205921782996328e-08,-3.923000549941916e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.211686572039324e-09).transl(-5.418971470006123e-08,-3.4579950972161465e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5357198189947933e-09).transl(-6.760765823606623e-08,-2.8990634100258612e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.685999632060494e-09).transl(6.551632000736949e-08,-3.005241990706836e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.475348164935288e-10).transl(-1.4198417470666228e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.818346725080051e-09).transl(4.2071052151722934e-08,-3.7698382453383246e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4866805588773877e-10).transl(-6.944363609852677e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.1775902789813806e-10).transl(-8.633195112109828e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.810833093031528e-09).transl(-6.853319400014824e-08,-2.849299407144439e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.352019878303469e-09).transl(-4.8172198682421596e-08,-3.631837284022889e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.001116501859296e-09).transl(3.1655841152258045e-08,-3.927395864830452e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.116727413686308e-09).transl(1.284136600650698e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.727718239583671e-10).transl(-7.089895366501782e-08,-2.7135352897963312e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.4177202482302873e-09).transl(1.0580791078584742e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.6448235620690397e-10).transl(-7.956087515100112e-08,-2.074431835528881e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.791158898914529e-10).transl(-4.286952617567972e-08,-3.753807395476888e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.2511132051644525e-09).transl(6.603613704636001e-08,-2.9796270883083038e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.51324554628098e-09).transl(3.571364939256329e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-4.99770567123063e-10).transl(-7.306269267958833e-08,-2.5772628046870753e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.8454238884575956e-09).transl(-4.935345738041567e-08,-3.600823255617078e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1582564270070886e-09).transl(-2.44899354787788e-08,-3.983717143093472e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.4637579107872205e-09).transl(-2.901038098248758e-08,-3.9529530727978813e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.8293892731605544e-10).transl(8.011910811985873e-08,-2.0224178830811618e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.2023493498585237e-10).transl(-7.925211349201494e-08,-2.1024519729701454e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.308688247402602e-09).transl(6.169711616894802e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.4005873287800854e-09).transl(-1.0288402858591964e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.944034666447419e-09).transl(-6.831666021427253e-08,-2.861102321929027e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.91157466702368e-10).transl(5.6613679466307606e-08,-3.3761069323622754e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.9805049995618204e-09).transl(-8.362640323437717e-08,-1.645396869945464e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.363581871898303e-10).transl(5.378600110853717e-08,-3.4709384847616235e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.66754588903076e-11).transl(-7.1565453332767e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.882409930670605e-09).transl(2.3432273563987496e-08,-3.988598876770089e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.86608264674044e-10).transl(-7.656389956577247e-08,-2.326889029256803e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.961273732728188e-12).transl(5.232780379676418e-08,-3.5161013616597615e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6525480843833756e-09).transl(2.717973955152081e-08,-3.967356142135187e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9517812588251966e-09).transl(-2.6522278218322352e-08,-3.971880627879961e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.940808932427128e-09).transl(-2.0274310248985176e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.1855349747481363e-09).transl(7.956991604410284e-08,-2.0736035300316345e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.6237486610974254e-09).transl(8.604565066430648e-08,-1.3073739413197283e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.809368207289389e-10).transl(-7.528553562245332e-08,-2.4231187232704227e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8671366658845135e-09).transl(8.935606462700038e-08,-5.33773085334595e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.369252461608934e-10).transl(-6.635475980538492e-08,-2.9636778557399747e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.753673306039148e-09).transl(-3.109279354614307e-08,-3.933309305151841e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.784147270233593e-10).transl(7.573958173511544e-08,-2.3896256622580006e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.8010050582780564e-09).transl(-5.8903497868855915e-09,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8487602995248141e-09).transl(3.8663149896551755e-08,-3.831736477523884e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.892689739300783e-09).transl(-7.144923419261149e-08,-2.6800470814360914e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.584759722942475e-10).transl(1.6863134525693866e-08,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.758993876973307e-09).transl(-1.4431145161067208e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.236247214301245e-09).transl(6.448401926302448e-08,-3.0546644928793624e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.495951898431498e-10).transl(-2.2537916729410722e-08,-3.9920473845180564e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3482959096558784e-09).transl(-6.942359824038588e-08,-2.7996988065580443e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.4434005168572624e-09).transl(-2.9498978687623403e-09,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.867787220304962e-09).transl(8.533985166234359e-10,-4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.2164905973371929e-09).transl(-1.2267955497040598e-08,-4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.6183447185749264e-09).transl(-7.382857473093248e-08,-2.5258968847856847e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.45283330581358e-10).transl(5.681840978824484e-08,3.3688529120366714e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.90160582464832e-10).transl(-3.273252979701137e-08,3.9153672256465545e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.536263123945958e-10).transl(1.0179168835948742e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3992812674964149e-09).transl(8.815955109499991e-08,8.986227290131656e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.906797394801791e-09).transl(4.222652489406439e-08,3.766763146731136e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.7455771972169055e-09).transl(3.9967453484412536e-08,3.8092767643366824e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.127331013986708e-09).transl(2.657127359582225e-08,3.971555215539486e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.6961107647888207e-11).transl(-8.096309412111432e-08,1.9401927951608668e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-5.035995269270269e-09).transl(2.4003346484314518e-08,3.986071362941299e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.1633721347419516e-09).transl(-4.5738949669038195e-08,3.691226949507894e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.1698172563542187e-09).transl(7.492023886127006e-08,2.4495441803086215e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7351798429770194e-09).transl(-3.040347681976285e-08,3.94019871764244e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.7953355795441617e-09).transl(-2.2569994578566464e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.1554319531502163e-09).transl(7.717690486306831e-08,2.27851880278666e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6121374647254875e-09).transl(-3.1876697699783927e-08,3.925005803624243e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.9745063104915136e-09).transl(2.0195966224331938e-08,3.9981391243732905e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.300902492246658e-10).transl(-2.892798820533736e-08,3.953658671963867e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.3613301204888513e-10).transl(-4.902174529772059e-08,3.609679767046881e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.867279692648408e-10).transl(9.990199676267988e-10,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4921081563520218e-09).transl(-2.6406645742278307e-08,3.972641122963876e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.848408137389381e-09).transl(2.6229039699779074e-08,3.9737886987461075e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.4042280872029398e-09).transl(-7.199066288086399e-08,2.6463393780779003e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.2747515816657484e-10).transl(-5.953671302529632e-08,3.267262545356691e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.6785862143374554e-09).transl(-2.8771300248405623e-08,3.954985559336959e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.5523796608096916e-10).transl(-8.543672809840817e-08,1.4013746595262253e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8267049254140074e-09).transl(7.048683543601018e-08,2.7381236850344933e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6785938939156423e-09).transl(3.659398841075465e-08,3.8643126594761215e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.4103764923272e-11).transl(1.790903049689791e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.211187688477643e-09).transl(6.317506941815173e-08,3.114686984186439e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.4560132322259266e-09).transl(6.446823336078197e-08,3.055405697500859e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.8930860561157888e-09).transl(2.2689084528253698e-08,3.991508148977602e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.272564627825355e-10).transl(8.404577676561838e-08,1.592764670164746e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.023490768965981e-09).transl(8.526121860149234e-08,1.42717072291743e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.5844466598414693e-09).transl(3.267661613938772e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.8984898843559276e-10).transl(7.501158150371795e-08,2.4429790901083384e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.5470931963897531e-09).transl(1.7779601509912007e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.0519571583669433e-09).transl(1.626491194569614e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.185623124451947e-10).transl(-8.175201088910293e-08,1.8589797975344057e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.0887314478096474e-09).transl(-6.601641287550368e-08,2.980608156608004e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,4.257915476928516e-09).transl(6.035540151868244e-08,3.234659885469287e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-7.435402583066808e-10).transl(-2.2713778061224894e-08,3.991418377953992e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.8107155556798489e-09).transl(3.567721610569465e-08,3.877569252094911e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0865572354276195e-09).transl(4.264644875149378e-08,3.7583456778724716e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.5815033637451606e-09).transl(-6.656739857484606e-08,2.952926878054371e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.0087358377228497e-09).transl(7.55535571042063e-08,2.40343636745086e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.844021313744565e-09).transl(-7.149521435682416e-08,2.677214118245001e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.7360866706525e-09).transl(8.357163002064501e-08,1.6521229668644182e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.730689076374473e-09).transl(6.488709749221095e-08,3.035591390281768e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.015243998248091e-09).transl(-8.31143530957629e-08,1.707030687560296e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5856675397651921e-09).transl(3.0183653492907013e-08,3.942314991535287e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.03574850014196e-10).transl(-6.676638217822031e-08,2.942787777785831e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.8296497514612422e-09).transl(2.1974276864296224e-08,3.993901648874502e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.8009746207736922e-09).transl(5.7640129532826416e-08,3.3391893609580794e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.516841003315706e-11).transl(-7.366853780732736e-08,2.5367751341937016e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.4826075801230185e-10).transl(-3.205024518960753e-08,3.92309976416668e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,7.075166763659748e-10).transl(-8.971776022809863e-08,3.5382769340490355e-09,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,9.746673552543597e-10).transl(1.0377021736824416e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.119285736022605e-10).transl(1.1393465934799941e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.9502325435766307e-09).transl(-1.2632032377505856e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1302680657682825e-09).transl(4.491590098633367e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.293905179101807e-10).transl(6.642001214062287e-08,2.9603878751444494e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.648056580639259e-09).transl(3.9140982392307234e-08,3.823683047508377e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.653578826974425e-09).transl(-1.2671581580612483e-08,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.3752047267846956e-09).transl(3.876019513933221e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0918789412222577e-10).transl(-8.674625633556341e-08,1.1888788159555242e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,3.139513255049588e-09).transl(-1.0692896421098004e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-9.773119786322274e-10).transl(-7.998304470770983e-08,2.0352618122313656e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.965795636574648e-09).transl(-3.939156120421391e-08,3.819379235502488e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.741664703761897e-09).transl(1.6920681889901845e-09,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.790711009770603e-10).transl(4.179630431572243e-08,3.775218046565766e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.6271498014460033e-09).transl(-5.163378991159904e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-6.763137950929231e-10).transl(6.06400384712292e-08,3.2230971605098586e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.5531681946198345e-09).transl(8.911994617261587e-08,6.234938801075359e-09,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5159132356677796e-09).transl(-5.165536722451794e-08,3.536108386567356e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,8.988193709441278e-10).transl(-8.163578273653025e-08,1.871230495258714e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.3578464470709712e-09).transl(-5.019441438435587e-08,3.577846653257151e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.6354664073757437e-09).transl(-4.685476932738642e-08,3.6647310914196225e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.4879980269896276e-09).transl(-7.921150987406978e-08,2.1060986245831823e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.793889161586562e-09).transl(7.560303916398492e-08,2.3997748602427583e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.0731544853858826e-09).transl(3.1511248024574275e-08,3.928939077426753e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.833047379355123e-10).transl(-4.5036623925440256e-08,3.707275532324923e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,5.618256902911848e-10).transl(3.170737770393499e-08,3.926841706971403e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,2.974453547098506e-09).transl(2.8425923888923972e-08,3.957841143303326e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-8.328210242261662e-10).transl(-7.543958968739712e-08,2.4118365118104605e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.010041110829988e-09).transl(5.325398819034026e-09,4e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.5511829925254179e-09).transl(7.092084013491494e-08,2.71221782933254e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.441241137044301e-10).transl(7.821379955864422e-08,2.1930715415020897e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.5799574362959787e-09).transl(-1.4813720117221399e-08,4e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.1200480097714499e-09).transl(-2.4012074949773445e-08,3.986030759855384e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.1402385954687625e-10).transl(-4.7082248707058546e-08,3.6591770351417294e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.190724614500472e-11).transl(-5.072593383710061e-08,3.562932128649564e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.369070153089902e-10).transl(-6.928661571912279e-08,2.807443285751833e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.238571870442077e-09).transl(3.316869051554685e-08,3.910223553034064e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.738319185900004e-10).transl(8.635422123764424e-08,1.2567109224391011e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.889590956724552e-09).transl(-4.2674822474973883e-08,3.757771016416039e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,6.644096276523882e-10).transl(2.8336985623723308e-08,3.9585610960651686e-08,0))
hIsland = hIsland.add(rect(6.000000000000001e-09,1.0180042095324026e-09).transl(-5.5695965360541675e-08,3.40796733321338e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-2.2789418653913583e-10).transl(-5.785051652763928e-08,3.3314514745690784e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-1.204617336526926e-09).transl(-6.414334852297986e-08,3.07056484684219e-08,0))
hIsland = hIsland.sub(rect(6.000000000000001e-09,-3.4542261780850946e-09).transl(2.7201704904646983e-08,3.967199087691729e-08,0))


    vIsland := hIsland.rotz(pi / 2)
    vIslands := Universe().Inverse()

    hIslands := Universe().Inverse()
    hIslands = hIslands.add(hIsland.transl(-a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, a, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, -a, 0))
    hIslands = hIslands.add(hIsland.transl(-a/2, 0, 0))
    hIslands = hIslands.add(hIsland.transl(a/2, 0, 0))

    vIslands = vIslands.add(vIsland.transl(-a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(-a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(a, -a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, a/2, 0))
    vIslands = vIslands.add(vIsland.transl(0, -a/2, 0))

    DefRegion(1, hIslands)
    DefRegion(2, vIslands)
    TableAdd(m_full.Region(1))
    TableAdd(m_full.Region(2))
    setgeom(hIslands.add(vIslands))
    save(m)


    r2o2 := sqrt(2) / 2
    m = RandomMagSeed(4)
    B_ext = vector(Bmax*r2o2, Bmax*r2o2, 0)
    relax()
    minimize()

    for B := Bmax; B >= -Bmax; B -= Bstep {
        B_ext = vector(B*r2o2, B*r2o2, 0)
        minimize()
        tablesave()
    }

    